{"version":3,"file":"extension.js","mappings":"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","sources":["webpack://rainbow-csv/./fast_load_utils.js","webpack://rainbow-csv/./node_modules/call-bind/callBound.js","webpack://rainbow-csv/./node_modules/call-bind/index.js","webpack://rainbow-csv/./node_modules/for-each/index.js","webpack://rainbow-csv/./node_modules/function-bind/implementation.js","webpack://rainbow-csv/./node_modules/function-bind/index.js","webpack://rainbow-csv/./node_modules/get-intrinsic/index.js","webpack://rainbow-csv/./node_modules/gopd/index.js","webpack://rainbow-csv/./node_modules/has-symbols/index.js","webpack://rainbow-csv/./node_modules/has-symbols/shams.js","webpack://rainbow-csv/./node_modules/has-tostringtag/shams.js","webpack://rainbow-csv/./node_modules/has/src/index.js","webpack://rainbow-csv/./node_modules/inherits/inherits_browser.js","webpack://rainbow-csv/./node_modules/is-arguments/index.js","webpack://rainbow-csv/./node_modules/is-callable/index.js","webpack://rainbow-csv/./node_modules/is-generator-function/index.js","webpack://rainbow-csv/./node_modules/is-typed-array/index.js","webpack://rainbow-csv/./node_modules/process/browser.js","webpack://rainbow-csv/./node_modules/util/support/isBufferBrowser.js","webpack://rainbow-csv/./node_modules/util/support/types.js","webpack://rainbow-csv/./node_modules/util/util.js","webpack://rainbow-csv/./node_modules/which-typed-array/index.js","webpack://rainbow-csv/./rainbow_utils.js","webpack://rainbow-csv/./rbql_core/rbql-js/csv_utils.js","webpack://rainbow-csv/./rbql_core/rbql-js/rbql.js","webpack://rainbow-csv/./rbql_core/rbql-js/rbql_csv.js","webpack://rainbow-csv/external commonjs \"vscode\"","webpack://rainbow-csv/./node_modules/available-typed-arrays/index.js","webpack://rainbow-csv/webpack/bootstrap","webpack://rainbow-csv/webpack/runtime/global","webpack://rainbow-csv/./extension.js"],"sourcesContent":["// This file stores only functionality that is required for idle operation of Rainbow CSV i.e. autodetection only.\n// We want to avoid loading/parsing a lot of JS code in cases where we don't have any CSV files to work with.\n\nconst csv_utils = require('./rbql_core/rbql-js/csv_utils.js');\n\nclass AssertionError extends Error {}\n\nfunction assert(condition, message=null) {\n    if (!condition) {\n        if (!message) {\n            message = 'Assertion error';\n        }\n        throw new AssertionError(message);\n    }\n}\n\nclass RecordTextConsumer {\n    // The only purpose of this class is to avoid code duplication when dealing with leftover lines in line_aggregator (the second `consume` call).\n    constructor(delim, policy, stop_on_warning, collect_records, preserve_quotes_and_whitespaces, detect_trailing_spaces, min_num_fields_for_autodetection) {\n        this.delim = delim;\n        this.policy = policy;\n        this.stop_on_warning = stop_on_warning;\n        this.first_defective_line = null;\n        this.records = collect_records ? [] : null;\n        this.collect_records = collect_records;\n        this.num_records_parsed = 0;\n        this.fields_info = new Map();\n        this.first_trailing_space_line = null;\n        this.detect_trailing_spaces = detect_trailing_spaces;\n        this.preserve_quotes_and_whitespaces = preserve_quotes_and_whitespaces;\n        this.min_num_fields_for_autodetection = min_num_fields_for_autodetection;\n    }\n\n    consume(record_text, record_start_line) {\n        let [record, warning] = csv_utils.smart_split(record_text, this.delim, this.policy, this.preserve_quotes_and_whitespaces);\n        if (warning) {\n            if (this.first_defective_line === null) {\n                this.first_defective_line = record_start_line;\n            }\n            if (this.stop_on_warning)\n                return /*can_continue=*/false;\n        }\n        if (this.detect_trailing_spaces && this.first_trailing_space_line === null) {\n            for (let field of record) {\n                if (field.length && (field.charAt(0) == ' ' || field.charAt(field.length - 1) == ' ')) {\n                    this.first_trailing_space_line = record_start_line;\n                }\n            }\n        }\n        if (!this.fields_info.has(record.length)) {\n            this.fields_info.set(record.length, this.num_records_parsed);\n            if (this.min_num_fields_for_autodetection != -1) {\n                // Autodetection mode: stop on inconsistent records length and when there is not enough columns (typically less than 2 i.e. 1).\n                if (record.length < this.min_num_fields_for_autodetection)\n                    return /*can_continue=*/false;\n                if (this.fields_info.size > 1)\n                    return /*can_continue=*/false;\n            }\n        }\n        if (this.collect_records) {\n            this.records.push(record);\n        }\n        this.num_records_parsed += 1;\n        return /*can_continue=*/true;\n    }\n}\n\n\nfunction parse_document_records(document, delim, policy, comment_prefix=null, stop_on_warning=false, max_records_to_parse=-1, collect_records=true, preserve_quotes_and_whitespaces=false, detect_trailing_spaces=false, min_num_fields_for_autodetection=-1) {\n    let num_lines = document.lineCount;\n    let record_start_line = 0;\n    let line_aggregator = new csv_utils.MultilineRecordAggregator(comment_prefix);\n    let consumer = new RecordTextConsumer(delim, policy, stop_on_warning, collect_records, preserve_quotes_and_whitespaces, detect_trailing_spaces, min_num_fields_for_autodetection);\n    let comments = []; // An ordered list of {record_no, comment_text} tuples which can be merged with the records later.\n\n    for (let lnum = 0; lnum < num_lines; ++lnum) {\n        let line_text = document.lineAt(lnum).text;\n        if (lnum + 1 >= num_lines && line_text == \"\") {\n            if (collect_records) {\n                // Treat the last empty line as a comment - this is to prevent align/shrink functions from removing it.\n                comments.push({record_num: consumer.num_records_parsed, comment_text: line_text});\n            }\n            break; // Skip the last empty line.\n        }\n        let record_text = null;\n        if (policy == 'quoted_rfc') {\n            line_aggregator.add_line(line_text);\n            if (line_aggregator.has_comment_line) {\n                record_start_line = lnum + 1;\n                line_aggregator.reset();\n                if (collect_records) {\n                    comments.push({record_num: consumer.num_records_parsed, comment_text: line_text});\n                }\n                continue;\n            } else if (line_aggregator.has_full_record) {\n                record_text = line_aggregator.get_full_line('\\n');\n                line_aggregator.reset();\n            } else {\n                continue;\n            }\n        } else {\n            if (comment_prefix && line_text.startsWith(comment_prefix)) {\n                record_start_line = lnum + 1;\n                if (collect_records) {\n                    comments.push({record_num: consumer.num_records_parsed, comment_text: line_text});\n                }\n                continue;\n            } else {\n                record_text = line_text;\n            }\n        }\n        if (!consumer.consume(record_text, record_start_line)) {\n            return [consumer.records, consumer.num_records_parsed, consumer.fields_info, consumer.first_defective_line, consumer.first_trailing_space_line, comments];\n        }\n        record_start_line = lnum + 1;\n        if (max_records_to_parse !== -1 && consumer.num_records_parsed >= max_records_to_parse) {\n            return [consumer.records, consumer.num_records_parsed, consumer.fields_info, consumer.first_defective_line, consumer.first_trailing_space_line, comments];\n        }\n    }\n\n    if (line_aggregator.is_inside_multiline_record()) {\n        assert(policy == 'quoted_rfc');\n        consumer.consume(line_aggregator.get_full_line('\\n'), record_start_line);\n    }\n    return [consumer.records, consumer.num_records_parsed, consumer.fields_info, consumer.first_defective_line, consumer.first_trailing_space_line, comments];\n}\n\n\nmodule.exports.parse_document_records = parse_document_records;\nmodule.exports.assert = assert;\n","'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\n\nvar callBind = require('./');\n\nvar $indexOf = callBind(GetIntrinsic('String.prototype.indexOf'));\n\nmodule.exports = function callBoundIntrinsic(name, allowMissing) {\n\tvar intrinsic = GetIntrinsic(name, !!allowMissing);\n\tif (typeof intrinsic === 'function' && $indexOf(name, '.prototype.') > -1) {\n\t\treturn callBind(intrinsic);\n\t}\n\treturn intrinsic;\n};\n","'use strict';\n\nvar bind = require('function-bind');\nvar GetIntrinsic = require('get-intrinsic');\n\nvar $apply = GetIntrinsic('%Function.prototype.apply%');\nvar $call = GetIntrinsic('%Function.prototype.call%');\nvar $reflectApply = GetIntrinsic('%Reflect.apply%', true) || bind.call($call, $apply);\n\nvar $gOPD = GetIntrinsic('%Object.getOwnPropertyDescriptor%', true);\nvar $defineProperty = GetIntrinsic('%Object.defineProperty%', true);\nvar $max = GetIntrinsic('%Math.max%');\n\nif ($defineProperty) {\n\ttry {\n\t\t$defineProperty({}, 'a', { value: 1 });\n\t} catch (e) {\n\t\t// IE 8 has a broken defineProperty\n\t\t$defineProperty = null;\n\t}\n}\n\nmodule.exports = function callBind(originalFunction) {\n\tvar func = $reflectApply(bind, $call, arguments);\n\tif ($gOPD && $defineProperty) {\n\t\tvar desc = $gOPD(func, 'length');\n\t\tif (desc.configurable) {\n\t\t\t// original length, plus the receiver, minus any additional arguments (after the receiver)\n\t\t\t$defineProperty(\n\t\t\t\tfunc,\n\t\t\t\t'length',\n\t\t\t\t{ value: 1 + $max(0, originalFunction.length - (arguments.length - 1)) }\n\t\t\t);\n\t\t}\n\t}\n\treturn func;\n};\n\nvar applyBind = function applyBind() {\n\treturn $reflectApply(bind, $apply, arguments);\n};\n\nif ($defineProperty) {\n\t$defineProperty(module.exports, 'apply', { value: applyBind });\n} else {\n\tmodule.exports.apply = applyBind;\n}\n","'use strict';\n\nvar isCallable = require('is-callable');\n\nvar toStr = Object.prototype.toString;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar forEachArray = function forEachArray(array, iterator, receiver) {\n    for (var i = 0, len = array.length; i < len; i++) {\n        if (hasOwnProperty.call(array, i)) {\n            if (receiver == null) {\n                iterator(array[i], i, array);\n            } else {\n                iterator.call(receiver, array[i], i, array);\n            }\n        }\n    }\n};\n\nvar forEachString = function forEachString(string, iterator, receiver) {\n    for (var i = 0, len = string.length; i < len; i++) {\n        // no such thing as a sparse string.\n        if (receiver == null) {\n            iterator(string.charAt(i), i, string);\n        } else {\n            iterator.call(receiver, string.charAt(i), i, string);\n        }\n    }\n};\n\nvar forEachObject = function forEachObject(object, iterator, receiver) {\n    for (var k in object) {\n        if (hasOwnProperty.call(object, k)) {\n            if (receiver == null) {\n                iterator(object[k], k, object);\n            } else {\n                iterator.call(receiver, object[k], k, object);\n            }\n        }\n    }\n};\n\nvar forEach = function forEach(list, iterator, thisArg) {\n    if (!isCallable(iterator)) {\n        throw new TypeError('iterator must be a function');\n    }\n\n    var receiver;\n    if (arguments.length >= 3) {\n        receiver = thisArg;\n    }\n\n    if (toStr.call(list) === '[object Array]') {\n        forEachArray(list, iterator, receiver);\n    } else if (typeof list === 'string') {\n        forEachString(list, iterator, receiver);\n    } else {\n        forEachObject(list, iterator, receiver);\n    }\n};\n\nmodule.exports = forEach;\n","'use strict';\n\n/* eslint no-invalid-this: 1 */\n\nvar ERROR_MESSAGE = 'Function.prototype.bind called on incompatible ';\nvar slice = Array.prototype.slice;\nvar toStr = Object.prototype.toString;\nvar funcType = '[object Function]';\n\nmodule.exports = function bind(that) {\n    var target = this;\n    if (typeof target !== 'function' || toStr.call(target) !== funcType) {\n        throw new TypeError(ERROR_MESSAGE + target);\n    }\n    var args = slice.call(arguments, 1);\n\n    var bound;\n    var binder = function () {\n        if (this instanceof bound) {\n            var result = target.apply(\n                this,\n                args.concat(slice.call(arguments))\n            );\n            if (Object(result) === result) {\n                return result;\n            }\n            return this;\n        } else {\n            return target.apply(\n                that,\n                args.concat(slice.call(arguments))\n            );\n        }\n    };\n\n    var boundLength = Math.max(0, target.length - args.length);\n    var boundArgs = [];\n    for (var i = 0; i < boundLength; i++) {\n        boundArgs.push('$' + i);\n    }\n\n    bound = Function('binder', 'return function (' + boundArgs.join(',') + '){ return binder.apply(this,arguments); }')(binder);\n\n    if (target.prototype) {\n        var Empty = function Empty() {};\n        Empty.prototype = target.prototype;\n        bound.prototype = new Empty();\n        Empty.prototype = null;\n    }\n\n    return bound;\n};\n","'use strict';\n\nvar implementation = require('./implementation');\n\nmodule.exports = Function.prototype.bind || implementation;\n","'use strict';\n\nvar undefined;\n\nvar $SyntaxError = SyntaxError;\nvar $Function = Function;\nvar $TypeError = TypeError;\n\n// eslint-disable-next-line consistent-return\nvar getEvalledConstructor = function (expressionSyntax) {\n\ttry {\n\t\treturn $Function('\"use strict\"; return (' + expressionSyntax + ').constructor;')();\n\t} catch (e) {}\n};\n\nvar $gOPD = Object.getOwnPropertyDescriptor;\nif ($gOPD) {\n\ttry {\n\t\t$gOPD({}, '');\n\t} catch (e) {\n\t\t$gOPD = null; // this is IE 8, which has a broken gOPD\n\t}\n}\n\nvar throwTypeError = function () {\n\tthrow new $TypeError();\n};\nvar ThrowTypeError = $gOPD\n\t? (function () {\n\t\ttry {\n\t\t\t// eslint-disable-next-line no-unused-expressions, no-caller, no-restricted-properties\n\t\t\targuments.callee; // IE 8 does not throw here\n\t\t\treturn throwTypeError;\n\t\t} catch (calleeThrows) {\n\t\t\ttry {\n\t\t\t\t// IE 8 throws on Object.getOwnPropertyDescriptor(arguments, '')\n\t\t\t\treturn $gOPD(arguments, 'callee').get;\n\t\t\t} catch (gOPDthrows) {\n\t\t\t\treturn throwTypeError;\n\t\t\t}\n\t\t}\n\t}())\n\t: throwTypeError;\n\nvar hasSymbols = require('has-symbols')();\n\nvar getProto = Object.getPrototypeOf || function (x) { return x.__proto__; }; // eslint-disable-line no-proto\n\nvar needsEval = {};\n\nvar TypedArray = typeof Uint8Array === 'undefined' ? undefined : getProto(Uint8Array);\n\nvar INTRINSICS = {\n\t'%AggregateError%': typeof AggregateError === 'undefined' ? undefined : AggregateError,\n\t'%Array%': Array,\n\t'%ArrayBuffer%': typeof ArrayBuffer === 'undefined' ? undefined : ArrayBuffer,\n\t'%ArrayIteratorPrototype%': hasSymbols ? getProto([][Symbol.iterator]()) : undefined,\n\t'%AsyncFromSyncIteratorPrototype%': undefined,\n\t'%AsyncFunction%': needsEval,\n\t'%AsyncGenerator%': needsEval,\n\t'%AsyncGeneratorFunction%': needsEval,\n\t'%AsyncIteratorPrototype%': needsEval,\n\t'%Atomics%': typeof Atomics === 'undefined' ? undefined : Atomics,\n\t'%BigInt%': typeof BigInt === 'undefined' ? undefined : BigInt,\n\t'%Boolean%': Boolean,\n\t'%DataView%': typeof DataView === 'undefined' ? undefined : DataView,\n\t'%Date%': Date,\n\t'%decodeURI%': decodeURI,\n\t'%decodeURIComponent%': decodeURIComponent,\n\t'%encodeURI%': encodeURI,\n\t'%encodeURIComponent%': encodeURIComponent,\n\t'%Error%': Error,\n\t'%eval%': eval, // eslint-disable-line no-eval\n\t'%EvalError%': EvalError,\n\t'%Float32Array%': typeof Float32Array === 'undefined' ? undefined : Float32Array,\n\t'%Float64Array%': typeof Float64Array === 'undefined' ? undefined : Float64Array,\n\t'%FinalizationRegistry%': typeof FinalizationRegistry === 'undefined' ? undefined : FinalizationRegistry,\n\t'%Function%': $Function,\n\t'%GeneratorFunction%': needsEval,\n\t'%Int8Array%': typeof Int8Array === 'undefined' ? undefined : Int8Array,\n\t'%Int16Array%': typeof Int16Array === 'undefined' ? undefined : Int16Array,\n\t'%Int32Array%': typeof Int32Array === 'undefined' ? undefined : Int32Array,\n\t'%isFinite%': isFinite,\n\t'%isNaN%': isNaN,\n\t'%IteratorPrototype%': hasSymbols ? getProto(getProto([][Symbol.iterator]())) : undefined,\n\t'%JSON%': typeof JSON === 'object' ? JSON : undefined,\n\t'%Map%': typeof Map === 'undefined' ? undefined : Map,\n\t'%MapIteratorPrototype%': typeof Map === 'undefined' || !hasSymbols ? undefined : getProto(new Map()[Symbol.iterator]()),\n\t'%Math%': Math,\n\t'%Number%': Number,\n\t'%Object%': Object,\n\t'%parseFloat%': parseFloat,\n\t'%parseInt%': parseInt,\n\t'%Promise%': typeof Promise === 'undefined' ? undefined : Promise,\n\t'%Proxy%': typeof Proxy === 'undefined' ? undefined : Proxy,\n\t'%RangeError%': RangeError,\n\t'%ReferenceError%': ReferenceError,\n\t'%Reflect%': typeof Reflect === 'undefined' ? undefined : Reflect,\n\t'%RegExp%': RegExp,\n\t'%Set%': typeof Set === 'undefined' ? undefined : Set,\n\t'%SetIteratorPrototype%': typeof Set === 'undefined' || !hasSymbols ? undefined : getProto(new Set()[Symbol.iterator]()),\n\t'%SharedArrayBuffer%': typeof SharedArrayBuffer === 'undefined' ? undefined : SharedArrayBuffer,\n\t'%String%': String,\n\t'%StringIteratorPrototype%': hasSymbols ? getProto(''[Symbol.iterator]()) : undefined,\n\t'%Symbol%': hasSymbols ? Symbol : undefined,\n\t'%SyntaxError%': $SyntaxError,\n\t'%ThrowTypeError%': ThrowTypeError,\n\t'%TypedArray%': TypedArray,\n\t'%TypeError%': $TypeError,\n\t'%Uint8Array%': typeof Uint8Array === 'undefined' ? undefined : Uint8Array,\n\t'%Uint8ClampedArray%': typeof Uint8ClampedArray === 'undefined' ? undefined : Uint8ClampedArray,\n\t'%Uint16Array%': typeof Uint16Array === 'undefined' ? undefined : Uint16Array,\n\t'%Uint32Array%': typeof Uint32Array === 'undefined' ? undefined : Uint32Array,\n\t'%URIError%': URIError,\n\t'%WeakMap%': typeof WeakMap === 'undefined' ? undefined : WeakMap,\n\t'%WeakRef%': typeof WeakRef === 'undefined' ? undefined : WeakRef,\n\t'%WeakSet%': typeof WeakSet === 'undefined' ? undefined : WeakSet\n};\n\nvar doEval = function doEval(name) {\n\tvar value;\n\tif (name === '%AsyncFunction%') {\n\t\tvalue = getEvalledConstructor('async function () {}');\n\t} else if (name === '%GeneratorFunction%') {\n\t\tvalue = getEvalledConstructor('function* () {}');\n\t} else if (name === '%AsyncGeneratorFunction%') {\n\t\tvalue = getEvalledConstructor('async function* () {}');\n\t} else if (name === '%AsyncGenerator%') {\n\t\tvar fn = doEval('%AsyncGeneratorFunction%');\n\t\tif (fn) {\n\t\t\tvalue = fn.prototype;\n\t\t}\n\t} else if (name === '%AsyncIteratorPrototype%') {\n\t\tvar gen = doEval('%AsyncGenerator%');\n\t\tif (gen) {\n\t\t\tvalue = getProto(gen.prototype);\n\t\t}\n\t}\n\n\tINTRINSICS[name] = value;\n\n\treturn value;\n};\n\nvar LEGACY_ALIASES = {\n\t'%ArrayBufferPrototype%': ['ArrayBuffer', 'prototype'],\n\t'%ArrayPrototype%': ['Array', 'prototype'],\n\t'%ArrayProto_entries%': ['Array', 'prototype', 'entries'],\n\t'%ArrayProto_forEach%': ['Array', 'prototype', 'forEach'],\n\t'%ArrayProto_keys%': ['Array', 'prototype', 'keys'],\n\t'%ArrayProto_values%': ['Array', 'prototype', 'values'],\n\t'%AsyncFunctionPrototype%': ['AsyncFunction', 'prototype'],\n\t'%AsyncGenerator%': ['AsyncGeneratorFunction', 'prototype'],\n\t'%AsyncGeneratorPrototype%': ['AsyncGeneratorFunction', 'prototype', 'prototype'],\n\t'%BooleanPrototype%': ['Boolean', 'prototype'],\n\t'%DataViewPrototype%': ['DataView', 'prototype'],\n\t'%DatePrototype%': ['Date', 'prototype'],\n\t'%ErrorPrototype%': ['Error', 'prototype'],\n\t'%EvalErrorPrototype%': ['EvalError', 'prototype'],\n\t'%Float32ArrayPrototype%': ['Float32Array', 'prototype'],\n\t'%Float64ArrayPrototype%': ['Float64Array', 'prototype'],\n\t'%FunctionPrototype%': ['Function', 'prototype'],\n\t'%Generator%': ['GeneratorFunction', 'prototype'],\n\t'%GeneratorPrototype%': ['GeneratorFunction', 'prototype', 'prototype'],\n\t'%Int8ArrayPrototype%': ['Int8Array', 'prototype'],\n\t'%Int16ArrayPrototype%': ['Int16Array', 'prototype'],\n\t'%Int32ArrayPrototype%': ['Int32Array', 'prototype'],\n\t'%JSONParse%': ['JSON', 'parse'],\n\t'%JSONStringify%': ['JSON', 'stringify'],\n\t'%MapPrototype%': ['Map', 'prototype'],\n\t'%NumberPrototype%': ['Number', 'prototype'],\n\t'%ObjectPrototype%': ['Object', 'prototype'],\n\t'%ObjProto_toString%': ['Object', 'prototype', 'toString'],\n\t'%ObjProto_valueOf%': ['Object', 'prototype', 'valueOf'],\n\t'%PromisePrototype%': ['Promise', 'prototype'],\n\t'%PromiseProto_then%': ['Promise', 'prototype', 'then'],\n\t'%Promise_all%': ['Promise', 'all'],\n\t'%Promise_reject%': ['Promise', 'reject'],\n\t'%Promise_resolve%': ['Promise', 'resolve'],\n\t'%RangeErrorPrototype%': ['RangeError', 'prototype'],\n\t'%ReferenceErrorPrototype%': ['ReferenceError', 'prototype'],\n\t'%RegExpPrototype%': ['RegExp', 'prototype'],\n\t'%SetPrototype%': ['Set', 'prototype'],\n\t'%SharedArrayBufferPrototype%': ['SharedArrayBuffer', 'prototype'],\n\t'%StringPrototype%': ['String', 'prototype'],\n\t'%SymbolPrototype%': ['Symbol', 'prototype'],\n\t'%SyntaxErrorPrototype%': ['SyntaxError', 'prototype'],\n\t'%TypedArrayPrototype%': ['TypedArray', 'prototype'],\n\t'%TypeErrorPrototype%': ['TypeError', 'prototype'],\n\t'%Uint8ArrayPrototype%': ['Uint8Array', 'prototype'],\n\t'%Uint8ClampedArrayPrototype%': ['Uint8ClampedArray', 'prototype'],\n\t'%Uint16ArrayPrototype%': ['Uint16Array', 'prototype'],\n\t'%Uint32ArrayPrototype%': ['Uint32Array', 'prototype'],\n\t'%URIErrorPrototype%': ['URIError', 'prototype'],\n\t'%WeakMapPrototype%': ['WeakMap', 'prototype'],\n\t'%WeakSetPrototype%': ['WeakSet', 'prototype']\n};\n\nvar bind = require('function-bind');\nvar hasOwn = require('has');\nvar $concat = bind.call(Function.call, Array.prototype.concat);\nvar $spliceApply = bind.call(Function.apply, Array.prototype.splice);\nvar $replace = bind.call(Function.call, String.prototype.replace);\nvar $strSlice = bind.call(Function.call, String.prototype.slice);\nvar $exec = bind.call(Function.call, RegExp.prototype.exec);\n\n/* adapted from https://github.com/lodash/lodash/blob/4.17.15/dist/lodash.js#L6735-L6744 */\nvar rePropName = /[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g;\nvar reEscapeChar = /\\\\(\\\\)?/g; /** Used to match backslashes in property paths. */\nvar stringToPath = function stringToPath(string) {\n\tvar first = $strSlice(string, 0, 1);\n\tvar last = $strSlice(string, -1);\n\tif (first === '%' && last !== '%') {\n\t\tthrow new $SyntaxError('invalid intrinsic syntax, expected closing `%`');\n\t} else if (last === '%' && first !== '%') {\n\t\tthrow new $SyntaxError('invalid intrinsic syntax, expected opening `%`');\n\t}\n\tvar result = [];\n\t$replace(string, rePropName, function (match, number, quote, subString) {\n\t\tresult[result.length] = quote ? $replace(subString, reEscapeChar, '$1') : number || match;\n\t});\n\treturn result;\n};\n/* end adaptation */\n\nvar getBaseIntrinsic = function getBaseIntrinsic(name, allowMissing) {\n\tvar intrinsicName = name;\n\tvar alias;\n\tif (hasOwn(LEGACY_ALIASES, intrinsicName)) {\n\t\talias = LEGACY_ALIASES[intrinsicName];\n\t\tintrinsicName = '%' + alias[0] + '%';\n\t}\n\n\tif (hasOwn(INTRINSICS, intrinsicName)) {\n\t\tvar value = INTRINSICS[intrinsicName];\n\t\tif (value === needsEval) {\n\t\t\tvalue = doEval(intrinsicName);\n\t\t}\n\t\tif (typeof value === 'undefined' && !allowMissing) {\n\t\t\tthrow new $TypeError('intrinsic ' + name + ' exists, but is not available. Please file an issue!');\n\t\t}\n\n\t\treturn {\n\t\t\talias: alias,\n\t\t\tname: intrinsicName,\n\t\t\tvalue: value\n\t\t};\n\t}\n\n\tthrow new $SyntaxError('intrinsic ' + name + ' does not exist!');\n};\n\nmodule.exports = function GetIntrinsic(name, allowMissing) {\n\tif (typeof name !== 'string' || name.length === 0) {\n\t\tthrow new $TypeError('intrinsic name must be a non-empty string');\n\t}\n\tif (arguments.length > 1 && typeof allowMissing !== 'boolean') {\n\t\tthrow new $TypeError('\"allowMissing\" argument must be a boolean');\n\t}\n\n\tif ($exec(/^%?[^%]*%?$/, name) === null) {\n\t\tthrow new $SyntaxError('`%` may not be present anywhere but at the beginning and end of the intrinsic name');\n\t}\n\tvar parts = stringToPath(name);\n\tvar intrinsicBaseName = parts.length > 0 ? parts[0] : '';\n\n\tvar intrinsic = getBaseIntrinsic('%' + intrinsicBaseName + '%', allowMissing);\n\tvar intrinsicRealName = intrinsic.name;\n\tvar value = intrinsic.value;\n\tvar skipFurtherCaching = false;\n\n\tvar alias = intrinsic.alias;\n\tif (alias) {\n\t\tintrinsicBaseName = alias[0];\n\t\t$spliceApply(parts, $concat([0, 1], alias));\n\t}\n\n\tfor (var i = 1, isOwn = true; i < parts.length; i += 1) {\n\t\tvar part = parts[i];\n\t\tvar first = $strSlice(part, 0, 1);\n\t\tvar last = $strSlice(part, -1);\n\t\tif (\n\t\t\t(\n\t\t\t\t(first === '\"' || first === \"'\" || first === '`')\n\t\t\t\t|| (last === '\"' || last === \"'\" || last === '`')\n\t\t\t)\n\t\t\t&& first !== last\n\t\t) {\n\t\t\tthrow new $SyntaxError('property names with quotes must have matching quotes');\n\t\t}\n\t\tif (part === 'constructor' || !isOwn) {\n\t\t\tskipFurtherCaching = true;\n\t\t}\n\n\t\tintrinsicBaseName += '.' + part;\n\t\tintrinsicRealName = '%' + intrinsicBaseName + '%';\n\n\t\tif (hasOwn(INTRINSICS, intrinsicRealName)) {\n\t\t\tvalue = INTRINSICS[intrinsicRealName];\n\t\t} else if (value != null) {\n\t\t\tif (!(part in value)) {\n\t\t\t\tif (!allowMissing) {\n\t\t\t\t\tthrow new $TypeError('base intrinsic for ' + name + ' exists, but the property is not available.');\n\t\t\t\t}\n\t\t\t\treturn void undefined;\n\t\t\t}\n\t\t\tif ($gOPD && (i + 1) >= parts.length) {\n\t\t\t\tvar desc = $gOPD(value, part);\n\t\t\t\tisOwn = !!desc;\n\n\t\t\t\t// By convention, when a data property is converted to an accessor\n\t\t\t\t// property to emulate a data property that does not suffer from\n\t\t\t\t// the override mistake, that accessor's getter is marked with\n\t\t\t\t// an `originalValue` property. Here, when we detect this, we\n\t\t\t\t// uphold the illusion by pretending to see that original data\n\t\t\t\t// property, i.e., returning the value rather than the getter\n\t\t\t\t// itself.\n\t\t\t\tif (isOwn && 'get' in desc && !('originalValue' in desc.get)) {\n\t\t\t\t\tvalue = desc.get;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = value[part];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tisOwn = hasOwn(value, part);\n\t\t\t\tvalue = value[part];\n\t\t\t}\n\n\t\t\tif (isOwn && !skipFurtherCaching) {\n\t\t\t\tINTRINSICS[intrinsicRealName] = value;\n\t\t\t}\n\t\t}\n\t}\n\treturn value;\n};\n","'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\n\nvar $gOPD = GetIntrinsic('%Object.getOwnPropertyDescriptor%', true);\n\nif ($gOPD) {\n\ttry {\n\t\t$gOPD([], 'length');\n\t} catch (e) {\n\t\t// IE 8 has a broken gOPD\n\t\t$gOPD = null;\n\t}\n}\n\nmodule.exports = $gOPD;\n","'use strict';\n\nvar origSymbol = typeof Symbol !== 'undefined' && Symbol;\nvar hasSymbolSham = require('./shams');\n\nmodule.exports = function hasNativeSymbols() {\n\tif (typeof origSymbol !== 'function') { return false; }\n\tif (typeof Symbol !== 'function') { return false; }\n\tif (typeof origSymbol('foo') !== 'symbol') { return false; }\n\tif (typeof Symbol('bar') !== 'symbol') { return false; }\n\n\treturn hasSymbolSham();\n};\n","'use strict';\n\n/* eslint complexity: [2, 18], max-statements: [2, 33] */\nmodule.exports = function hasSymbols() {\n\tif (typeof Symbol !== 'function' || typeof Object.getOwnPropertySymbols !== 'function') { return false; }\n\tif (typeof Symbol.iterator === 'symbol') { return true; }\n\n\tvar obj = {};\n\tvar sym = Symbol('test');\n\tvar symObj = Object(sym);\n\tif (typeof sym === 'string') { return false; }\n\n\tif (Object.prototype.toString.call(sym) !== '[object Symbol]') { return false; }\n\tif (Object.prototype.toString.call(symObj) !== '[object Symbol]') { return false; }\n\n\t// temp disabled per https://github.com/ljharb/object.assign/issues/17\n\t// if (sym instanceof Symbol) { return false; }\n\t// temp disabled per https://github.com/WebReflection/get-own-property-symbols/issues/4\n\t// if (!(symObj instanceof Symbol)) { return false; }\n\n\t// if (typeof Symbol.prototype.toString !== 'function') { return false; }\n\t// if (String(sym) !== Symbol.prototype.toString.call(sym)) { return false; }\n\n\tvar symVal = 42;\n\tobj[sym] = symVal;\n\tfor (sym in obj) { return false; } // eslint-disable-line no-restricted-syntax, no-unreachable-loop\n\tif (typeof Object.keys === 'function' && Object.keys(obj).length !== 0) { return false; }\n\n\tif (typeof Object.getOwnPropertyNames === 'function' && Object.getOwnPropertyNames(obj).length !== 0) { return false; }\n\n\tvar syms = Object.getOwnPropertySymbols(obj);\n\tif (syms.length !== 1 || syms[0] !== sym) { return false; }\n\n\tif (!Object.prototype.propertyIsEnumerable.call(obj, sym)) { return false; }\n\n\tif (typeof Object.getOwnPropertyDescriptor === 'function') {\n\t\tvar descriptor = Object.getOwnPropertyDescriptor(obj, sym);\n\t\tif (descriptor.value !== symVal || descriptor.enumerable !== true) { return false; }\n\t}\n\n\treturn true;\n};\n","'use strict';\n\nvar hasSymbols = require('has-symbols/shams');\n\nmodule.exports = function hasToStringTagShams() {\n\treturn hasSymbols() && !!Symbol.toStringTag;\n};\n","'use strict';\n\nvar bind = require('function-bind');\n\nmodule.exports = bind.call(Function.call, Object.prototype.hasOwnProperty);\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      })\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      var TempCtor = function () {}\n      TempCtor.prototype = superCtor.prototype\n      ctor.prototype = new TempCtor()\n      ctor.prototype.constructor = ctor\n    }\n  }\n}\n","'use strict';\n\nvar hasToStringTag = require('has-tostringtag/shams')();\nvar callBound = require('call-bind/callBound');\n\nvar $toString = callBound('Object.prototype.toString');\n\nvar isStandardArguments = function isArguments(value) {\n\tif (hasToStringTag && value && typeof value === 'object' && Symbol.toStringTag in value) {\n\t\treturn false;\n\t}\n\treturn $toString(value) === '[object Arguments]';\n};\n\nvar isLegacyArguments = function isArguments(value) {\n\tif (isStandardArguments(value)) {\n\t\treturn true;\n\t}\n\treturn value !== null &&\n\t\ttypeof value === 'object' &&\n\t\ttypeof value.length === 'number' &&\n\t\tvalue.length >= 0 &&\n\t\t$toString(value) !== '[object Array]' &&\n\t\t$toString(value.callee) === '[object Function]';\n};\n\nvar supportsStandardArguments = (function () {\n\treturn isStandardArguments(arguments);\n}());\n\nisStandardArguments.isLegacyArguments = isLegacyArguments; // for tests\n\nmodule.exports = supportsStandardArguments ? isStandardArguments : isLegacyArguments;\n","'use strict';\n\nvar fnToStr = Function.prototype.toString;\nvar reflectApply = typeof Reflect === 'object' && Reflect !== null && Reflect.apply;\nvar badArrayLike;\nvar isCallableMarker;\nif (typeof reflectApply === 'function' && typeof Object.defineProperty === 'function') {\n\ttry {\n\t\tbadArrayLike = Object.defineProperty({}, 'length', {\n\t\t\tget: function () {\n\t\t\t\tthrow isCallableMarker;\n\t\t\t}\n\t\t});\n\t\tisCallableMarker = {};\n\t\t// eslint-disable-next-line no-throw-literal\n\t\treflectApply(function () { throw 42; }, null, badArrayLike);\n\t} catch (_) {\n\t\tif (_ !== isCallableMarker) {\n\t\t\treflectApply = null;\n\t\t}\n\t}\n} else {\n\treflectApply = null;\n}\n\nvar constructorRegex = /^\\s*class\\b/;\nvar isES6ClassFn = function isES6ClassFunction(value) {\n\ttry {\n\t\tvar fnStr = fnToStr.call(value);\n\t\treturn constructorRegex.test(fnStr);\n\t} catch (e) {\n\t\treturn false; // not a function\n\t}\n};\n\nvar tryFunctionObject = function tryFunctionToStr(value) {\n\ttry {\n\t\tif (isES6ClassFn(value)) { return false; }\n\t\tfnToStr.call(value);\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\nvar toStr = Object.prototype.toString;\nvar objectClass = '[object Object]';\nvar fnClass = '[object Function]';\nvar genClass = '[object GeneratorFunction]';\nvar ddaClass = '[object HTMLAllCollection]'; // IE 11\nvar ddaClass2 = '[object HTML document.all class]';\nvar ddaClass3 = '[object HTMLCollection]'; // IE 9-10\nvar hasToStringTag = typeof Symbol === 'function' && !!Symbol.toStringTag; // better: use `has-tostringtag`\n\nvar isIE68 = !(0 in [,]); // eslint-disable-line no-sparse-arrays, comma-spacing\n\nvar isDDA = function isDocumentDotAll() { return false; };\nif (typeof document === 'object') {\n\t// Firefox 3 canonicalizes DDA to undefined when it's not accessed directly\n\tvar all = document.all;\n\tif (toStr.call(all) === toStr.call(document.all)) {\n\t\tisDDA = function isDocumentDotAll(value) {\n\t\t\t/* globals document: false */\n\t\t\t// in IE 6-8, typeof document.all is \"object\" and it's truthy\n\t\t\tif ((isIE68 || !value) && (typeof value === 'undefined' || typeof value === 'object')) {\n\t\t\t\ttry {\n\t\t\t\t\tvar str = toStr.call(value);\n\t\t\t\t\treturn (\n\t\t\t\t\t\tstr === ddaClass\n\t\t\t\t\t\t|| str === ddaClass2\n\t\t\t\t\t\t|| str === ddaClass3 // opera 12.16\n\t\t\t\t\t\t|| str === objectClass // IE 6-8\n\t\t\t\t\t) && value('') == null; // eslint-disable-line eqeqeq\n\t\t\t\t} catch (e) { /**/ }\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t}\n}\n\nmodule.exports = reflectApply\n\t? function isCallable(value) {\n\t\tif (isDDA(value)) { return true; }\n\t\tif (!value) { return false; }\n\t\tif (typeof value !== 'function' && typeof value !== 'object') { return false; }\n\t\ttry {\n\t\t\treflectApply(value, null, badArrayLike);\n\t\t} catch (e) {\n\t\t\tif (e !== isCallableMarker) { return false; }\n\t\t}\n\t\treturn !isES6ClassFn(value) && tryFunctionObject(value);\n\t}\n\t: function isCallable(value) {\n\t\tif (isDDA(value)) { return true; }\n\t\tif (!value) { return false; }\n\t\tif (typeof value !== 'function' && typeof value !== 'object') { return false; }\n\t\tif (hasToStringTag) { return tryFunctionObject(value); }\n\t\tif (isES6ClassFn(value)) { return false; }\n\t\tvar strClass = toStr.call(value);\n\t\tif (strClass !== fnClass && strClass !== genClass && !(/^\\[object HTML/).test(strClass)) { return false; }\n\t\treturn tryFunctionObject(value);\n\t};\n","'use strict';\n\nvar toStr = Object.prototype.toString;\nvar fnToStr = Function.prototype.toString;\nvar isFnRegex = /^\\s*(?:function)?\\*/;\nvar hasToStringTag = require('has-tostringtag/shams')();\nvar getProto = Object.getPrototypeOf;\nvar getGeneratorFunc = function () { // eslint-disable-line consistent-return\n\tif (!hasToStringTag) {\n\t\treturn false;\n\t}\n\ttry {\n\t\treturn Function('return function*() {}')();\n\t} catch (e) {\n\t}\n};\nvar GeneratorFunction;\n\nmodule.exports = function isGeneratorFunction(fn) {\n\tif (typeof fn !== 'function') {\n\t\treturn false;\n\t}\n\tif (isFnRegex.test(fnToStr.call(fn))) {\n\t\treturn true;\n\t}\n\tif (!hasToStringTag) {\n\t\tvar str = toStr.call(fn);\n\t\treturn str === '[object GeneratorFunction]';\n\t}\n\tif (!getProto) {\n\t\treturn false;\n\t}\n\tif (typeof GeneratorFunction === 'undefined') {\n\t\tvar generatorFunc = getGeneratorFunc();\n\t\tGeneratorFunction = generatorFunc ? getProto(generatorFunc) : false;\n\t}\n\treturn getProto(fn) === GeneratorFunction;\n};\n","'use strict';\n\nvar forEach = require('for-each');\nvar availableTypedArrays = require('available-typed-arrays');\nvar callBound = require('call-bind/callBound');\n\nvar $toString = callBound('Object.prototype.toString');\nvar hasToStringTag = require('has-tostringtag/shams')();\nvar gOPD = require('gopd');\n\nvar g = typeof globalThis === 'undefined' ? global : globalThis;\nvar typedArrays = availableTypedArrays();\n\nvar $indexOf = callBound('Array.prototype.indexOf', true) || function indexOf(array, value) {\n\tfor (var i = 0; i < array.length; i += 1) {\n\t\tif (array[i] === value) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n};\nvar $slice = callBound('String.prototype.slice');\nvar toStrTags = {};\nvar getPrototypeOf = Object.getPrototypeOf; // require('getprototypeof');\nif (hasToStringTag && gOPD && getPrototypeOf) {\n\tforEach(typedArrays, function (typedArray) {\n\t\tvar arr = new g[typedArray]();\n\t\tif (Symbol.toStringTag in arr) {\n\t\t\tvar proto = getPrototypeOf(arr);\n\t\t\tvar descriptor = gOPD(proto, Symbol.toStringTag);\n\t\t\tif (!descriptor) {\n\t\t\t\tvar superProto = getPrototypeOf(proto);\n\t\t\t\tdescriptor = gOPD(superProto, Symbol.toStringTag);\n\t\t\t}\n\t\t\ttoStrTags[typedArray] = descriptor.get;\n\t\t}\n\t});\n}\n\nvar tryTypedArrays = function tryAllTypedArrays(value) {\n\tvar anyTrue = false;\n\tforEach(toStrTags, function (getter, typedArray) {\n\t\tif (!anyTrue) {\n\t\t\ttry {\n\t\t\t\tanyTrue = getter.call(value) === typedArray;\n\t\t\t} catch (e) { /**/ }\n\t\t}\n\t});\n\treturn anyTrue;\n};\n\nmodule.exports = function isTypedArray(value) {\n\tif (!value || typeof value !== 'object') { return false; }\n\tif (!hasToStringTag || !(Symbol.toStringTag in value)) {\n\t\tvar tag = $slice($toString(value), 8, -1);\n\t\treturn $indexOf(typedArrays, tag) > -1;\n\t}\n\tif (!gOPD) { return false; }\n\treturn tryTypedArrays(value);\n};\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","// Currently in sync with Node.js lib/internal/util/types.js\n// https://github.com/nodejs/node/commit/112cc7c27551254aa2b17098fb774867f05ed0d9\n\n'use strict';\n\nvar isArgumentsObject = require('is-arguments');\nvar isGeneratorFunction = require('is-generator-function');\nvar whichTypedArray = require('which-typed-array');\nvar isTypedArray = require('is-typed-array');\n\nfunction uncurryThis(f) {\n  return f.call.bind(f);\n}\n\nvar BigIntSupported = typeof BigInt !== 'undefined';\nvar SymbolSupported = typeof Symbol !== 'undefined';\n\nvar ObjectToString = uncurryThis(Object.prototype.toString);\n\nvar numberValue = uncurryThis(Number.prototype.valueOf);\nvar stringValue = uncurryThis(String.prototype.valueOf);\nvar booleanValue = uncurryThis(Boolean.prototype.valueOf);\n\nif (BigIntSupported) {\n  var bigIntValue = uncurryThis(BigInt.prototype.valueOf);\n}\n\nif (SymbolSupported) {\n  var symbolValue = uncurryThis(Symbol.prototype.valueOf);\n}\n\nfunction checkBoxedPrimitive(value, prototypeValueOf) {\n  if (typeof value !== 'object') {\n    return false;\n  }\n  try {\n    prototypeValueOf(value);\n    return true;\n  } catch(e) {\n    return false;\n  }\n}\n\nexports.isArgumentsObject = isArgumentsObject;\nexports.isGeneratorFunction = isGeneratorFunction;\nexports.isTypedArray = isTypedArray;\n\n// Taken from here and modified for better browser support\n// https://github.com/sindresorhus/p-is-promise/blob/cda35a513bda03f977ad5cde3a079d237e82d7ef/index.js\nfunction isPromise(input) {\n\treturn (\n\t\t(\n\t\t\ttypeof Promise !== 'undefined' &&\n\t\t\tinput instanceof Promise\n\t\t) ||\n\t\t(\n\t\t\tinput !== null &&\n\t\t\ttypeof input === 'object' &&\n\t\t\ttypeof input.then === 'function' &&\n\t\t\ttypeof input.catch === 'function'\n\t\t)\n\t);\n}\nexports.isPromise = isPromise;\n\nfunction isArrayBufferView(value) {\n  if (typeof ArrayBuffer !== 'undefined' && ArrayBuffer.isView) {\n    return ArrayBuffer.isView(value);\n  }\n\n  return (\n    isTypedArray(value) ||\n    isDataView(value)\n  );\n}\nexports.isArrayBufferView = isArrayBufferView;\n\n\nfunction isUint8Array(value) {\n  return whichTypedArray(value) === 'Uint8Array';\n}\nexports.isUint8Array = isUint8Array;\n\nfunction isUint8ClampedArray(value) {\n  return whichTypedArray(value) === 'Uint8ClampedArray';\n}\nexports.isUint8ClampedArray = isUint8ClampedArray;\n\nfunction isUint16Array(value) {\n  return whichTypedArray(value) === 'Uint16Array';\n}\nexports.isUint16Array = isUint16Array;\n\nfunction isUint32Array(value) {\n  return whichTypedArray(value) === 'Uint32Array';\n}\nexports.isUint32Array = isUint32Array;\n\nfunction isInt8Array(value) {\n  return whichTypedArray(value) === 'Int8Array';\n}\nexports.isInt8Array = isInt8Array;\n\nfunction isInt16Array(value) {\n  return whichTypedArray(value) === 'Int16Array';\n}\nexports.isInt16Array = isInt16Array;\n\nfunction isInt32Array(value) {\n  return whichTypedArray(value) === 'Int32Array';\n}\nexports.isInt32Array = isInt32Array;\n\nfunction isFloat32Array(value) {\n  return whichTypedArray(value) === 'Float32Array';\n}\nexports.isFloat32Array = isFloat32Array;\n\nfunction isFloat64Array(value) {\n  return whichTypedArray(value) === 'Float64Array';\n}\nexports.isFloat64Array = isFloat64Array;\n\nfunction isBigInt64Array(value) {\n  return whichTypedArray(value) === 'BigInt64Array';\n}\nexports.isBigInt64Array = isBigInt64Array;\n\nfunction isBigUint64Array(value) {\n  return whichTypedArray(value) === 'BigUint64Array';\n}\nexports.isBigUint64Array = isBigUint64Array;\n\nfunction isMapToString(value) {\n  return ObjectToString(value) === '[object Map]';\n}\nisMapToString.working = (\n  typeof Map !== 'undefined' &&\n  isMapToString(new Map())\n);\n\nfunction isMap(value) {\n  if (typeof Map === 'undefined') {\n    return false;\n  }\n\n  return isMapToString.working\n    ? isMapToString(value)\n    : value instanceof Map;\n}\nexports.isMap = isMap;\n\nfunction isSetToString(value) {\n  return ObjectToString(value) === '[object Set]';\n}\nisSetToString.working = (\n  typeof Set !== 'undefined' &&\n  isSetToString(new Set())\n);\nfunction isSet(value) {\n  if (typeof Set === 'undefined') {\n    return false;\n  }\n\n  return isSetToString.working\n    ? isSetToString(value)\n    : value instanceof Set;\n}\nexports.isSet = isSet;\n\nfunction isWeakMapToString(value) {\n  return ObjectToString(value) === '[object WeakMap]';\n}\nisWeakMapToString.working = (\n  typeof WeakMap !== 'undefined' &&\n  isWeakMapToString(new WeakMap())\n);\nfunction isWeakMap(value) {\n  if (typeof WeakMap === 'undefined') {\n    return false;\n  }\n\n  return isWeakMapToString.working\n    ? isWeakMapToString(value)\n    : value instanceof WeakMap;\n}\nexports.isWeakMap = isWeakMap;\n\nfunction isWeakSetToString(value) {\n  return ObjectToString(value) === '[object WeakSet]';\n}\nisWeakSetToString.working = (\n  typeof WeakSet !== 'undefined' &&\n  isWeakSetToString(new WeakSet())\n);\nfunction isWeakSet(value) {\n  return isWeakSetToString(value);\n}\nexports.isWeakSet = isWeakSet;\n\nfunction isArrayBufferToString(value) {\n  return ObjectToString(value) === '[object ArrayBuffer]';\n}\nisArrayBufferToString.working = (\n  typeof ArrayBuffer !== 'undefined' &&\n  isArrayBufferToString(new ArrayBuffer())\n);\nfunction isArrayBuffer(value) {\n  if (typeof ArrayBuffer === 'undefined') {\n    return false;\n  }\n\n  return isArrayBufferToString.working\n    ? isArrayBufferToString(value)\n    : value instanceof ArrayBuffer;\n}\nexports.isArrayBuffer = isArrayBuffer;\n\nfunction isDataViewToString(value) {\n  return ObjectToString(value) === '[object DataView]';\n}\nisDataViewToString.working = (\n  typeof ArrayBuffer !== 'undefined' &&\n  typeof DataView !== 'undefined' &&\n  isDataViewToString(new DataView(new ArrayBuffer(1), 0, 1))\n);\nfunction isDataView(value) {\n  if (typeof DataView === 'undefined') {\n    return false;\n  }\n\n  return isDataViewToString.working\n    ? isDataViewToString(value)\n    : value instanceof DataView;\n}\nexports.isDataView = isDataView;\n\n// Store a copy of SharedArrayBuffer in case it's deleted elsewhere\nvar SharedArrayBufferCopy = typeof SharedArrayBuffer !== 'undefined' ? SharedArrayBuffer : undefined;\nfunction isSharedArrayBufferToString(value) {\n  return ObjectToString(value) === '[object SharedArrayBuffer]';\n}\nfunction isSharedArrayBuffer(value) {\n  if (typeof SharedArrayBufferCopy === 'undefined') {\n    return false;\n  }\n\n  if (typeof isSharedArrayBufferToString.working === 'undefined') {\n    isSharedArrayBufferToString.working = isSharedArrayBufferToString(new SharedArrayBufferCopy());\n  }\n\n  return isSharedArrayBufferToString.working\n    ? isSharedArrayBufferToString(value)\n    : value instanceof SharedArrayBufferCopy;\n}\nexports.isSharedArrayBuffer = isSharedArrayBuffer;\n\nfunction isAsyncFunction(value) {\n  return ObjectToString(value) === '[object AsyncFunction]';\n}\nexports.isAsyncFunction = isAsyncFunction;\n\nfunction isMapIterator(value) {\n  return ObjectToString(value) === '[object Map Iterator]';\n}\nexports.isMapIterator = isMapIterator;\n\nfunction isSetIterator(value) {\n  return ObjectToString(value) === '[object Set Iterator]';\n}\nexports.isSetIterator = isSetIterator;\n\nfunction isGeneratorObject(value) {\n  return ObjectToString(value) === '[object Generator]';\n}\nexports.isGeneratorObject = isGeneratorObject;\n\nfunction isWebAssemblyCompiledModule(value) {\n  return ObjectToString(value) === '[object WebAssembly.Module]';\n}\nexports.isWebAssemblyCompiledModule = isWebAssemblyCompiledModule;\n\nfunction isNumberObject(value) {\n  return checkBoxedPrimitive(value, numberValue);\n}\nexports.isNumberObject = isNumberObject;\n\nfunction isStringObject(value) {\n  return checkBoxedPrimitive(value, stringValue);\n}\nexports.isStringObject = isStringObject;\n\nfunction isBooleanObject(value) {\n  return checkBoxedPrimitive(value, booleanValue);\n}\nexports.isBooleanObject = isBooleanObject;\n\nfunction isBigIntObject(value) {\n  return BigIntSupported && checkBoxedPrimitive(value, bigIntValue);\n}\nexports.isBigIntObject = isBigIntObject;\n\nfunction isSymbolObject(value) {\n  return SymbolSupported && checkBoxedPrimitive(value, symbolValue);\n}\nexports.isSymbolObject = isSymbolObject;\n\nfunction isBoxedPrimitive(value) {\n  return (\n    isNumberObject(value) ||\n    isStringObject(value) ||\n    isBooleanObject(value) ||\n    isBigIntObject(value) ||\n    isSymbolObject(value)\n  );\n}\nexports.isBoxedPrimitive = isBoxedPrimitive;\n\nfunction isAnyArrayBuffer(value) {\n  return typeof Uint8Array !== 'undefined' && (\n    isArrayBuffer(value) ||\n    isSharedArrayBuffer(value)\n  );\n}\nexports.isAnyArrayBuffer = isAnyArrayBuffer;\n\n['isProxy', 'isExternal', 'isModuleNamespaceObject'].forEach(function(method) {\n  Object.defineProperty(exports, method, {\n    enumerable: false,\n    value: function() {\n      throw new Error(method + ' is not supported in userland');\n    }\n  });\n});\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnvRegex = /^$/;\n\nif (process.env.NODE_DEBUG) {\n  var debugEnv = process.env.NODE_DEBUG;\n  debugEnv = debugEnv.replace(/[|\\\\{}()[\\]^$+?.]/g, '\\\\$&')\n    .replace(/\\*/g, '.*')\n    .replace(/,/g, '$|^')\n    .toUpperCase();\n  debugEnvRegex = new RegExp('^' + debugEnv + '$', 'i');\n}\nexports.debuglog = function(set) {\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (debugEnvRegex.test(set)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').slice(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.slice(1, -1);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nexports.types = require('./support/types');\n\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\nexports.types.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\nexports.types.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\nexports.types.isNativeError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb.bind(null, null, ret)) },\n            function(rej) { process.nextTick(callbackifyOnRejected.bind(null, rej, cb)) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","'use strict';\n\nvar forEach = require('for-each');\nvar availableTypedArrays = require('available-typed-arrays');\nvar callBound = require('call-bind/callBound');\nvar gOPD = require('gopd');\n\nvar $toString = callBound('Object.prototype.toString');\nvar hasToStringTag = require('has-tostringtag/shams')();\n\nvar g = typeof globalThis === 'undefined' ? global : globalThis;\nvar typedArrays = availableTypedArrays();\n\nvar $slice = callBound('String.prototype.slice');\nvar toStrTags = {};\nvar getPrototypeOf = Object.getPrototypeOf; // require('getprototypeof');\nif (hasToStringTag && gOPD && getPrototypeOf) {\n\tforEach(typedArrays, function (typedArray) {\n\t\tif (typeof g[typedArray] === 'function') {\n\t\t\tvar arr = new g[typedArray]();\n\t\t\tif (Symbol.toStringTag in arr) {\n\t\t\t\tvar proto = getPrototypeOf(arr);\n\t\t\t\tvar descriptor = gOPD(proto, Symbol.toStringTag);\n\t\t\t\tif (!descriptor) {\n\t\t\t\t\tvar superProto = getPrototypeOf(proto);\n\t\t\t\t\tdescriptor = gOPD(superProto, Symbol.toStringTag);\n\t\t\t\t}\n\t\t\t\ttoStrTags[typedArray] = descriptor.get;\n\t\t\t}\n\t\t}\n\t});\n}\n\nvar tryTypedArrays = function tryAllTypedArrays(value) {\n\tvar foundName = false;\n\tforEach(toStrTags, function (getter, typedArray) {\n\t\tif (!foundName) {\n\t\t\ttry {\n\t\t\t\tvar name = getter.call(value);\n\t\t\t\tif (name === typedArray) {\n\t\t\t\t\tfoundName = name;\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\t\t}\n\t});\n\treturn foundName;\n};\n\nvar isTypedArray = require('is-typed-array');\n\nmodule.exports = function whichTypedArray(value) {\n\tif (!isTypedArray(value)) { return false; }\n\tif (!hasToStringTag || !(Symbol.toStringTag in value)) { return $slice($toString(value), 8, -1); }\n\treturn tryTypedArrays(value);\n};\n","const os = require('os');\nconst fs = require('fs');\nconst path = require('path');\n\nconst rbql = require('./rbql_core/rbql-js/rbql.js');\nconst rbql_csv = require('./rbql_core/rbql-js/rbql_csv.js');\nconst csv_utils = require('./rbql_core/rbql-js/csv_utils.js');\n\nconst fast_load_utils = require('./fast_load_utils.js');\n\nconst non_numeric_sentinel = -1;\nconst number_regex = /^([0-9]+)(\\.[0-9]+)?$/;\n\n// Copypasted from extension.js\nconst QUOTED_RFC_POLICY = 'quoted_rfc';\nconst QUOTED_POLICY = 'quoted';\nconst dynamic_csv_highlight_margin = 50; // TODO make configurable.\nconst max_preview_field_length = 250;\nconst alignment_extra_readability_whitespace_length = 1;\n\n\nclass AssertionError extends Error {}\n\nfunction assert(condition, message=null) {\n    if (!condition) {\n        if (!message) {\n            message = 'Assertion error';\n        }\n        throw new AssertionError(message);\n    }\n}\n\n\nfunction get_default_js_udf_content() {\n    let default_content = `// This file can be used to store RBQL UDFs. Example:\n    //\n    // function foo(value) {\n    //     return 'foo ' + String(value.length);\n    // }\n    // \n    // Functions defined in this file can be used in RBQL queries e.g.\n    // SELECT foo(a1), a2 WHERE foo(a3) != 'foo 5' LIMIT 10\n    //\n    // Don't forget to save this file after editing!\n    //\n    // Write your own functions below this line:\n    `.replace(new RegExp(/^  */, 'mg'), '');\n    return default_content;\n}\n\n\nfunction get_default_python_udf_content() {\n    let default_content = `# This file can be used to store RBQL UDFs. Example:\n    #\n    # def foo(value):\n    #     return 'foo ' + str(len(value))\n    # \n    # \n    # Functions defined in this file can be used in RBQL queries e.g.\n    # SELECT foo(a1), a2 WHERE foo(a3) != 'foo 5' LIMIT 10\n    #\n    # Don't forget to save this file after editing!\n    #\n    # Write your own functions below this line:\n    `.replace(new RegExp(/^  */, 'mg'), '');\n    return default_content;\n}\n\n\nfunction update_subcomponent_stats(field, is_first_record, max_field_components_lens) {\n    // Extract overall field length and length of integer and fractional parts of the field if it represents a number.\n    max_field_components_lens.max_total_length = Math.max(max_field_components_lens.max_total_length, field.length);\n    if (max_field_components_lens.max_int_length == non_numeric_sentinel) {\n        // Column is not a number, early return.\n        return;\n    }\n    let match_result = number_regex.exec(field);\n    if (match_result === null) {\n        if (!is_first_record && field.length) { // Checking field_length here allows numeric columns to have some of the fields empty.\n            // We only mark the column as non-header if we know that this is not a header line.\n            max_field_components_lens.max_int_length = non_numeric_sentinel;\n            max_field_components_lens.max_fractional_length = non_numeric_sentinel;\n        }\n        return;\n    }\n    let cur_integer_part_length = match_result[1].length;\n    max_field_components_lens.max_int_length = Math.max(max_field_components_lens.max_int_length, cur_integer_part_length);\n    let cur_fractional_part_length = match_result[2] === undefined ? 0 : match_result[2].length;\n    max_field_components_lens.max_fractional_length = Math.max(max_field_components_lens.max_fractional_length, cur_fractional_part_length);\n}\n\n\nfunction get_cursor_position_if_unambiguous(active_editor) {\n    let selections = active_editor.selections;\n    if (!selections || selections.length != 1) {\n        // Support only single-cursor, multicursor is ambiguous.\n        return null;\n    }\n    let selection = selections[0];\n    let position = selection.active;\n    if (!position.isEqual(selection.anchor)) {\n        // Selections are ambiguous.\n        return null;\n    }\n    return position;\n}\n\n\nfunction calc_column_stats(active_doc, delim, policy, comment_prefix) {\n    let [records, _num_records_parsed, _fields_info, first_defective_line, _first_trailing_space_line, comments] = fast_load_utils.parse_document_records(active_doc, delim, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/true);\n    if (first_defective_line !== null) {\n        return [null, first_defective_line + 1, null, null];\n    }\n    let column_stats = [];\n    let is_first_record = true;\n    for (let record of records) {\n        for (let fnum = 0; fnum < record.length; fnum++) {\n            if (column_stats.length <= fnum) {\n                column_stats.push({max_total_length: 0, max_int_length: 0, max_fractional_length: 0});\n            }\n            let field = record[fnum];\n            let field_lines = field.split('\\n');\n            if (field_lines.length > 1) {\n                // We don't allow multiline fields to be numeric for simplicity.\n                column_stats[fnum].max_int_length = non_numeric_sentinel;\n                column_stats[fnum].max_fractional_length = non_numeric_sentinel;\n            }\n            for (let field_line of field_lines) {\n                update_subcomponent_stats(field_line.trim(), is_first_record, column_stats[fnum]);\n            }\n        }\n        is_first_record = false;\n    }\n    return [column_stats, null, records, comments];\n}\n\n\nfunction adjust_column_stats(column_stats, delim_length) {\n    // Ensure that numeric components max widths are consistent with non-numeric (header) width.\n    let adjusted_stats = [];\n    for (let column_stat of column_stats) {\n        if (column_stat.max_int_length <= 0) {\n            column_stat.max_int_length = -1;\n            column_stat.max_fractional_length = -1;\n        }\n        if (column_stat.max_int_length > 0) {\n            // The sum of integer and float parts can be bigger than the max width, e.g. here:\n            // value\n            // 0.12\n            // 1234\n            if (column_stat.max_int_length + column_stat.max_fractional_length > column_stat.max_total_length) {\n                column_stat.max_total_length = column_stat.max_int_length + column_stat.max_fractional_length;\n            }\n            // This is needed when the header is wider than numeric components and/or their sum.\n            if (column_stat.max_total_length - column_stat.max_fractional_length > column_stat.max_int_length) {\n                column_stat.max_int_length = column_stat.max_total_length - column_stat.max_fractional_length;\n            }\n            // Sanity check.\n            if (column_stat.max_total_length != column_stat.max_int_length + column_stat.max_fractional_length) {\n                // Assertion Error, this can never happen.\n                return null;\n            }\n        }\n        let previous_stat = adjusted_stats.length ? adjusted_stats[adjusted_stats.length - 1] : null;\n        column_stat.start_offset = previous_stat === null ? 0 : previous_stat.start_offset + previous_stat.max_total_length + alignment_extra_readability_whitespace_length + delim_length;\n        adjusted_stats.push(column_stat);\n    }\n    return adjusted_stats;\n}\n\n\nfunction align_field(field, is_first_record, max_field_components_lens) {\n    // Align field, use Math.max() to avoid negative delta_length which can happen theorethically due to async doc edit.\n    field = field.trim();\n    if (max_field_components_lens.max_int_length == non_numeric_sentinel) {\n        let delta_length = Math.max(max_field_components_lens.max_total_length - field.length, 0);\n        return field + ' '.repeat(delta_length + alignment_extra_readability_whitespace_length);\n    }\n    if (is_first_record) {\n        if (number_regex.exec(field) === null) {\n            // The line must be a header - align it using max_width rule.\n            let delta_length = Math.max(max_field_components_lens.max_total_length - field.length, 0);\n            return field + ' '.repeat(delta_length + alignment_extra_readability_whitespace_length);\n        }\n    }\n    let dot_pos = field.indexOf('.');\n    let cur_integer_part_length = dot_pos == -1 ? field.length : dot_pos;\n    // Here cur_fractional_part_length includes the leading dot too.\n    let cur_fractional_part_length = dot_pos == -1 ? 0 : field.length - dot_pos;\n    let integer_delta_length = Math.max(max_field_components_lens.max_int_length - cur_integer_part_length, 0);\n    let fractional_delta_length = Math.max(max_field_components_lens.max_fractional_length - cur_fractional_part_length);\n    let trailing_spaces = ' '.repeat(fractional_delta_length + alignment_extra_readability_whitespace_length);\n    return ' '.repeat(integer_delta_length) + field + trailing_spaces;\n}\n\n\nfunction rfc_align_field(field, is_first_record, max_field_components_lens, is_field_segment) {\n    let aligned = align_field(field, is_first_record, max_field_components_lens);\n    if (is_field_segment) {\n        aligned = ' '.repeat(max_field_components_lens.start_offset) + aligned;\n    }\n    return aligned;\n}\n\n\nfunction strip_trailing_spaces(src) {\n    return src.replace(new RegExp(/  *$/, 'mg'), '');\n}\n\nclass RecordCommentMerger {\n    constructor(records, comments) {\n        this.records = records;\n        this.comments = comments;\n        this.nr = 0;\n        this.next_comment = 0;\n    }\n\n    get_next() {\n        // Returns tuple (record, comment).\n        if (this.has_comments_left() && (!this.has_records_left() || this.comments[this.next_comment].record_num <= this.nr)) {\n            let result = [null, this.comments[this.next_comment].comment_text];\n            this.next_comment += 1;\n            return result;\n        }\n        if (this.has_records_left()) {\n            let result = [this.records[this.nr], null];\n            this.nr += 1;\n            return result;\n        }\n        return [null, null];\n    }\n\n    has_comments_left() {\n        return this.next_comment < this.comments.length;\n    }\n\n    has_records_left() {\n        return this.nr < this.records.length;\n    }\n\n    has_entries_left() {\n        return this.has_comments_left() || this.has_records_left();\n    }\n}\n\n\nfunction align_columns(records, comments, column_stats, delim) {\n    // Unlike shrink_columns, here we don't compute `has_edit` flag because it is\n    // 1: Algorithmically complicated (especially for multiline fields) and we also can't just compare fields lengths like in shrink.\n    // 2: The alignment procedure is opinionated and \"Already aligned\" report has little value.\n    // Because of this in case of executing \"Align\" command consecutively N times one would have to run undo N times too.\n    let result_lines = [];\n    let is_first_record = true;\n    let merger = new RecordCommentMerger(records, comments);\n    while (merger.has_entries_left()) {\n        let [record, comment] = merger.get_next();\n        assert((comment === null) != (record === null));\n        if (record === null) {\n            result_lines.push(comment);\n            continue;\n        }\n        let aligned_fields = [];\n        for (let fnum = 0; fnum < record.length; fnum++) {\n            if (fnum >= column_stats.length) // Safeguard against async doc edit, should never happen.\n                break;\n            let is_field_segment = false;\n            let field = record[fnum];\n            let field_lines = field.split('\\n');\n            for (let i = 0; i < field_lines.length; i++) {\n                if (i > 0) {\n                    result_lines.push(strip_trailing_spaces(aligned_fields.join(delim)));\n                    aligned_fields = [];\n                    is_field_segment = true;\n                }\n                let aligned_field = rfc_align_field(field_lines[i], is_first_record, column_stats[fnum], is_field_segment);\n                is_field_segment = false;\n                aligned_fields.push(aligned_field);\n            }\n        }\n        is_first_record = false;\n        result_lines.push(strip_trailing_spaces(aligned_fields.join(delim)));\n    }\n    return result_lines.join('\\n');\n}\n\n\nfunction shrink_columns(active_doc, delim, policy, comment_prefix) {\n    let [records, _num_records_parsed, _fields_info, first_defective_line, _first_trailing_space_line, comments] = fast_load_utils.parse_document_records(active_doc, delim, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/true);\n    if (first_defective_line !== null) {\n        return [null, first_defective_line + 1];\n    }\n    let result_lines = [];\n    let has_edit = false;\n    let merger = new RecordCommentMerger(records, comments);\n    while (merger.has_entries_left()) {\n        let [record, comment] = merger.get_next();\n        assert((comment === null) != (record === null));\n        if (record === null) {\n            result_lines.push(comment);\n            continue;\n        }\n        let aligned_fields = [];\n        for (let fnum = 0; fnum < record.length; fnum++) {\n            let field = record[fnum];\n            let field_lines = field.split('\\n');\n            for (let i = 0; i < field_lines.length; i++) {\n                if (i > 0) {\n                    result_lines.push(aligned_fields.join(delim));\n                    aligned_fields = [];\n                }\n                let aligned_field = field_lines[i].trim();\n                if (aligned_field.length != field_lines[i].length) {\n                    // Unlike in align function here we can just compare resulting length to decide if change has occured.\n                    has_edit = true;\n                }\n                aligned_fields.push(aligned_field);\n            }\n        }\n        result_lines.push(aligned_fields.join(delim));\n    }\n    if (!has_edit)\n        return [null, null];\n    return [result_lines.join('\\n'), null];\n}\n\n\nfunction make_table_name_key(file_path) {\n    return 'rbql_table_name:' + file_path;\n}\n\n\nfunction expanduser(filepath) {\n    if (filepath.charAt(0) === '~') {\n        return path.join(os.homedir(), filepath.slice(1));\n    }\n    return filepath;\n}\n\n\nfunction find_table_path(vscode_global_state, main_table_dir, table_id) {\n    // If table_id is a relative path it could be relative either to the current directory or to the main table dir.\n    var candidate_path = expanduser(table_id);\n    if (fs.existsSync(candidate_path)) {\n        return candidate_path;\n    }\n    if (main_table_dir && !path.isAbsolute(candidate_path)) {\n        candidate_path = path.join(main_table_dir, candidate_path);\n        if (fs.existsSync(candidate_path)) {\n            return candidate_path;\n        }\n    }\n    let table_path = vscode_global_state ? vscode_global_state.get(make_table_name_key(table_id)) : null;\n    if (table_path && fs.existsSync(table_path)) {\n        return table_path;\n    }\n    return null;\n}\n\n\nasync function read_header(table_path, encoding) {\n    if (encoding == 'latin-1')\n        encoding = 'binary';\n    let readline = require('readline');\n    let input_reader = readline.createInterface({ input: fs.createReadStream(table_path, {encoding: encoding}) });\n    let closed = false;\n    let promise_resolve = null;\n    let promise_reject = null;\n    let output_promise = new Promise(function(resolve, reject) {\n        promise_resolve = resolve;\n        promise_reject = reject;\n    });\n    input_reader.on('line', line => {\n        if (!closed) {\n            closed = true;\n            input_reader.close();\n            promise_resolve(line);\n        }\n    });\n    input_reader.on('error', error => {\n        promise_reject(error);\n    });\n    return output_promise;\n}\n\n\nfunction get_header_line(document, comment_prefix) {\n    const num_lines = document.lineCount;\n    for (let lnum = 0; lnum < num_lines; ++lnum) {\n        const line_text = document.lineAt(lnum).text;\n        if (!comment_prefix || !line_text.startsWith(comment_prefix)) {\n            return [lnum, line_text];\n        }\n    }\n    return [null, null];\n}\n\n\nfunction make_inconsistent_num_fields_warning(table_name, inconsistent_records_info) {\n    let [record_num_1, num_fields_1, record_num_2, num_fields_2] = rbql.sample_first_two_inconsistent_records(inconsistent_records_info);\n    let warn_msg = `Number of fields in \"${table_name}\" table is not consistent: `;\n    warn_msg += `e.g. record ${record_num_1 + 1} -> ${num_fields_1} fields, record ${record_num_2 + 1} -> ${num_fields_2} fields`;\n    return warn_msg;\n}\n\n\nclass RbqlIOHandlingError extends Error {}\n\nclass VSCodeRecordIterator extends rbql.RBQLInputIterator {\n    constructor(document, delim, policy, has_header=false, comment_prefix=null, table_name='input', variable_prefix='a') {\n        // We could have done a hack here actually: convert the document to stream/buffer and then use the standard reader.\n        super();\n        this.has_header = has_header;\n        this.table_name = table_name;\n        this.variable_prefix = variable_prefix;\n        this.NR = 0; // Record number.\n        this.NL = 0; // Line number (NL != NR when the CSV file has comments or multiline fields).\n        let fail_on_warning = policy == 'quoted_rfc';\n        let [_num_records_parsed, _comments] = [null, null];\n        [this.records, _num_records_parsed, this.fields_info, this.first_defective_line, this._first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(document, delim, policy, comment_prefix, fail_on_warning);\n        if (fail_on_warning && this.first_defective_line !== null) {\n            throw new RbqlIOHandlingError(`Inconsistent double quote escaping in ${this.table_name} table at record ${this.records.length}, line ${this.first_defective_line}`);\n        }\n        this.first_record = this.records.length ? this.records[0] : [];\n        this.next_record_index = 0;\n    }\n\n    stop() {\n    }\n\n    async get_variables_map(query_text) {\n        let variable_map = new Object();\n        rbql.parse_basic_variables(query_text, this.variable_prefix, variable_map);\n        rbql.parse_array_variables(query_text, this.variable_prefix, variable_map);\n        if (this.has_header) {\n            rbql.parse_attribute_variables(query_text, this.variable_prefix, this.first_record, 'CSV header line', variable_map);\n            rbql.parse_dictionary_variables(query_text, this.variable_prefix, this.first_record, variable_map);\n        }\n        return variable_map;\n    }\n\n    async get_header() {\n        return this.has_header ? this.first_record : null;\n    }\n\n    do_get_record() {\n        if (this.next_record_index >= this.records.length) {\n            return null;\n        }\n        let record = this.records[this.next_record_index];\n        this.next_record_index += 1;\n        return record;\n    }\n\n    async get_record() {\n        if (this.NR == 0 && this.has_header) {\n            this.do_get_record(); // Skip the header record.\n        }\n        this.NR += 1;\n        let record = this.do_get_record();\n        return record;\n    }\n\n    get_warnings() {\n        let result = [];\n        if (this.first_defective_line !== null)\n            result.push(`Inconsistent double quote escaping in ${this.table_name} table. E.g. at line ${this.first_defective_line}`);\n        if (this.fields_info.size > 1)\n            result.push(make_inconsistent_num_fields_warning(this.table_name, this.fields_info));\n        return result;\n    }\n}\n\n\nclass VSCodeWriter extends rbql.RBQLOutputWriter {\n    constructor(delim, policy) {\n        super();\n        this.delim = delim;\n        this.policy = policy;\n        this.header_len = null;\n        this.null_in_output = false;\n        this.delim_in_simple_output = false;\n        this.output_lines = [];\n\n        if (policy == 'simple') {\n            this.polymorphic_join = this.simple_join;\n        } else if (policy == 'quoted') {\n            this.polymorphic_join = this.quoted_join;\n        } else if (policy == 'quoted_rfc') {\n            this.polymorphic_join = this.quoted_join_rfc;\n        } else if (policy == 'monocolumn') {\n            this.polymorphic_join = this.mono_join;\n        } else if (policy == 'whitespace') {\n            this.polymorphic_join = this.simple_join;\n        } else {\n            throw new RbqlIOHandlingError('Unknown output csv policy');\n        }\n    }\n\n    set_header(header) {\n        if (header !== null) {\n            this.header_len = header.length;\n            this.write(header);\n        }\n    }\n\n    quoted_join(fields) {\n        let delim = this.delim;\n        var quoted_fields = fields.map(function(v) { return csv_utils.quote_field(String(v), delim); });\n        return quoted_fields.join(this.delim);\n    };\n\n\n    quoted_join_rfc(fields) {\n        let delim = this.delim;\n        var quoted_fields = fields.map(function(v) { return csv_utils.rfc_quote_field(String(v), delim); });\n        return quoted_fields.join(this.delim);\n    };\n\n\n    mono_join(fields) {\n        if (fields.length > 1) {\n            throw new RbqlIOHandlingError('Unable to use \"Monocolumn\" output format: some records have more than one field');\n        }\n        return fields[0];\n    };\n\n\n    simple_join(fields) {\n        var res = fields.join(this.delim);\n        if (fields.join('').indexOf(this.delim) != -1) {\n            this.delim_in_simple_output = true;\n        }\n        return res;\n    };\n\n\n    normalize_fields(out_fields) {\n        for (var i = 0; i < out_fields.length; i++) {\n            if (out_fields[i] == null) {\n                this.null_in_output = true;\n                out_fields[i] = '';\n            } else if (Array.isArray(out_fields[i])) {\n                this.normalize_fields(out_fields[i]);\n                out_fields[i] = out_fields[i].join(this.sub_array_delim);\n            }\n        }\n    };\n\n\n    write(fields) {\n        if (this.header_len !== null && fields.length != this.header_len)\n            throw new RbqlIOHandlingError(`Inconsistent number of columns in output header and the current record: ${this.header_len} != ${fields.length}`);\n        this.normalize_fields(fields);\n        this.output_lines.push(this.polymorphic_join(fields));\n        return true;\n    };\n\n    async finish() {\n    }\n\n    get_warnings() {\n        let result = [];\n        if (this.null_in_output)\n            result.push('null values in output were replaced by empty strings');\n        if (this.delim_in_simple_output)\n            result.push('Some output fields contain separator');\n        return result;\n    };\n}\n\nclass VSCodeTableRegistry {\n    constructor(){}\n\n    get_iterator_by_table_id(_table_id) {\n        throw new RbqlIOHandlingError(\"JOIN queries are currently not supported in vscode.dev web version.\");\n    }\n\n    get_warnings() {\n        return [];\n    };\n}\n\nasync function rbql_query_web(query_text, input_document, input_delim, input_policy, output_delim, output_policy, output_warnings, with_headers, comment_prefix=null) {\n    let user_init_code = ''; // TODO find a way to have init code.\n    let join_tables_registry = new VSCodeTableRegistry(); // TODO find a way to have join registry.\n    let input_iterator = new VSCodeRecordIterator(input_document, input_delim, input_policy, with_headers, comment_prefix);\n    let output_writer = new VSCodeWriter(output_delim, output_policy);\n    await rbql.query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry, user_init_code);\n    return output_writer.output_lines;\n}\n\n\nclass VSCodeFileSystemCSVRegistry extends rbql.RBQLTableRegistry {\n    constructor(vscode_global_state, input_file_dir, delim, policy, encoding, has_header=false, comment_prefix=null, options=null) {\n        super();\n        this.vscode_global_state = vscode_global_state;\n        this.input_file_dir = input_file_dir;\n        this.delim = delim;\n        this.policy = policy;\n        this.encoding = encoding;\n        this.has_header = has_header;\n        this.comment_prefix = comment_prefix;\n        this.stream = null;\n        this.record_iterator = null;\n\n        this.options = options;\n        this.bulk_input_path = null;\n        this.table_path = null;\n    }\n\n    get_iterator_by_table_id(table_id) {\n        this.table_path = find_table_path(this.vscode_global_state, this.input_file_dir, table_id);\n        if (this.table_path === null) {\n            throw new RbqlIOHandlingError(`Unable to find join table \"${table_id}\"`);\n        }\n        if (this.options && this.options['bulk_read']) {\n            this.bulk_input_path = this.table_path;\n        } else {\n            this.stream = fs.createReadStream(this.table_path);\n        }\n        this.record_iterator = new rbql_csv.CSVRecordIterator(this.stream, this.bulk_input_path, this.encoding, this.delim, this.policy, this.has_header, this.comment_prefix, table_id, 'b');\n        return this.record_iterator;\n    };\n\n    get_warnings(output_warnings) {\n        if (this.record_iterator && this.has_header) {\n            output_warnings.push(`The first record in JOIN file ${path.basename(this.table_path)} was also treated as header (and skipped)`);\n        }\n    }\n}\n\n\nasync function rbql_query_node(vscode_global_state, query_text, input_path, input_delim, input_policy, output_path, output_delim, output_policy, csv_encoding, output_warnings, with_headers=false, comment_prefix=null, user_init_code='', options=null) {\n    let input_stream = null;\n    let bulk_input_path = null;\n    if (options && options['bulk_read'] && input_path) {\n        bulk_input_path = input_path;\n    } else {\n        input_stream = input_path === null ? process.stdin : fs.createReadStream(input_path);\n    }\n    let [output_stream, close_output_on_finish] = output_path === null ? [process.stdout, false] : [fs.createWriteStream(output_path), true];\n    if (input_delim == '\"' && input_policy == 'quoted')\n        throw new RbqlIOHandlingError('Double quote delimiter is incompatible with \"quoted\" policy');\n    if (csv_encoding == 'latin-1')\n        csv_encoding = 'binary';\n    if (!rbql_csv.is_ascii(query_text) && csv_encoding == 'binary')\n        throw new RbqlIOHandlingError('To use non-ascii characters in query enable UTF-8 encoding instead of latin-1/binary');\n    if ((!rbql_csv.is_ascii(input_delim) || !rbql_csv.is_ascii(output_delim)) && csv_encoding == 'binary')\n        throw new RbqlIOHandlingError('To use non-ascii characters in query enable UTF-8 encoding instead of latin-1/binary');\n\n    let default_init_source_path = path.join(os.homedir(), '.rbql_init_source.js');\n    if (user_init_code == '' && fs.existsSync(default_init_source_path)) {\n        user_init_code = rbql_csv.read_user_init_code(default_init_source_path);\n    }\n    let input_file_dir = input_path ? path.dirname(input_path) : null;\n    let join_tables_registry = new VSCodeFileSystemCSVRegistry(vscode_global_state, input_file_dir, input_delim, input_policy, csv_encoding, with_headers, comment_prefix, options);\n    let input_iterator = new rbql_csv.CSVRecordIterator(input_stream, bulk_input_path, csv_encoding, input_delim, input_policy, with_headers, comment_prefix);\n    let output_writer = new rbql_csv.CSVWriter(output_stream, close_output_on_finish, csv_encoding, output_delim, output_policy);\n\n    await rbql.query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry, user_init_code);\n    join_tables_registry.get_warnings(output_warnings);\n}\n\n\nfunction make_multiline_record_ranges(vscode, delim_length, newline_marker, fields, start_line, expected_end_line_for_control) {\n    // Semantic ranges in VSCode can't span multiple lines, so we use this workaround.\n    let record_ranges = [];\n    let lnum_current = start_line;\n    let pos_in_editor_line = 0;\n    let next_pos_in_editor_line = 0;\n    for (let i = 0; i < fields.length; i++) {\n        let pos_in_logical_field = 0;\n        // Group tokens belonging to the same logical field.\n        let logical_field_tokens = [];\n        while (true) {\n            let newline_marker_pos = fields[i].indexOf(newline_marker, pos_in_logical_field);\n            if (newline_marker_pos == -1)\n                break;\n            logical_field_tokens.push(new vscode.Range(lnum_current, pos_in_editor_line, lnum_current, pos_in_editor_line + newline_marker_pos - pos_in_logical_field));\n            lnum_current += 1;\n            pos_in_editor_line = 0;\n            next_pos_in_editor_line = 0;\n            pos_in_logical_field = newline_marker_pos + newline_marker.length;\n        }\n        next_pos_in_editor_line += fields[i].length - pos_in_logical_field;\n        if (i + 1 < fields.length) {\n            next_pos_in_editor_line += delim_length;\n        }\n        logical_field_tokens.push(new vscode.Range(lnum_current, pos_in_editor_line, lnum_current, next_pos_in_editor_line));\n        record_ranges.push(logical_field_tokens);\n        // From semantic tokenization perspective the end of token doesn't include the last character of vscode.Range i.e. it treats the range as [) interval, unlike the Range.contains() function which treats ranges as [] intervals.\n        pos_in_editor_line = next_pos_in_editor_line;\n    }\n    assert(lnum_current == expected_end_line_for_control);\n    return record_ranges;\n}\n\n\nfunction is_opening_rfc_line(line_text, delim) {\n    // The line is oppening if by adding a character (to avoid accidental double double quote) and single double quote at the end we can make it parsable without warning!\n    // Some lines can be simultaneously opening and closing, e.g. `\",a1,a2` or `a1,a2,\"`\n    let [_record, warning] = csv_utils.split_quoted_str(line_text + 'x\"', delim);\n    return !warning;\n}\n\n\nfunction parse_document_range_rfc(vscode, doc, delim, comment_prefix, range, custom_parsing_margin=null) {\n    if (custom_parsing_margin === null) {\n        custom_parsing_margin = dynamic_csv_highlight_margin;\n    }\n    let begin_line = Math.max(0, range.start.line - custom_parsing_margin);\n    let end_line = Math.min(doc.lineCount, range.end.line + custom_parsing_margin);\n    let table_ranges = [];\n    let line_aggregator = new csv_utils.MultilineRecordAggregator(comment_prefix);\n    // The first or the second line in range with an odd number of double quotes is a start line, after finding it we can use the standard parsing algorithm.\n    for (let lnum = begin_line; lnum < end_line; lnum++) {\n        let line_text = doc.lineAt(lnum).text;\n        if (lnum + 1 == doc.lineCount && !line_text)\n            break;\n        let inside_multiline_record_before = line_aggregator.is_inside_multiline_record();\n        let start_line = lnum - line_aggregator.get_num_lines_in_record();\n        line_aggregator.add_line(line_text);\n        let inside_multiline_record_after = line_aggregator.is_inside_multiline_record();\n        if (!inside_multiline_record_before && inside_multiline_record_after) {\n            // Must be an odd-num line, check if this is an openning line - otherwise reset ranges.\n            if (!is_opening_rfc_line(line_text, delim)) {\n                table_ranges = [];\n                line_aggregator.reset();\n            }\n        }\n        if (line_aggregator.has_comment_line) {\n            table_ranges.push({comment_range: new vscode.Range(lnum, 0, lnum, line_text.length)});\n            line_aggregator.reset();\n        } else if (line_aggregator.has_full_record) {\n            const newline_marker = '\\r\\n'; // Use '\\r\\n' here to guarantee that this sequence is not present anywhere in the lines themselves.\n            let combined_line = line_aggregator.get_full_line(newline_marker);\n            line_aggregator.reset();\n            let [fields, warning] = csv_utils.smart_split(combined_line, delim, QUOTED_POLICY, /*preserve_quotes_and_whitespaces=*/true);\n            if (!warning) {\n                table_ranges.push({record_ranges: make_multiline_record_ranges(vscode, delim.length, newline_marker, fields, start_line, lnum)});\n            }\n        }\n    }\n    return table_ranges;\n}\n\n\nfunction parse_document_range_single_line(vscode, doc, delim, policy, comment_prefix, range) {\n    let table_ranges = [];\n    let begin_line = Math.max(0, range.start.line - dynamic_csv_highlight_margin);\n    let end_line = Math.min(doc.lineCount, range.end.line + dynamic_csv_highlight_margin);\n    for (let lnum = begin_line; lnum < end_line; lnum++) {\n        let record_ranges = [];\n        let line_text = doc.lineAt(lnum).text;\n        if (lnum + 1 == doc.lineCount && !line_text)\n            break;\n        if (comment_prefix && line_text.startsWith(comment_prefix)) {\n            table_ranges.push({comment_range: new vscode.Range(lnum, 0, lnum, line_text.length)});\n            continue;\n        }\n        let split_result = csv_utils.smart_split(line_text, delim, policy, /*preserve_quotes_and_whitespaces=*/true);\n        // TODO consider handling comments and warnings\n        let fields = split_result[0];\n        let cpos = 0;\n        let next_cpos = 0;\n        for (let i = 0; i < fields.length; i++) {\n            next_cpos += fields[i].length;\n            if (i + 1 < fields.length) {\n                next_cpos += delim.length;\n            }\n            record_ranges.push([new vscode.Range(lnum, cpos, lnum, next_cpos)]);\n            // From semantic tokenization perspective the end of token doesn't include the last character of vscode.Range i.e. it treats the range as [) interval, unlike the Range.contains() function which treats ranges as [] intervals.\n            cpos = next_cpos;\n        }\n        table_ranges.push({record_ranges: record_ranges});\n    }\n    return table_ranges;\n}\n\n\nfunction parse_document_range(vscode, doc, delim, policy, comment_prefix, range) {\n    if (policy == QUOTED_RFC_POLICY) {\n        return parse_document_range_rfc(vscode, doc, delim, comment_prefix, range);\n    } else {\n        return parse_document_range_single_line(vscode, doc, delim, policy, comment_prefix, range);\n    }\n}\n\n\nfunction get_field_by_line_position(fields, delim_length, query_pos) {\n    if (!fields.length)\n        return null;\n    var col_num = 0;\n    var cpos = fields[col_num].length + delim_length;\n    while (query_pos > cpos && col_num + 1 < fields.length) {\n        col_num += 1;\n        cpos = cpos + fields[col_num].length + delim_length;\n    }\n    return col_num;\n}\n\n\nfunction get_cursor_position_info_rfc(vscode, document, delim, comment_prefix, position) {\n    const hover_parse_margin = 20;\n    let range = new vscode.Range(Math.max(position.line - hover_parse_margin, 0), 0, position.line + hover_parse_margin, 0);\n    let table_ranges = parse_document_range_rfc(vscode, document, delim, comment_prefix, range);\n    let last_found_position_info = null; // Use last found instead of first found because cursor position at the border can belong to two ranges simultaneously.\n    for (let row_info of table_ranges) {\n        if (row_info.hasOwnProperty('comment_range')) {\n            if (row_info.comment_range.contains(position)) {\n                last_found_position_info = {is_comment: true};\n            }\n        } else {\n            for (let col_num = 0; col_num < row_info.record_ranges.length; col_num++) {\n                // One logical field can map to multiple ranges if it spans multiple lines.\n                for (let record_range of row_info.record_ranges[col_num]) {\n                    if (record_range.contains(position)) {\n                        last_found_position_info = {column_number: col_num, total_columns: row_info.record_ranges.length, split_warning: false};\n                    }\n                }\n            }\n        }\n    }\n    return last_found_position_info;\n}\n\n\nfunction get_cursor_position_info_standard(document, delim, policy, comment_prefix, position) {\n    var lnum = position.line;\n    var cnum = position.character;\n    var line = document.lineAt(lnum).text;\n\n    if (comment_prefix && line.startsWith(comment_prefix))\n        return {is_comment: true};\n\n    let [entries, warning] = csv_utils.smart_split(line, delim, policy, true);\n    var col_num = get_field_by_line_position(entries, delim.length, cnum + 1);\n    if (col_num == null)\n        return null;\n    return {column_number: col_num, total_columns: entries.length, split_warning: warning};\n}\n\n\nfunction get_cursor_position_info(vscode, document, delim, policy, comment_prefix, position) {\n    if (policy === null)\n        return null;\n    if (policy == QUOTED_RFC_POLICY) {\n        return get_cursor_position_info_rfc(vscode, document, delim, comment_prefix, position);\n    } else {\n        return get_cursor_position_info_standard(document, delim, policy, comment_prefix, position);\n    }\n}\n\n\nfunction format_cursor_position_info(cursor_position_info, header, show_column_names, show_comments, max_label_length) {\n    if (cursor_position_info.is_comment) {\n        if (show_comments) {\n            return ['Comment', 'Comment'];\n        } else {\n            return [null, null];\n        }\n    }\n    let short_report = 'Col ' + (cursor_position_info.column_number + 1);\n    let full_report = '[Rainbow CSV] ' + short_report;\n    if (show_column_names && cursor_position_info.column_number < header.length) {\n        let column_label = header[cursor_position_info.column_number].trim();\n        let short_column_label = column_label.substr(0, max_label_length);\n        if (short_column_label != column_label)\n            short_column_label = short_column_label + '...';\n        short_report += ': ' + short_column_label;\n        full_report += ': ' + column_label;\n    }\n    if (cursor_position_info.split_warning) {\n        full_report += '; ERR: Inconsistent double quotes in line';\n    } else if (header.length != cursor_position_info.total_columns) {\n        full_report += `; WARN: Inconsistent num of fields, header: ${header.length}, this line: ${cursor_position_info.total_columns}`;\n    }\n    return [full_report, short_report];\n}\n\n\nfunction sample_records(document, delim, policy, comment_prefix, end_record, preview_window_size, stop_on_warning, cached_table_parse_result) {\n    let records = [];\n    let first_failed_line = null;\n    let vscode_doc_version = null;\n    let [_num_records_parsed, _fields_info, _first_trailing_space_line, _comments] = [null, null, null, null];\n    // Here `preview_window_size` is typically 100.\n    if (end_record < preview_window_size * 5) {\n        // Re-sample the records. Re-sampling top records is fast and it ensures that all manual changes are mirrored into RBQL console.\n        [records, _num_records_parsed, _fields_info, first_failed_line, _first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(document, delim, policy, comment_prefix, stop_on_warning, /*max_records_to_parse=*/end_record, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/false);\n    } else {\n        let need_full_doc_parse = true;\n        if (cached_table_parse_result.has(document.fileName)) {\n            [records, first_failed_line, vscode_doc_version] = cached_table_parse_result.get(document.fileName);\n            if (document.version === vscode_doc_version) {\n                need_full_doc_parse = false;\n            }\n        }\n        if (need_full_doc_parse) {\n            let [records, _num_records_parsed, _fields_info, first_failed_line, _first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(document, delim, policy, comment_prefix, stop_on_warning, /*max_records_to_parse=*/-1, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/false);\n            cached_table_parse_result.set(document.fileName, [records, first_failed_line, document.version]);\n        }\n        [records, first_failed_line, vscode_doc_version] = cached_table_parse_result.get(document.fileName);\n    }\n    return [records, first_failed_line];\n}\n\n\nfunction sample_preview_records_from_context(rbql_context, dst_message, preview_window_size, cached_table_parse_result) {\n    let [document, delim, policy, comment_prefix] = [rbql_context.input_document, rbql_context.delim, rbql_context.policy, rbql_context.comment_prefix];\n    rbql_context.requested_start_record = Math.max(rbql_context.requested_start_record, 0);\n    let stop_on_warning = policy == QUOTED_RFC_POLICY;\n    let [records, first_failed_line] = sample_records(document, delim, policy, comment_prefix, rbql_context.requested_start_record + preview_window_size, preview_window_size, stop_on_warning, cached_table_parse_result);;\n    if (first_failed_line !== null && policy == QUOTED_RFC_POLICY) {\n        dst_message.preview_sampling_error = `Double quotes are not consistent in record ${records.length + 1} which starts at line ${first_failed_line + 1}`;\n        return;\n    }\n    rbql_context.requested_start_record = Math.max(0, Math.min(rbql_context.requested_start_record, records.length - preview_window_size));\n    let preview_records = records.slice(rbql_context.requested_start_record, rbql_context.requested_start_record + preview_window_size);\n\n    // Here we trim excessively long fields. The only benefit of doing is here instead of UI layer is to minimize the ammount of traffic that we send to UI - the total message size is limited.\n    for (let r = 0; r < preview_records.length; r++) {\n        let cur_record = preview_records[r];\n        for (let c = 0; c < cur_record.length; c++) {\n            if (cur_record[c].length > max_preview_field_length) {\n                cur_record[c] = cur_record[c].substr(0, max_preview_field_length) + '###UI_STRING_TRIM_MARKER###';\n            }\n        }\n    }\n    dst_message.preview_records = preview_records;\n    dst_message.actual_start_record = rbql_context.requested_start_record;\n}\n\n\nfunction show_lint_status_bar_button(vscode, extension_context, file_path, language_id) {\n    let lint_cache_key = `${file_path}.${language_id}`;\n    if (!extension_context.lint_results.has(lint_cache_key))\n        return;\n    var lint_report = extension_context.lint_results.get(lint_cache_key);\n    if (!extension_context.lint_status_bar_button)\n        extension_context.lint_status_bar_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    extension_context.lint_status_bar_button.text = 'CSVLint';\n    let lint_report_msg = '';\n    if (lint_report.is_processing) {\n        extension_context.lint_status_bar_button.color = '#A0A0A0';\n        lint_report_msg = 'Processing';\n    } else if (Number.isInteger(lint_report.first_defective_line)) {\n        lint_report_msg = `Error. Line ${lint_report.first_defective_line} has formatting error: double quote chars are not consistent`;\n        extension_context.lint_status_bar_button.color = '#f44242';\n    } else if (lint_report.fields_info && lint_report.fields_info.size > 1) {\n        let [record_num_1, num_fields_1, record_num_2, num_fields_2] = rbql.sample_first_two_inconsistent_records(lint_report.fields_info);\n        lint_report_msg = `Error. Number of fields is not consistent: e.g. record ${record_num_1 + 1} has ${num_fields_1} fields, and record ${record_num_2 + 1} has ${num_fields_2} fields`;\n        extension_context.lint_status_bar_button.color = '#f44242';\n    } else if (Number.isInteger(lint_report.first_trailing_space_line)) {\n        lint_report_msg = `Leading/Trailing spaces detected: e.g. at line ${lint_report.first_trailing_space_line + 1}. Run \"Shrink\" command to remove them`;\n        extension_context.lint_status_bar_button.color = '#ffff28';\n    } else {\n        assert(lint_report.is_ok);\n        extension_context.lint_status_bar_button.color = '#62f442';\n        lint_report_msg = 'OK';\n    }\n    extension_context.lint_status_bar_button.tooltip = lint_report_msg + '\\nClick to recheck';\n    extension_context.lint_status_bar_button.command = 'rainbow-csv.CSVLint';\n    extension_context.lint_status_bar_button.show();\n}\n\n\nfunction generate_column_edit_selections(vscode, active_doc, delim, policy, comment_prefix, edit_mode, col_num) {\n    let [records, _num_records_parsed, _fields_info, first_defective_line, _first_trailing_space_line, comments] = fast_load_utils.parse_document_records(active_doc, delim, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/true);\n    if (first_defective_line !== null) {\n        return [null, `Unable to enter column edit mode: quoting error at line ${first_defective_line + 1}`, null];\n    }\n    if (records.length + comments.length != active_doc.lineCount) {\n        // It is possible to support editing of non-multiline columns in such files, but for simplicity we won't do this.\n        return [null, 'Column edit mode is not supported for files with multiline fields', null];\n    }\n    let lnum = 0;\n    let selections = [];\n    let warning_msg = null;\n    let merger = new RecordCommentMerger(records, comments);\n    while (merger.has_entries_left()) {\n        let [record, comment] = merger.get_next();\n        assert((comment === null) != (record === null));\n        if (record !== null) {\n            if (col_num >= record.length) {\n                return [null, `Line ${lnum + 1} doesn't have field number ${col_num + 1}`, null];\n            }\n            let char_pos_before = record.slice(0, col_num).join('').length + col_num * delim.length;\n            let char_pos_after = record.slice(0, col_num + 1).join('').length + col_num * delim.length;\n            let line_text = record.join(delim);\n            if (!warning_msg && edit_mode == 'ce_before' && (policy == QUOTED_POLICY || policy == QUOTED_RFC_POLICY) && line_text.substring(char_pos_before - 2, char_pos_before + 2).indexOf('\"') != -1) {\n                warning_msg = `Be careful, cursor at line ${lnum + 1} has a double quote is in proximity.`;\n            }\n            if (!warning_msg && edit_mode == 'ce_after' && (policy == QUOTED_POLICY || policy == QUOTED_RFC_POLICY) && line_text.substring(char_pos_after - 2, char_pos_after + 2).indexOf('\"') != -1) {\n                warning_msg = `Be careful, cursor at line ${lnum + 1} has a double quote is in proximity.`;\n            }\n            if (!warning_msg && edit_mode == 'ce_select' && char_pos_before == char_pos_after) {\n                warning_msg = `Be careful, Field ${col_num + 1} at line ${lnum + 1} is empty.`;\n            }\n            let position_before = new vscode.Position(lnum, char_pos_before);\n            let position_after = new vscode.Position(lnum, char_pos_after);\n            if (edit_mode == 'ce_before') {\n                selections.push(new vscode.Selection(position_before, position_before));\n            }\n            if (edit_mode == 'ce_after') {\n                selections.push(new vscode.Selection(position_after, position_after));\n            }\n            if (edit_mode == 'ce_select') {\n                selections.push(new vscode.Selection(position_before, position_after));\n            }\n        }\n        lnum += 1;\n    }\n    return [selections, null, warning_msg];\n}\n\n\nmodule.exports.make_table_name_key = make_table_name_key;\nmodule.exports.find_table_path = find_table_path;\nmodule.exports.read_header = read_header;\nmodule.exports.rbql_query_web = rbql_query_web;\nmodule.exports.rbql_query_node = rbql_query_node;\nmodule.exports.get_header_line = get_header_line;\nmodule.exports.get_default_js_udf_content = get_default_js_udf_content;\nmodule.exports.get_default_python_udf_content = get_default_python_udf_content;\nmodule.exports.align_columns = align_columns;\nmodule.exports.shrink_columns = shrink_columns;\nmodule.exports.calc_column_stats = calc_column_stats;\nmodule.exports.adjust_column_stats = adjust_column_stats;\nmodule.exports.update_subcomponent_stats = update_subcomponent_stats;\nmodule.exports.align_field = align_field;\nmodule.exports.rfc_align_field = rfc_align_field;\nmodule.exports.assert = assert;\nmodule.exports.get_field_by_line_position = get_field_by_line_position;\nmodule.exports.get_cursor_position_info = get_cursor_position_info;\nmodule.exports.format_cursor_position_info = format_cursor_position_info;\nmodule.exports.parse_document_range = parse_document_range;\nmodule.exports.sample_preview_records_from_context = sample_preview_records_from_context;\nmodule.exports.parse_document_range_rfc = parse_document_range_rfc; // Only for unit tests.\nmodule.exports.sample_first_two_inconsistent_records = rbql.sample_first_two_inconsistent_records;\nmodule.exports.is_opening_rfc_line = is_opening_rfc_line; // Only for unit tests.\nmodule.exports.show_lint_status_bar_button = show_lint_status_bar_button;\nmodule.exports.get_cursor_position_if_unambiguous = get_cursor_position_if_unambiguous;\nmodule.exports.RecordCommentMerger = RecordCommentMerger;\nmodule.exports.generate_column_edit_selections = generate_column_edit_selections;\n","let field_regular_expression = '\"((?:[^\"]*\"\")*[^\"]*)\"';\nlet field_rgx = new RegExp('^' + field_regular_expression);\nlet field_rgx_external_whitespaces = new RegExp('^ *' + field_regular_expression + ' *');\n\n\n// TODO consider making this file (and rbql.js) both node and browser compatible: https://caolan.org/posts/writing_for_node_and_the_browser.html\n\n\nfunction split_lines(text) {\n    return text.split(/\\r\\n|\\r|\\n/);\n}\n\n\nfunction extract_next_field(src, dlm, preserve_quotes_and_whitespaces, allow_external_whitespaces, cidx, result) {\n    var warning = false;\n    let src_cur = src.substring(cidx);\n    let rgx = allow_external_whitespaces ? field_rgx_external_whitespaces : field_rgx;\n    let match_obj = rgx.exec(src_cur);\n    if (match_obj !== null) {\n        let match_end = match_obj[0].length;\n        if (cidx + match_end == src.length || src[cidx + match_end] == dlm) {\n            if (preserve_quotes_and_whitespaces) {\n                result.push(match_obj[0]);\n            } else {\n                result.push(match_obj[1].replace(/\"\"/g, '\"'));\n            }\n            return [cidx + match_end + 1, false];\n        }\n        warning = true;\n    }\n    var uidx = src.indexOf(dlm, cidx);\n    if (uidx == -1)\n        uidx = src.length;\n    var field = src.substring(cidx, uidx);\n    warning = warning || field.indexOf('\"') != -1;\n    result.push(field);\n    return [uidx + 1, warning];\n}\n\n\nfunction split_quoted_str(src, dlm, preserve_quotes_and_whitespaces=false) {\n    // This function is newline-agnostic i.e. it can also split records with multiline fields.\n    if (src.indexOf('\"') == -1) // Optimization for most common case\n        return [src.split(dlm), false];\n    var result = [];\n    var cidx = 0;\n    var warning = false;\n    let allow_external_whitespaces = dlm != ' ';\n    while (cidx < src.length) {\n        var extraction_report = extract_next_field(src, dlm, preserve_quotes_and_whitespaces, allow_external_whitespaces, cidx, result);\n        cidx = extraction_report[0];\n        warning = warning || extraction_report[1];\n    }\n    if (src.charAt(src.length - 1) == dlm)\n        result.push('');\n    return [result, warning];\n}\n\n\nfunction quote_field(src, delim) {\n    if (src.indexOf(delim) != -1 || src.indexOf('\"') != -1) {\n        var escaped = src.replace(/\"/g, '\"\"');\n        return `\"${escaped}\"`;\n    }\n    return src;\n}\n\n\nfunction rfc_quote_field(src, delim) {\n    if (src.indexOf(delim) != -1 || src.indexOf('\"') != -1 || src.indexOf('\\n') != -1 || src.indexOf('\\r') != -1) {\n        var escaped = src.replace(/\"/g, '\"\"');\n        return `\"${escaped}\"`;\n    }\n    return src;\n}\n\n\nfunction unquote_field(field) {\n    let rgx = new RegExp('^' + ' *' + field_regular_expression + ' *$');\n    let match_obj = rgx.exec(field);\n    if (match_obj !== null) {\n        return match_obj[1].replace(/\"\"/g, '\"');\n    }\n    return field;\n}\n\n\nfunction unquote_fields(fields) {\n    return fields.map(unquote_field);\n}\n\n\nfunction split_whitespace_separated_str(src, preserve_whitespaces=false) {\n    var rgxp = preserve_whitespaces ? new RegExp(' *[^ ]+ *', 'g') : new RegExp('[^ ]+', 'g');\n    let result = [];\n    let match_obj = null;\n    while((match_obj = rgxp.exec(src)) !== null) {\n        result.push(match_obj[0]);\n    }\n    if (preserve_whitespaces) {\n        for (let i = 0; i < result.length - 1; i++) {\n            result[i] = result[i].slice(0, -1);\n        }\n    }\n    return result;\n}\n\n\nfunction smart_split(src, dlm, policy, preserve_quotes_and_whitespaces) {\n    if (policy === 'simple')\n        return [src.split(dlm), false];\n    if (policy === 'whitespace')\n        return [split_whitespace_separated_str(src, preserve_quotes_and_whitespaces), false];\n    if (policy === 'monocolumn')\n        return [[src], false];\n    return split_quoted_str(src, dlm, preserve_quotes_and_whitespaces);\n}\n\n\nclass MultilineRecordAggregator {\n    constructor(comment_prefix) {\n        this.comment_prefix = comment_prefix;\n        this.reset();\n    }\n    add_line(line_text) {\n        if (this.has_full_record || this.has_comment_line) {\n            throw new Error('Invalid usage - record aggregator must be reset before adding new lines');\n        }\n        if (this.comment_prefix && this.rfc_line_buffer.length == 0 && line_text.startsWith(this.comment_prefix)) {\n            this.has_comment_line = true;\n            return false;\n        }\n        let match_list = line_text.match(/\"/g);\n        let has_unbalanced_double_quote = match_list && match_list.length % 2 == 1;\n        this.rfc_line_buffer.push(line_text);\n        this.has_full_record = (!has_unbalanced_double_quote && this.rfc_line_buffer.length == 1) || (has_unbalanced_double_quote && this.rfc_line_buffer.length > 1);\n        return this.has_full_record;\n    }\n    is_inside_multiline_record() {\n        return this.rfc_line_buffer.length && !this.has_full_record;\n    }\n    get_full_line(line_separator) {\n        return this.rfc_line_buffer.join(line_separator);\n    }\n    get_num_lines_in_record() {\n        return this.rfc_line_buffer.length;\n    }\n    reset() {\n        this.rfc_line_buffer = [];\n        this.has_full_record = false;\n        this.has_comment_line = false;\n    }\n}\n\n\nmodule.exports.split_quoted_str = split_quoted_str;\nmodule.exports.split_whitespace_separated_str = split_whitespace_separated_str;\nmodule.exports.smart_split = smart_split;\nmodule.exports.quote_field = quote_field;\nmodule.exports.rfc_quote_field = rfc_quote_field;\nmodule.exports.unquote_field = unquote_field;\nmodule.exports.unquote_fields = unquote_fields;\nmodule.exports.split_lines = split_lines;\nmodule.exports.MultilineRecordAggregator = MultilineRecordAggregator;\n","(function(exports){\n// The magic line above is to make the module both browser and Node compatible, see https://stackoverflow.com/questions/3225251/how-can-i-share-code-between-node-js-and-the-browser\n\n// This module works with records only. It is CSV-agnostic.\n// Do not add CSV-related logic or variables/functions/objects like \"delim\", \"separator\" etc\n\n\nclass RbqlParsingError extends Error {}\nclass RbqlRuntimeError extends Error {}\nclass AssertionError extends Error {}\nclass RbqlIOHandlingError extends Error {}\n\n\nclass InternalBadFieldError extends Error {\n    constructor(bad_idx, ...params) {\n        super(...params);\n        this.bad_idx = bad_idx;\n    }\n}\n\n\nfunction assert(condition, message=null) {\n    if (!condition) {\n        if (!message) {\n            message = 'Assertion error';\n        }\n        throw new AssertionError(message);\n    }\n}\n\n\nfunction replace_all(src, search, replacement) {\n    return src.split(search).join(replacement);\n}\n\n\nclass RBQLContext {\n    constructor(query_text, input_iterator, output_writer, user_init_code) {\n        this.query_text = query_text;\n        this.input_iterator = input_iterator;\n        this.writer = output_writer;\n        this.user_init_code = user_init_code;\n\n        this.unnest_list = null;\n        this.top_count = null;\n\n        this.like_regex_cache = new Map();\n\n        this.sort_key_expression = null;\n\n        this.aggregation_stage = 0;\n        this.aggregation_key_expression = null;\n        this.functional_aggregators = [];\n\n        this.join_map_impl = null;\n        this.join_map = null;\n        this.lhs_join_var_expression = null;\n\n        this.where_expression = null;\n\n        this.select_expression = null;\n\n        this.update_expressions = null;\n\n        this.variables_init_code = null;\n    }\n}\n\nvar query_context = null; // Needs to be global for MIN(), MAX(), etc functions. TODO find a way to make it local.\n\n\nconst wrong_aggregation_usage_error = 'Usage of RBQL aggregation functions inside JavaScript expressions is not allowed, see the docs';\nconst RBQL_VERSION = '0.27.0';\n\n\nfunction check_if_brackets_match(opening_bracket, closing_bracket) {\n    return (opening_bracket == '[' && closing_bracket == ']') || (opening_bracket == '(' && closing_bracket == ')') || (opening_bracket == '{' && closing_bracket == '}');\n}\n\n\nfunction parse_root_bracket_level_text_spans(select_expression) {\n    let text_spans = []; // parts of text separated by commas at the root parenthesis level\n    let last_pos = 0;\n    let bracket_stack = [];\n    for (let i = 0; i < select_expression.length; i++) {\n        let cur_char = select_expression[i];\n        if (cur_char == ',' && bracket_stack.length == 0) {\n            text_spans.push(select_expression.substring(last_pos, i));\n            last_pos = i + 1;\n        } else if (['[', '{', '('].indexOf(cur_char) != -1) {\n            bracket_stack.push(cur_char);\n        } else if ([']', '}', ')'].indexOf(cur_char) != -1) {\n            if (bracket_stack.length && check_if_brackets_match(bracket_stack[bracket_stack.length - 1], cur_char)) {\n                bracket_stack.pop();\n            } else {\n                throw new RbqlParsingError(`Unable to parse column headers in SELECT expression: No matching opening bracket for closing \"${cur_char}\"`);\n            }\n        }\n    }\n    if (bracket_stack.length) {\n        throw new RbqlParsingError(`Unable to parse column headers in SELECT expression: No matching closing bracket for opening \"${bracket_stack[0]}\"`);\n    }\n    text_spans.push(select_expression.substring(last_pos, select_expression.length));\n    text_spans = text_spans.map(span => span.trim());\n    return text_spans;\n}\n\n\nfunction unquote_string(quoted_str) {\n    // It's possible to use eval here to unqoute the quoted_column_name, but it would be a little barbaric, let's do it manually instead\n    if (!quoted_str || quoted_str.length < 2)\n        return null;\n    if (quoted_str[0] == \"'\" && quoted_str[quoted_str.length - 1] == \"'\") {\n        return quoted_str.substring(1, quoted_str.length - 1).replace(/\\\\'/g, \"'\").replace(/\\\\\\\\/g, \"\\\\\");\n    } else if (quoted_str[0] == '\"' && quoted_str[quoted_str.length - 1] == '\"') {\n        return quoted_str.substring(1, quoted_str.length - 1).replace(/\\\\\"/g, '\"').replace(/\\\\\\\\/g, \"\\\\\");\n    } else {\n        return null;\n    }\n}\n\n\nfunction column_info_from_text_span(text_span, string_literals) {\n    // This function is a rough equivalent of \"column_info_from_node()\" function in python version of RBQL\n    text_span = text_span.trim();\n    let rbql_star_marker = '__RBQL_INTERNAL_STAR';\n    let simple_var_match = /^[_a-zA-Z][_a-zA-Z0-9]*$/.exec(text_span);\n    let attribute_match = /^([ab])\\.([_a-zA-Z][_a-zA-Z0-9]*)$/.exec(text_span);\n    let subscript_int_match = /^([ab])\\[([0-9]+)\\]$/.exec(text_span);\n    let subscript_str_match = /^([ab])\\[___RBQL_STRING_LITERAL([0-9]+)___\\]$/.exec(text_span);\n    let as_alias_match = /^(.*) (as|AS) +([a-zA-Z][a-zA-Z0-9_]*) *$/.exec(text_span);\n    if (as_alias_match !== null) {\n        return {table_name: null, column_index: null, column_name: null, is_star: false, alias_name: as_alias_match[3]};\n    }\n    if (simple_var_match !== null) {\n        if (text_span == rbql_star_marker)\n            return {table_name: null, column_index: null, column_name: null, is_star: true, alias_name: null};\n        if (text_span.startsWith('___RBQL_STRING_LITERAL'))\n            return null;\n        let match = /^([ab])([0-9]+)$/.exec(text_span);\n        if (match !== null) {\n            return {table_name: match[1], column_index: parseInt(match[2]) - 1, column_name: null, is_star: false, alias_name: null};\n        }\n        // Some examples for this branch: NR, NF\n        return {table_name: null, column_index: null, column_name: text_span, is_star: false, alias_name: null};\n    } else if (attribute_match !== null) {\n        let table_name = attribute_match[1];\n        let column_name = attribute_match[2];\n        if (column_name == rbql_star_marker) {\n            return {table_name: table_name, column_index: null, column_name: null, is_star: true, alias_name: null};\n        }\n        return {table_name: null, column_index: null, column_name: column_name, is_star: false, alias_name: null};\n    } else if (subscript_int_match != null) {\n        let table_name = subscript_int_match[1];\n        let column_index = parseInt(subscript_int_match[2]) - 1;\n        return {table_name: table_name, column_index: column_index, column_name: null, is_star: false, alias_name: null};\n    } else if (subscript_str_match != null) {\n        let table_name = subscript_str_match[1];\n        let replaced_string_literal_id = subscript_str_match[2];\n        if (replaced_string_literal_id < string_literals.length) {\n            let quoted_column_name = string_literals[replaced_string_literal_id];\n            let unquoted_column_name = unquote_string(quoted_column_name);\n            if (unquoted_column_name !== null && unquoted_column_name !== undefined) {\n                return {table_name: null, column_index: null, column_name: unquoted_column_name, is_star: false, alias_name: null};\n            }\n        }\n    }\n    return null;\n}\n\n\nfunction adhoc_parse_select_expression_to_column_infos(select_expression, string_literals) {\n    // It is acceptable for the algorithm to provide null column name when it could be theorethically possible to deduce the name.\n    // I.e. this algorithm guarantees precision but doesn't guarantee completeness in all theorethically possible queries.\n    // Although the algorithm should be complete in all practical scenarios, i.e. it should be hard to come up with the query that doesn't produce complete set of column names.\n    // The null column name just means that the output column will be named as col{i}, so the failure to detect the proper column name can be tolerated.\n    // Specifically this function guarantees the following:\n    // 1. The number of column_infos is correct and will match the number of fields in each record in the output - otherwise the exception should be thrown\n    // 2. If column_info at pos j is not null, it is guaranteed to correctly represent that column name in the output\n    let text_spans = parse_root_bracket_level_text_spans(select_expression);\n    let column_infos = text_spans.map(ts => column_info_from_text_span(ts, string_literals));\n    return column_infos;\n}\n\n\nfunction stable_compare(a, b) {\n    for (var i = 0; i < a.length; i++) {\n        if (a[i] !== b[i])\n            return a[i] < b[i] ? -1 : 1;\n    }\n}\n\n\nfunction safe_get(record, idx) {\n    return idx < record.length ? record[idx] : null;\n}\n\n\nfunction safe_join_get(record, idx) {\n    if (idx < record.length) {\n        return record[idx];\n    }\n    throw new InternalBadFieldError(idx);\n}\n\n\nfunction safe_set(record, idx, value) {\n    if (idx < record.length) {\n        record[idx] = value;\n    } else {\n        throw new InternalBadFieldError(idx);\n    }\n}\n\n\nfunction regexp_escape(text) {\n    // From here: https://stackoverflow.com/a/6969486/2898283\n    return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');  // $& means the whole matched text\n}\n\n\nfunction like_to_regex(pattern) {\n    let p = 0;\n    let i = 0;\n    let converted = '';\n    while (i < pattern.length) {\n        if (pattern.charAt(i) == '_' || pattern.charAt(i) == '%') {\n            converted += regexp_escape(pattern.substring(p, i));\n            p = i + 1;\n            if (pattern.charAt(i) == '_') {\n                converted += '.';\n            } else {\n                converted += '.*';\n            }\n        }\n        i += 1;\n    }\n    converted += regexp_escape(pattern.substring(p, i));\n    return '^' + converted + '$';\n}\n\n\nfunction like(text, pattern) {\n    let matcher = query_context.like_regex_cache.get(pattern);\n    if (matcher === undefined) {\n        matcher = new RegExp(like_to_regex(pattern));\n        query_context.like_regex_cache.set(pattern, matcher);\n    }\n    return matcher.test(text);\n}\nconst LIKE = like;\n\n\nclass RBQLAggregationToken {\n    constructor(marker_id, value) {\n        this.marker_id = marker_id;\n        this.value = value;\n    }\n\n    toString() {\n        throw new RbqlParsingError(wrong_aggregation_usage_error);\n    }\n}\n\n\nclass UnnestMarker {}\n\n\nfunction UNNEST(vals) {\n    if (query_context.unnest_list !== null) {\n        // Technically we can support multiple UNNEST's but the implementation/algorithm is more complex and just doesn't worth it\n        throw new RbqlParsingError('Only one UNNEST is allowed per query');\n    }\n    query_context.unnest_list = vals;\n    return new UnnestMarker();\n}\nconst unnest = UNNEST;\nconst Unnest = UNNEST;\nconst UNFOLD = UNNEST; // \"UNFOLD\" is deprecated, just for backward compatibility\n\n\nfunction parse_number(val) {\n    // We can do a more pedantic number test like `/^ *-{0,1}[0-9]+\\.{0,1}[0-9]* *$/.test(val)`, but  user will probably use just Number(val) or parseInt/parseFloat\n    let result = Number(val);\n    if (isNaN(result)) {\n        throw new RbqlRuntimeError(`Unable to convert value \"${val}\" to a number. MIN, MAX, SUM, AVG, MEDIAN and VARIANCE aggregate functions convert their string arguments to numeric values`);\n    }\n    return result;\n}\n\n\nclass MinAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, val);\n        } else {\n            this.stats.set(key, Math.min(cur_aggr, val));\n        }\n    }\n\n    get_final(key) {\n        return this.stats.get(key);\n    }\n}\n\n\n\nclass MaxAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, val);\n        } else {\n            this.stats.set(key, Math.max(cur_aggr, val));\n        }\n    }\n\n    get_final(key) {\n        return this.stats.get(key);\n    }\n}\n\n\nclass SumAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, val);\n        } else {\n            this.stats.set(key, cur_aggr + val);\n        }\n    }\n\n    get_final(key) {\n        return this.stats.get(key);\n    }\n}\n\n\nclass AvgAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, [val, 1]);\n        } else {\n            var cur_sum = cur_aggr[0];\n            var cur_cnt = cur_aggr[1];\n            this.stats.set(key, [cur_sum + val, cur_cnt + 1]);\n        }\n    }\n\n    get_final(key) {\n        var cur_aggr = this.stats.get(key);\n        var cur_sum = cur_aggr[0];\n        var cur_cnt = cur_aggr[1];\n        var avg = cur_sum / cur_cnt;\n        return avg;\n    }\n}\n\n\nclass VarianceAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, [val, val * val, 1]);\n        } else {\n            var cur_sum = cur_aggr[0];\n            var cur_sum_sq = cur_aggr[1];\n            var cur_cnt = cur_aggr[2];\n            this.stats.set(key, [cur_sum + val, cur_sum_sq + val * val, cur_cnt + 1]);\n        }\n    }\n\n    get_final(key) {\n        var cur_aggr = this.stats.get(key);\n        var cur_sum = cur_aggr[0];\n        var cur_sum_sq = cur_aggr[1];\n        var cur_cnt = cur_aggr[2];\n        var avg_val = cur_sum / cur_cnt;\n        var variance = cur_sum_sq / cur_cnt - avg_val * avg_val;\n        return variance;\n    }\n}\n\n\nclass MedianAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, [val]);\n        } else {\n            cur_aggr.push(val);\n        }\n    }\n\n    get_final(key) {\n        var cur_aggr = this.stats.get(key);\n        cur_aggr.sort(function(a, b) { return a - b; });\n        var m = Math.floor(cur_aggr.length / 2);\n        if (cur_aggr.length % 2) {\n            return cur_aggr[m];\n        } else {\n            return (cur_aggr[m - 1] + cur_aggr[m]) / 2.0;\n        }\n    }\n}\n\n\nclass CountAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, 1);\n        } else {\n            this.stats.set(key, cur_aggr + 1);\n        }\n    }\n\n    get_final(key) {\n        return this.stats.get(key);\n    }\n}\n\n\nclass ArrayAggAggregator {\n    constructor(post_proc=null) {\n        this.post_proc = post_proc;\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        let cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, [val]);\n        } else {\n            cur_aggr.push(val);\n        }\n    }\n\n    get_final(key) {\n        let cur_aggr = this.stats.get(key);\n        if (this.post_proc === null)\n            return cur_aggr;\n        return this.post_proc(cur_aggr);\n    }\n}\n\n\nclass ConstGroupVerifier {\n    constructor(output_index) {\n        this.output_index = output_index;\n        this.const_values = new Map();\n    }\n\n    increment(key, value) {\n        var old_value = this.const_values.get(key);\n        if (old_value === undefined) {\n            this.const_values.set(key, value);\n        } else if (old_value != value) {\n            throw new RbqlRuntimeError(`Invalid aggregate expression: non-constant values in output column ${this.output_index + 1}. E.g. \"${old_value}\" and \"${value}\"`);\n        }\n    }\n\n    get_final(key) {\n        return this.const_values.get(key);\n    }\n}\n\n\nfunction init_aggregator(generator_name, val, post_proc=null) {\n    query_context.aggregation_stage = 1;\n    var res = new RBQLAggregationToken(query_context.functional_aggregators.length, val);\n    if (post_proc === null) {\n        query_context.functional_aggregators.push(new generator_name());\n    } else {\n        query_context.functional_aggregators.push(new generator_name(post_proc));\n    }\n    return res;\n}\n\n\nfunction MIN(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(MinAggregator, val) : val;\n}\nconst min = MIN;\nconst Min = MIN;\n\n\nfunction MAX(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(MaxAggregator, val) : val;\n}\nconst max = MAX;\nconst Max = MAX;\n\nfunction COUNT(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(CountAggregator, 1) : 1;\n}\nconst count = COUNT;\nconst Count = COUNT;\n\nfunction SUM(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(SumAggregator, val) : val;\n}\nconst sum = SUM;\nconst Sum = SUM;\n\nfunction AVG(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(AvgAggregator, val) : val;\n}\nconst avg = AVG;\nconst Avg = AVG;\n\nfunction VARIANCE(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(VarianceAggregator, val) : val;\n}\nconst variance = VARIANCE;\nconst Variance = VARIANCE;\n\nfunction MEDIAN(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(MedianAggregator, val) : val;\n}\nconst median = MEDIAN;\nconst Median = MEDIAN;\n\nfunction ARRAY_AGG(val, post_proc=null) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(ArrayAggAggregator, val, post_proc) : val;\n}\nconst array_agg = ARRAY_AGG;\nconst FOLD = ARRAY_AGG; // \"FOLD\" is deprecated, just for backward compatibility\n\n\nfunction add_to_set(dst_set, value) {\n    var len_before = dst_set.size;\n    dst_set.add(value);\n    return len_before != dst_set.size;\n}\n\n\nclass TopWriter {\n    constructor(subwriter, top_count) {\n        this.subwriter = subwriter;\n        this.NW = 0;\n        this.top_count = top_count;\n    }\n\n    async write(record) {\n        if (this.top_count !== null && this.NW >= this.top_count)\n            return false;\n        await this.subwriter.write(record);\n        this.NW += 1;\n        return true;\n    }\n\n    async finish() {\n        await this.subwriter.finish();\n    }\n}\n\n\nclass UniqWriter {\n    constructor(subwriter) {\n        this.subwriter = subwriter;\n        this.seen = new Set();\n    }\n\n    async write(record) {\n        if (!add_to_set(this.seen, JSON.stringify(record)))\n            return true;\n        if (!await this.subwriter.write(record))\n            return false;\n        return true;\n    }\n\n    async finish() {\n        await this.subwriter.finish();\n    }\n}\n\n\nclass UniqCountWriter {\n    constructor(subwriter) {\n        this.subwriter = subwriter;\n        this.records = new Map();\n    }\n\n    async write(record) {\n        var key = JSON.stringify(record);\n        var old_val = this.records.get(key);\n        if (old_val) {\n            old_val[0] += 1;\n        } else {\n            this.records.set(key, [1, record]);\n        }\n        return true;\n    }\n\n    async finish() {\n        for (var [key, value] of this.records) {\n            let [count, record] = value;\n            record.unshift(count);\n            if (!await this.subwriter.write(record))\n                break;\n        }\n        await this.subwriter.finish();\n    }\n}\n\n\nclass SortedWriter {\n    constructor(subwriter, reverse_sort) {\n        this.subwriter = subwriter;\n        this.reverse_sort = reverse_sort;\n        this.unsorted_entries = [];\n    }\n\n    async write(stable_entry) {\n        this.unsorted_entries.push(stable_entry);\n        return true;\n    }\n\n    async finish() {\n        var unsorted_entries = this.unsorted_entries;\n        unsorted_entries.sort(stable_compare);\n        if (this.reverse_sort)\n            unsorted_entries.reverse();\n        for (var i = 0; i < unsorted_entries.length; i++) {\n            var entry = unsorted_entries[i];\n            if (!await this.subwriter.write(entry[entry.length - 1]))\n                break;\n        }\n        await this.subwriter.finish();\n    }\n}\n\n\nclass AggregateWriter {\n    constructor(subwriter) {\n        this.subwriter = subwriter;\n        this.aggregators = [];\n        this.aggregation_keys = new Set();\n    }\n\n    async finish() {\n        var all_keys = Array.from(this.aggregation_keys);\n        all_keys.sort();\n        for (var i = 0; i < all_keys.length; i++) {\n            var key = all_keys[i];\n            var out_fields = [];\n            for (var ag of this.aggregators) {\n                out_fields.push(ag.get_final(key));\n            }\n            if (!await this.subwriter.write(out_fields))\n                break;\n        }\n        await this.subwriter.finish();\n    }\n}\n\n\nclass InnerJoiner {\n    constructor(join_map) {\n        this.join_map = join_map;\n    }\n\n    get_rhs(lhs_key) {\n        return this.join_map.get_join_records(lhs_key);\n    }\n}\n\n\nclass LeftJoiner {\n    constructor(join_map) {\n        this.join_map = join_map;\n        this.null_record = [[null, join_map.max_record_len, Array(join_map.max_record_len).fill(null)]];\n    }\n\n    get_rhs(lhs_key) {\n        let result = this.join_map.get_join_records(lhs_key);\n        if (result.length == 0) {\n            return this.null_record;\n        }\n        return result;\n    }\n}\n\n\nclass StrictLeftJoiner {\n    constructor(join_map) {\n        this.join_map = join_map;\n    }\n\n    get_rhs(lhs_key) {\n        let result = this.join_map.get_join_records(lhs_key);\n        if (result.length != 1) {\n            throw new RbqlRuntimeError('In \"STRICT LEFT JOIN\" each key in A must have exactly one match in B. Bad A key: \"' + lhs_key + '\"');\n        }\n        return result;\n    }\n}\n\n\nfunction select_except(src, except_fields) {\n    let result = [];\n    for (let i = 0; i < src.length; i++) {\n        if (except_fields.indexOf(i) == -1)\n            result.push(src[i]);\n    }\n    return result;\n}\n\n\nasync function select_simple(sort_key, NR, out_fields) {\n    if (query_context.sort_key_expression !== null) {\n        var sort_entry = sort_key.concat([NR, out_fields]);\n        if (!await query_context.writer.write(sort_entry))\n            return false;\n    } else {\n        if (!await query_context.writer.write(out_fields))\n            return false;\n    }\n    return true;\n}\n\n\nfunction select_aggregated(key, transparent_values) {\n    if (key !== null) {\n        key = JSON.stringify(key);\n    }\n    if (query_context.aggregation_stage === 1) {\n        if (!(query_context.writer instanceof TopWriter)) {\n            throw new RbqlParsingError('\"ORDER BY\", \"UPDATE\" and \"DISTINCT\" keywords are not allowed in aggregate queries');\n        }\n        query_context.writer = new AggregateWriter(query_context.writer);\n        let num_aggregators_found = 0;\n        for (var i = 0; i < transparent_values.length; i++) {\n            var trans_value = transparent_values[i];\n            if (trans_value instanceof RBQLAggregationToken) {\n                query_context.writer.aggregators.push(query_context.functional_aggregators[trans_value.marker_id]);\n                query_context.writer.aggregators[query_context.writer.aggregators.length - 1].increment(key, trans_value.value);\n                num_aggregators_found += 1;\n            } else {\n                query_context.writer.aggregators.push(new ConstGroupVerifier(query_context.writer.aggregators.length));\n                query_context.writer.aggregators[query_context.writer.aggregators.length - 1].increment(key, trans_value);\n            }\n        }\n        if (num_aggregators_found != query_context.functional_aggregators.length) {\n            throw new RbqlParsingError(wrong_aggregation_usage_error);\n        }\n        query_context.aggregation_stage = 2;\n    } else {\n        for (var i = 0; i < transparent_values.length; i++) {\n            var trans_value = transparent_values[i];\n            query_context.writer.aggregators[i].increment(key, trans_value);\n        }\n    }\n    query_context.writer.aggregation_keys.add(key);\n}\n\n\nasync function select_unnested(sort_key, NR, folded_fields) {\n    let out_fields = folded_fields.slice();\n    let unnest_pos = folded_fields.findIndex(val => val instanceof UnnestMarker);\n    for (var i = 0; i < query_context.unnest_list.length; i++) {\n        out_fields[unnest_pos] = query_context.unnest_list[i];\n        if (!await select_simple(sort_key, NR, out_fields.slice()))\n            return false;\n    }\n    return true;\n}\n\n\nconst PROCESS_SELECT_COMMON = `\n__RBQLMP__variables_init_code\nif (__RBQLMP__where_expression) {\n    let out_fields = __RBQLMP__select_expression;\n    if (query_context.aggregation_stage > 0) {\n        let key = __RBQLMP__aggregation_key_expression;\n        select_aggregated(key, out_fields);\n    } else {\n        let sort_key = [__RBQLMP__sort_key_expression];\n        if (query_context.unnest_list !== null) {\n            if (!await select_unnested(sort_key, NR, out_fields))\n                stop_flag = true;\n        } else {\n            if (!await select_simple(sort_key, NR, out_fields))\n                stop_flag = true;\n        }\n    }\n}\n`;\n\n\nconst PROCESS_SELECT_SIMPLE = `\nlet star_fields = record_a;\n__CODE__\n`;\n\n\nconst PROCESS_SELECT_JOIN = `\nlet join_matches = query_context.join_map.get_rhs(__RBQLMP__lhs_join_var_expression);\nfor (let join_match of join_matches) {\n    let [bNR, bNF, record_b] = join_match;\n    let star_fields = record_a.concat(record_b);\n    __CODE__\n    if (stop_flag)\n        break;\n}\n`;\n\n\nconst PROCESS_UPDATE_JOIN = `\nlet join_matches = query_context.join_map.get_rhs(__RBQLMP__lhs_join_var_expression);\nif (join_matches.length > 1)\n    throw new RbqlRuntimeError('More than one record in UPDATE query matched a key from the input table in the join table');\nlet record_b = null;\nlet bNR = null;\nlet bNF = null;\nif (join_matches.length == 1)\n    [bNR, bNF, record_b] = join_matches[0];\nlet up_fields = record_a;\n__RBQLMP__variables_init_code\nif (join_matches.length == 1 && (__RBQLMP__where_expression)) {\n    NU += 1;\n    __RBQLMP__update_expressions\n}\nif (!await query_context.writer.write(up_fields))\n    stop_flag = true;\n`;\n\n\nconst PROCESS_UPDATE_SIMPLE = `\nlet up_fields = record_a;\n__RBQLMP__variables_init_code\nif (__RBQLMP__where_expression) {\n    NU += 1;\n    __RBQLMP__update_expressions\n}\nif (!await query_context.writer.write(up_fields))\n    stop_flag = true;\n`;\n\n\nconst MAIN_LOOP_BODY = `\n__USER_INIT_CODE__\n\nlet NU = 0;\nlet NR = 0;\n\nlet stop_flag = false;\nwhile (!stop_flag) {\n    let record_a = await query_context.input_iterator.get_record();\n    if (record_a === null)\n        break;\n    NR += 1;\n    let NF = record_a.length;\n    query_context.unnest_list = null; // TODO optimize, don't need to set this every iteration\n    try {\n        __CODE__\n    } catch (e) {\n        if (e.constructor.name === 'InternalBadFieldError') {\n            throw new RbqlRuntimeError(\\`No \"a\\${e.bad_idx + 1}\" field at record \\${NR}\\`);\n        } else if (e.constructor.name === 'RbqlParsingError') {\n            throw(e);\n        } else {\n            throw new RbqlRuntimeError(\\`At record \\${NR}, Details: \\${e.message}\\`);\n        }\n    }\n}\n`;\n\n\nfunction embed_expression(parent_code, child_placeholder, child_expression) {\n    return replace_all(parent_code, child_placeholder, child_expression);\n}\n\n\nfunction embed_code(parent_code, child_placeholder, child_code) {\n    let parent_lines = parent_code.split('\\n');\n    let child_lines = child_code.split('\\n');\n    for (let i = 0; i < parent_lines.length; i++) {\n        let pos = parent_lines[i].indexOf(child_placeholder);\n        if (pos == -1)\n            continue;\n        assert(pos % 4 == 0);\n        let placeholder_indentation = parent_lines[i].substring(0, pos);\n        child_lines = child_lines.map(l => placeholder_indentation + l);\n        let result_lines = parent_lines.slice(0, i).concat(child_lines).concat(parent_lines.slice(i + 1));\n        return result_lines.join('\\n') + '\\n';\n    }\n    assert(false);\n}\n\n\nfunction generate_main_loop_code(query_context) {\n    let is_select_query = query_context.select_expression !== null;\n    let is_join_query = query_context.join_map !== null;\n    let where_expression = query_context.where_expression === null ? 'true' : query_context.where_expression;\n    let aggregation_key_expression = query_context.aggregation_key_expression === null ? 'null' : query_context.aggregation_key_expression;\n    let sort_key_expression = query_context.sort_key_expression === null ? 'null' : query_context.sort_key_expression;\n    let js_code = embed_code(MAIN_LOOP_BODY, '__USER_INIT_CODE__', query_context.user_init_code);\n    if (is_select_query) {\n        if (is_join_query) {\n            js_code = embed_code(embed_code(js_code, '__CODE__', PROCESS_SELECT_JOIN), '__CODE__', PROCESS_SELECT_COMMON);\n            js_code = embed_expression(js_code, '__RBQLMP__lhs_join_var_expression', query_context.lhs_join_var_expression);\n        } else {\n            js_code = embed_code(embed_code(js_code, '__CODE__', PROCESS_SELECT_SIMPLE), '__CODE__', PROCESS_SELECT_COMMON);\n        }\n        js_code = embed_code(js_code, '__RBQLMP__variables_init_code', query_context.variables_init_code);\n        js_code = embed_expression(js_code, '__RBQLMP__select_expression', query_context.select_expression);\n        js_code = embed_expression(js_code, '__RBQLMP__where_expression', where_expression);\n        js_code = embed_expression(js_code, '__RBQLMP__aggregation_key_expression', aggregation_key_expression);\n        js_code = embed_expression(js_code, '__RBQLMP__sort_key_expression', sort_key_expression);\n    } else {\n        if (is_join_query) {\n            js_code = embed_code(js_code, '__CODE__', PROCESS_UPDATE_JOIN);\n            js_code = embed_expression(js_code, '__RBQLMP__lhs_join_var_expression', query_context.lhs_join_var_expression);\n        } else {\n            js_code = embed_code(js_code, '__CODE__', PROCESS_UPDATE_SIMPLE);\n        }\n        js_code = embed_code(js_code, '__RBQLMP__variables_init_code', query_context.variables_init_code);\n        js_code = embed_code(js_code, '__RBQLMP__update_expressions', query_context.update_expressions);\n        js_code = embed_expression(js_code, '__RBQLMP__where_expression', where_expression);\n    }\n    return \"(async () => {\" + js_code + \"})()\";\n}\n\n\nasync function compile_and_run(query_context) {\n    let main_loop_body = generate_main_loop_code(query_context);\n    try {\n        let main_loop_promise = eval(main_loop_body);\n        await main_loop_promise;\n    } catch (e) {\n        if (e instanceof SyntaxError) {\n            // SyntaxError's from eval() function do not contain detailed explanation of what has caused the syntax error, so to guess what was wrong we can only use the original query\n            // v8 issue to fix eval: https://bugs.chromium.org/p/v8/issues/detail?id=2589\n            let lower_case_query = query_context.query_text.toLowerCase();\n            if (lower_case_query.indexOf(' having ') != -1)\n                throw new SyntaxError(e.message + \"\\nRBQL doesn't support \\\"HAVING\\\" keyword\");\n            if (lower_case_query.indexOf(' like ') != -1)\n                throw new SyntaxError(e.message + \"\\nRBQL doesn't support \\\"LIKE\\\" operator, use like() function instead e.g. ... WHERE like(a1, 'foo%bar') ... \"); // UT JSON\n            if (lower_case_query.indexOf(' from ') != -1)\n                throw new SyntaxError(e.message + \"\\nTip: If input table is defined by the environment, RBQL query should not have \\\"FROM\\\" keyword\"); // UT JSON\n            if (e && e.message && String(e.message).toLowerCase().indexOf('unexpected identifier') != -1) {\n                if (lower_case_query.indexOf(' and ') != -1)\n                    throw new SyntaxError(e.message + \"\\nDid you use 'and' keyword in your query?\\nJavaScript backend doesn't support 'and' keyword, use '&&' operator instead!\");\n                if (lower_case_query.indexOf(' or ') != -1)\n                    throw new SyntaxError(e.message + \"\\nDid you use 'or' keyword in your query?\\nJavaScript backend doesn't support 'or' keyword, use '||' operator instead!\");\n            }\n        }\n        if (e && e.message && e.message.indexOf('Received an instance of RBQLAggregationToken') != -1)\n            throw new RbqlParsingError(wrong_aggregation_usage_error);\n        throw e;\n    }\n}\n\n\nconst GROUP_BY = 'GROUP BY';\nconst UPDATE = 'UPDATE';\nconst SELECT = 'SELECT';\nconst JOIN = 'JOIN';\nconst INNER_JOIN = 'INNER JOIN';\nconst LEFT_JOIN = 'LEFT JOIN';\nconst LEFT_OUTER_JOIN = 'LEFT OUTER JOIN';\nconst STRICT_LEFT_JOIN = 'STRICT LEFT JOIN';\nconst ORDER_BY = 'ORDER BY';\nconst WHERE = 'WHERE';\nconst LIMIT = 'LIMIT';\nconst EXCEPT = 'EXCEPT';\nconst WITH = 'WITH';\n\n\nfunction get_ambiguous_error_msg(variable_name) {\n    return `Ambiguous variable name: \"${variable_name}\" is present both in input and in join tables`;\n}\n\n\nfunction get_all_matches(regexp, text) {\n    var result = [];\n    let match_obj = null;\n    while((match_obj = regexp.exec(text)) !== null) {\n        result.push(match_obj);\n    }\n    return result;\n}\n\n\nfunction str_strip(src) {\n    return src.replace(/^ +| +$/g, '');\n}\n\n\nfunction strip_comments(cline) {\n    cline = cline.trim();\n    if (cline.startsWith('//'))\n        return '';\n    return cline;\n}\n\n\nfunction combine_string_literals(backend_expression, string_literals) {\n    for (var i = 0; i < string_literals.length; i++) {\n        backend_expression = replace_all(backend_expression, `___RBQL_STRING_LITERAL${i}___`, string_literals[i]);\n    }\n    return backend_expression;\n}\n\n\nfunction parse_basic_variables(query_text, prefix, dst_variables_map) {\n    assert(prefix == 'a' || prefix == 'b');\n    let rgx = new RegExp(`(?:^|[^_a-zA-Z0-9])${prefix}([1-9][0-9]*)(?:$|(?=[^_a-zA-Z0-9]))`, 'g');\n    let matches = get_all_matches(rgx, query_text);\n    for (let i = 0; i < matches.length; i++) {\n        let field_num = parseInt(matches[i][1]);\n        dst_variables_map[prefix + String(field_num)] = {initialize: true, index: field_num - 1};\n    }\n}\n\n\nfunction parse_array_variables(query_text, prefix, dst_variables_map) {\n    assert(prefix == 'a' || prefix == 'b');\n    let rgx = new RegExp(`(?:^|[^_a-zA-Z0-9])${prefix}\\\\[([1-9][0-9]*)\\\\]`, 'g');\n    let matches = get_all_matches(rgx, query_text);\n    for (let i = 0; i < matches.length; i++) {\n        let field_num = parseInt(matches[i][1]);\n        dst_variables_map[`${prefix}[${field_num}]`] = {initialize: true, index: field_num - 1};\n    }\n}\n\n\nfunction js_string_escape_column_name(column_name, quote_char) {\n    column_name = column_name.replace(/\\\\/g, '\\\\\\\\');\n    column_name = column_name.replace(/\\n/g, '\\\\n');\n    column_name = column_name.replace(/\\r/g, '\\\\r');\n    column_name = column_name.replace(/\\t/g, '\\\\t');\n    if (quote_char === \"'\")\n        return column_name.replace(/'/g, \"\\\\'\");\n    if (quote_char === '\"')\n        return column_name.replace(/\"/g, '\\\\\"');\n    assert(quote_char === \"`\");\n    return column_name.replace(/`/g, \"\\\\`\");\n}\n\n\nfunction query_probably_has_dictionary_variable(query_text, column_name) {\n    let rgx = new RegExp('[-a-zA-Z0-9_:;+=!.,()%^#@&* ]+', 'g');\n    let continuous_name_segments = get_all_matches(rgx, column_name);\n    for (let continuous_segment of continuous_name_segments) {\n        if (query_text.indexOf(continuous_segment) == -1)\n            return false;\n    }\n    return true;\n}\n\n\nfunction parse_dictionary_variables(query_text, prefix, column_names, dst_variables_map) {\n    // The purpose of this algorithm is to minimize number of variables in varibale_map to improve performance, ideally it should be only variables from the query\n\n    // FIXME to prevent typos in attribute names either use query-based variable parsing which can properly handle back-tick strings or wrap \"a\" and \"b\" variables with ES6 Proxies https://stackoverflow.com/a/25658975/2898283\n    assert(prefix === 'a' || prefix === 'b');\n    let dict_test_rgx = new RegExp(`(?:^|[^_a-zA-Z0-9])${prefix}\\\\[`);\n    if (query_text.search(dict_test_rgx) == -1)\n        return;\n    for (let i = 0; i < column_names.length; i++) {\n        let column_name = column_names[i];\n        if (query_probably_has_dictionary_variable(query_text, column_name)) {\n            let escaped_column_name = js_string_escape_column_name(column_name, '\"');\n            dst_variables_map[`${prefix}[\"${escaped_column_name}\"]`] = {initialize: true, index: i};\n            escaped_column_name = js_string_escape_column_name(column_name, \"'\");\n            dst_variables_map[`${prefix}['${escaped_column_name}']`] = {initialize: false, index: i};\n            escaped_column_name = js_string_escape_column_name(column_name, \"`\");\n            dst_variables_map[`${prefix}[\\`${escaped_column_name}\\`]`] = {initialize: false, index: i};\n        }\n    }\n}\n\n\nfunction parse_attribute_variables(query_text, prefix, column_names, column_names_source, dst_variables_map) {\n    // The purpose of this algorithm is to minimize number of variables in varibale_map to improve performance, ideally it should be only variables from the query\n\n    assert(prefix === 'a' || prefix === 'b');\n    let rgx = new RegExp(`(?:^|[^_a-zA-Z0-9])${prefix}\\\\.([_a-zA-Z][_a-zA-Z0-9]*)`, 'g');\n    let matches = get_all_matches(rgx, query_text);\n    let column_names_from_query = matches.map(v => v[1]);\n    for (let column_name of column_names_from_query) {\n        let zero_based_idx = column_names.indexOf(column_name);\n        if (zero_based_idx != -1) {\n            dst_variables_map[`${prefix}.${column_name}`] = {initialize: true, index: zero_based_idx};\n        } else {\n            throw new RbqlParsingError(`Unable to find column \"${column_name}\" in ${prefix == 'a' ? 'input' : 'join'} ${column_names_source}`);\n        }\n    }\n}\n\n\nfunction map_variables_directly(query_text, column_names, dst_variables_map) {\n    for (let i = 0; i < column_names.length; i++) {\n        let column_name = column_names[i];\n        if ( /^[_a-zA-Z][_a-zA-Z0-9]*$/.exec(column_name) === null)\n            throw new RbqlIOHandlingError(`Unable to use column name \"${column_name}\" as RBQL/JS variable`);\n        if (query_text.indexOf(column_name) != -1)\n            dst_variables_map[column_name] = {initialize: true, index: i};\n    }\n}\n\n\nfunction ensure_no_ambiguous_variables(query_text, input_column_names, join_column_names) {\n    let join_column_names_set = new Set(join_column_names);\n    for (let column_name of input_column_names) {\n        if (join_column_names_set.has(column_name) && query_text.indexOf(column_name) != -1) // False positive is tolerable here\n            throw new RbqlParsingError(get_ambiguous_error_msg(column_name));\n    }\n}\n\n\nfunction parse_join_expression(src) {\n    src = str_strip(src);\n    const invalid_join_syntax_error = 'Invalid join syntax. Valid syntax: <JOIN> /path/to/B/table on a... == b... [and a... == b... [and ... ]]';\n    let rgx = /^ *([^ ]+) +on +/i;\n    let match = rgx.exec(src);\n    if (match === null)\n        throw new RbqlParsingError(invalid_join_syntax_error);\n    let table_id = match[1];\n    src = src.substr(match[0].length);\n\n    let variable_pairs = [];\n    var pair_rgx = /^([^ =]+) *==? *([^ =]+)/;\n    var and_rgx = /^ +(and|&&) +/i;\n    while (true) {\n        match = pair_rgx.exec(src);\n        if (match === null)\n            throw new RbqlParsingError(invalid_join_syntax_error);\n        variable_pairs.push([match[1], match[2]]);\n        src = src.substr(match[0].length);\n        if (!src.length)\n            break;\n        match = and_rgx.exec(src);\n        if (match === null)\n            throw new RbqlParsingError(invalid_join_syntax_error);\n        src = src.substr(match[0].length);\n    }\n    return [table_id, variable_pairs];\n}\n\n\nfunction resolve_join_variables(input_variables_map, join_variables_map, variable_pairs, string_literals) {\n    let lhs_variables = [];\n    let rhs_indices = [];\n    const valid_join_syntax_msg = 'Valid JOIN syntax: <JOIN> /path/to/B/table on a... == b... [and a... == b... [and ... ]]';\n    for (let variable_pair of variable_pairs) {\n        let [join_var_1, join_var_2] = variable_pair;\n        join_var_1 = combine_string_literals(join_var_1, string_literals);\n        join_var_2 = combine_string_literals(join_var_2, string_literals);\n        if (input_variables_map.hasOwnProperty(join_var_1) && join_variables_map.hasOwnProperty(join_var_1))\n            throw new RbqlParsingError(get_ambiguous_error_msg(join_var_1));\n        if (input_variables_map.hasOwnProperty(join_var_2) && join_variables_map.hasOwnProperty(join_var_2))\n            throw new RbqlParsingError(get_ambiguous_error_msg(join_var_2));\n        if (input_variables_map.hasOwnProperty(join_var_2))\n            [join_var_1, join_var_2] = [join_var_2, join_var_1];\n\n        let [lhs_key_index, rhs_key_index] = [null, null];\n        if (['NR', 'a.NR', 'aNR'].indexOf(join_var_1) != -1) {\n            lhs_key_index = -1;\n        } else if (input_variables_map.hasOwnProperty(join_var_1)) {\n            lhs_key_index = input_variables_map[join_var_1].index;\n        } else {\n            throw new RbqlParsingError(`Unable to parse JOIN expression: Input table does not have field \"${join_var_1}\"\\n${valid_join_syntax_msg}`);\n        }\n\n        if (['b.NR', 'bNR'].indexOf(join_var_2) != -1) {\n            rhs_key_index = -1;\n        } else if (join_variables_map.hasOwnProperty(join_var_2)) {\n            rhs_key_index = join_variables_map[join_var_2].index;\n        } else {\n            throw new RbqlParsingError(`Unable to parse JOIN expression: Join table does not have field \"${join_var_2}\"\\n${valid_join_syntax_msg}`);\n        }\n\n        let lhs_join_var_expression = lhs_key_index == -1 ? 'NR' : `safe_join_get(record_a, ${lhs_key_index})`;\n        rhs_indices.push(rhs_key_index);\n        lhs_variables.push(lhs_join_var_expression);\n    }\n    return [lhs_variables, rhs_indices];\n}\n\n\nfunction generate_common_init_code(query_text, variable_prefix) {\n    assert(variable_prefix == 'a' || variable_prefix == 'b');\n    let result = [];\n    result.push(`${variable_prefix} = new Object();`);\n    let base_var = variable_prefix == 'a' ? 'NR' : 'bNR';\n    let attr_var = `${variable_prefix}.NR`;\n    if (query_text.indexOf(attr_var) != -1)\n        result.push(`${attr_var} = ${base_var};`);\n    if (variable_prefix == 'a' && query_text.indexOf('aNR') != -1)\n        result.push('aNR = NR;');\n    return result;\n}\n\n\nfunction generate_init_statements(query_text, variables_map, join_variables_map, indent) {\n    let code_lines = generate_common_init_code(query_text, 'a');\n    let simple_var_name_rgx = /^[_0-9a-zA-Z]+$/;\n    for (const [variable_name, var_info] of Object.entries(variables_map)) {\n        if (var_info.initialize) {\n            let variable_declaration_keyword = simple_var_name_rgx.exec(variable_name) ? 'var ' : '';\n            code_lines.push(`${variable_declaration_keyword}${variable_name} = safe_get(record_a, ${var_info.index});`);\n        }\n    }\n    if (join_variables_map) {\n        code_lines = code_lines.concat(generate_common_init_code(query_text, 'b'));\n        for (const [variable_name, var_info] of Object.entries(join_variables_map)) {\n            if (var_info.initialize) {\n                let variable_declaration_keyword = simple_var_name_rgx.exec(variable_name) ? 'var ' : '';\n                code_lines.push(`${variable_declaration_keyword}${variable_name} = record_b === null ? null : safe_get(record_b, ${var_info.index});`);\n            }\n        }\n    }\n    for (let i = 1; i < code_lines.length; i++) {\n        code_lines[i] = indent + code_lines[i];\n    }\n    return code_lines.join('\\n');\n}\n\n\nfunction replace_star_count(aggregate_expression) {\n    var rgx = /(?:(?<=^)|(?<=,)) *COUNT\\( *\\* *\\)/ig;\n    var result = aggregate_expression.replace(rgx, ' COUNT(1)');\n    return str_strip(result);\n}\n\n\nfunction replace_star_vars(rbql_expression) {\n    let star_rgx = /(?:^|,) *(\\*|a\\.\\*|b\\.\\*) *(?=$|,)/g;\n    let matches = get_all_matches(star_rgx, rbql_expression);\n    let last_pos = 0;\n    let result = '';\n    for (let match of matches) {\n        let star_expression = match[1];\n        let replacement_expression = ']).concat(' + {'*': 'star_fields', 'a.*': 'record_a', 'b.*': 'record_b'}[star_expression] + ').concat([';\n        if (last_pos < match.index)\n            result += rbql_expression.substring(last_pos, match.index);\n        result += replacement_expression;\n        last_pos = match.index + match[0].length + 1; // Adding one to skip the lookahead comma\n    }\n    result += rbql_expression.substring(last_pos);\n    return result;\n}\n\n\nfunction replace_star_vars_for_header_parsing(rbql_expression) {\n    let star_rgx = /(?:(?<=^)|(?<=,)) *(\\*|a\\.\\*|b\\.\\*) *(?=$|,)/g;\n    let matches = get_all_matches(star_rgx, rbql_expression);\n    let last_pos = 0;\n    let result = '';\n    for (let match of matches) {\n        let star_expression = match[1];\n        let replacement_expression = {'*': '__RBQL_INTERNAL_STAR', 'a.*': 'a.__RBQL_INTERNAL_STAR', 'b.*': 'b.__RBQL_INTERNAL_STAR'}[star_expression];\n        if (last_pos < match.index)\n            result += rbql_expression.substring(last_pos, match.index);\n        result += replacement_expression;\n        last_pos = match.index + match[0].length;\n    }\n    result += rbql_expression.substring(last_pos);\n    return result;\n}\n\n\nfunction translate_update_expression(update_expression, input_variables_map, string_literals, indent) {\n    let first_assignment = str_strip(update_expression.split('=')[0]);\n    let first_assignment_error = `Unable to parse \"UPDATE\" expression: the expression must start with assignment, but \"${first_assignment}\" does not look like an assignable field name`;\n\n    let assignment_looking_rgx = /(?:^|,) *(a[.#a-zA-Z0-9\\[\\]_]*) *=(?=[^=])/g;\n    let update_expressions = [];\n    let pos = 0;\n    while (true) {\n        let match = assignment_looking_rgx.exec(update_expression);\n        if (update_expressions.length == 0 && (match === null || match.index != 0)) {\n            throw new RbqlParsingError(first_assignment_error);\n        }\n        if (match === null) {\n            update_expressions[update_expressions.length - 1] += str_strip(update_expression.substr(pos)) + ');';\n            break;\n        }\n        if (update_expressions.length)\n            update_expressions[update_expressions.length - 1] += str_strip(update_expression.substring(pos, match.index)) + ');';\n        let dst_var_name = combine_string_literals(str_strip(match[1]), string_literals);\n        if (!input_variables_map.hasOwnProperty(dst_var_name))\n            throw new RbqlParsingError(`Unable to parse \"UPDATE\" expression: Unknown field name: \"${dst_var_name}\"`);\n        let var_index = input_variables_map[dst_var_name].index;\n        let current_indent = update_expressions.length ? indent : '';\n        update_expressions.push(`${current_indent}safe_set(up_fields, ${var_index}, `);\n        pos = match.index + match[0].length;\n    }\n    return combine_string_literals(update_expressions.join('\\n'), string_literals);\n}\n\n\nfunction translate_select_expression(select_expression) {\n    let as_alias_replacement_regexp = / +(AS|as) +([a-zA-Z][a-zA-Z0-9_]*) *(?=$|,)/g;\n    let expression_without_counting_stars = replace_star_count(select_expression);\n    let expression_without_as_column_alias = expression_without_counting_stars.replace(as_alias_replacement_regexp, '');\n    let translated = str_strip(replace_star_vars(expression_without_as_column_alias));\n    let translated_for_header = str_strip(replace_star_vars_for_header_parsing(expression_without_counting_stars));\n    if (!translated.length)\n        throw new RbqlParsingError('\"SELECT\" expression is empty');\n    return [`[].concat([${translated}])`, translated_for_header];\n}\n\n\nfunction separate_string_literals(rbql_expression) {\n    // The regex consists of 3 almost identicall parts, the only difference is quote type\n    var rgx = /('(\\\\(\\\\\\\\)*'|[^'])*')|(\"(\\\\(\\\\\\\\)*\"|[^\"])*\")|(`(\\\\(\\\\\\\\)*`|[^`])*`)/g;\n    var match_obj = null;\n    var format_parts = [];\n    var string_literals = [];\n    var idx_before = 0;\n    while((match_obj = rgx.exec(rbql_expression)) !== null) {\n        var literal_id = string_literals.length;\n        var string_literal = match_obj[0];\n        string_literals.push(string_literal);\n        var start_index = match_obj.index;\n        format_parts.push(rbql_expression.substring(idx_before, start_index));\n        format_parts.push(`___RBQL_STRING_LITERAL${literal_id}___`);\n        idx_before = rgx.lastIndex;\n    }\n    format_parts.push(rbql_expression.substring(idx_before));\n    var format_expression = format_parts.join('');\n    format_expression = format_expression.replace(/\\t/g, ' ');\n    return [format_expression, string_literals];\n}\n\n\nfunction locate_statements(rbql_expression) {\n    let statement_groups = [];\n    statement_groups.push([STRICT_LEFT_JOIN, LEFT_OUTER_JOIN, LEFT_JOIN, INNER_JOIN, JOIN]);\n    statement_groups.push([SELECT]);\n    statement_groups.push([ORDER_BY]);\n    statement_groups.push([WHERE]);\n    statement_groups.push([UPDATE]);\n    statement_groups.push([GROUP_BY]);\n    statement_groups.push([LIMIT]);\n    statement_groups.push([EXCEPT]);\n    var result = [];\n    for (var ig = 0; ig < statement_groups.length; ig++) {\n        for (var is = 0; is < statement_groups[ig].length; is++) {\n            var statement = statement_groups[ig][is];\n            var rgxp = new RegExp('(?:^| )' + replace_all(statement, ' ', ' *') + '(?= )', 'ig');\n            var matches = get_all_matches(rgxp, rbql_expression);\n            if (!matches.length)\n                continue;\n            if (matches.length > 1)\n                throw new RbqlParsingError(`More than one \"${statement}\" statements found`);\n            assert(matches.length == 1);\n            var match = matches[0];\n            var match_str = match[0];\n            result.push([match.index, match.index + match_str.length, statement]);\n            break; // Break to avoid matching a sub-statement from the same group e.g. \"INNER JOIN\" -> \"JOIN\"\n        }\n    }\n    result.sort(function(a, b) { return a[0] - b[0]; });\n    return result;\n}\n\n\nfunction separate_actions(rbql_expression) {\n    rbql_expression = str_strip(rbql_expression);\n    var result = {};\n    let with_match = /^(.*)  *[Ww][Ii][Tt][Hh] *\\(([a-z]{4,20})\\) *$/.exec(rbql_expression);\n    if (with_match !== null) {\n        rbql_expression = with_match[1];\n        result[WITH] = with_match[2];\n    }\n    var ordered_statements = locate_statements(rbql_expression);\n    for (var i = 0; i < ordered_statements.length; i++) {\n        var statement_start = ordered_statements[i][0];\n        var span_start = ordered_statements[i][1];\n        var statement = ordered_statements[i][2];\n        var span_end = i + 1 < ordered_statements.length ? ordered_statements[i + 1][0] : rbql_expression.length;\n        assert(statement_start < span_start);\n        assert(span_start <= span_end);\n        var span = rbql_expression.substring(span_start, span_end);\n        var statement_params = {};\n        if ([STRICT_LEFT_JOIN, LEFT_OUTER_JOIN, LEFT_JOIN, INNER_JOIN, JOIN].indexOf(statement) != -1) {\n            statement_params['join_subtype'] = statement;\n            statement = JOIN;\n        }\n\n        if (statement == UPDATE) {\n            if (statement_start != 0)\n                throw new RbqlParsingError('UPDATE keyword must be at the beginning of the query');\n            span = span.replace(/^ *SET/i, '');\n        }\n\n        if (statement == ORDER_BY) {\n            span = span.replace(/ ASC *$/i, '');\n            var new_span = span.replace(/ DESC *$/i, '');\n            if (new_span != span) {\n                span = new_span;\n                statement_params['reverse'] = true;\n            } else {\n                statement_params['reverse'] = false;\n            }\n        }\n\n        if (statement == SELECT) {\n            if (statement_start != 0)\n                throw new RbqlParsingError('SELECT keyword must be at the beginning of the query');\n            let match = /^ *TOP *([0-9]+) /i.exec(span);\n            if (match !== null) {\n                statement_params['top'] = parseInt(match[1]);\n                span = span.substr(match.index + match[0].length);\n            }\n            match = /^ *DISTINCT *(COUNT)? /i.exec(span);\n            if (match !== null) {\n                statement_params['distinct'] = true;\n                if (match[1]) {\n                    statement_params['distinct_count'] = true;\n                }\n                span = span.substr(match.index + match[0].length);\n            }\n        }\n        statement_params['text'] = str_strip(span);\n        result[statement] = statement_params;\n    }\n    if (!result.hasOwnProperty(SELECT) && !result.hasOwnProperty(UPDATE)) {\n        throw new RbqlParsingError('Query must contain either SELECT or UPDATE statement');\n    }\n    assert(result.hasOwnProperty(SELECT) != result.hasOwnProperty(UPDATE));\n    return result;\n}\n\n\nfunction find_top(rb_actions) {\n    if (rb_actions.hasOwnProperty(LIMIT)) {\n        var rgx = /^[0-9]+$/;\n        if (rgx.exec(rb_actions[LIMIT]['text']) === null) {\n            throw new RbqlParsingError('LIMIT keyword must be followed by an integer');\n        }\n        var result = parseInt(rb_actions[LIMIT]['text']);\n        return result;\n    }\n    var select_action = rb_actions[SELECT];\n    if (select_action && select_action.hasOwnProperty('top')) {\n        return select_action['top'];\n    }\n    return null;\n}\n\n\nfunction translate_except_expression(except_expression, input_variables_map, string_literals, input_header) {\n    let skip_vars = except_expression.split(',');\n    skip_vars = skip_vars.map(str_strip);\n    let skip_indices = [];\n    for (let var_name of skip_vars) {\n        var_name = combine_string_literals(var_name, string_literals);\n        if (!input_variables_map.hasOwnProperty(var_name))\n            throw new RbqlParsingError(`Unknown field in EXCEPT expression: \"${var_name}\"`);\n        skip_indices.push(input_variables_map[var_name].index);\n    }\n    skip_indices = skip_indices.sort((a, b) => a - b);\n    let output_header = input_header === null ? null : select_except(input_header, skip_indices);\n    let indices_str = skip_indices.join(',');\n    return [output_header, `select_except(record_a, [${indices_str}])`];\n}\n\n\nclass HashJoinMap {\n    constructor(record_iterator, key_indices) {\n        this.max_record_len = 0;\n        this.hash_map = new Map();\n        this.record_iterator = record_iterator;\n        this.nr = 0;\n        if (key_indices.length == 1) {\n            this.key_index = key_indices[0];\n            this.key_indices = null;\n            this.polymorphic_get_key = this.get_single_key;\n        } else {\n            this.key_index = null;\n            this.key_indices = key_indices;\n            this.polymorphic_get_key = this.get_multi_key;\n        }\n    }\n\n    get_single_key(nr, fields) {\n        if (this.key_index >= fields.length)\n            throw new RbqlRuntimeError(`No field with index ${this.key_index + 1} at record ${this.nr} in \"B\" table`);\n        return this.key_index === -1 ? this.nr : fields[this.key_index];\n    };\n\n    get_multi_key(nr, fields) {\n        let result = [];\n        for (let ki of this.key_indices) {\n            if (ki >= fields.length)\n                throw new RbqlRuntimeError(`No field with index ${ki + 1} at record ${this.nr} in \"B\" table`);\n            result.push(ki === -1 ? this.nr : fields[ki]);\n        }\n        return JSON.stringify(result);\n    };\n\n    async build() {\n        while (true) {\n            let fields = await this.record_iterator.get_record();\n            if (fields === null)\n                break;\n            this.nr += 1;\n            let nf = fields.length;\n            this.max_record_len = Math.max(this.max_record_len, nf);\n            let key = this.polymorphic_get_key(this.nr, fields);\n            let key_records = this.hash_map.get(key);\n            if (key_records === undefined) {\n                this.hash_map.set(key, [[this.nr, nf, fields]]);\n            } else {\n                key_records.push([this.nr, nf, fields]);\n            }\n        }\n    };\n\n    get_join_records(key) {\n        let result = this.hash_map.get(key);\n        if (result === undefined)\n            return [];\n        return result;\n    };\n\n    get_warnings() {\n        return this.record_iterator.get_warnings();\n    };\n}\n\n\nfunction cleanup_query(query_text) {\n    return query_text.split('\\n').map(strip_comments).filter(line => line.length).join(' ').replace(/;+$/g, '');\n}\n\n\nfunction remove_redundant_table_name(query_text) {\n    query_text = str_strip(query_text.replace(/ +from +a(?: +|$)/gi, ' '));\n    query_text = str_strip(query_text.replace(/^ *update +a +set /gi, 'update '));\n    return query_text;\n}\n\n\nfunction select_output_header(input_header, join_header, query_column_infos) {\n    if (input_header === null) {\n        assert(join_header === null);\n    }\n    let query_has_star = false;\n    let query_has_column_alias = false;\n    for (let qci of query_column_infos) {\n        query_has_star = query_has_star || (qci !== null && qci.is_star);\n        query_has_column_alias = query_has_column_alias || (qci !== null && qci.alias_name !== null);\n    }\n    if (input_header === null) {\n        if (query_has_star && query_has_column_alias) {\n            throw new RbqlParsingError('Using both * (star) and AS alias in the same query is not allowed for input tables without header');\n        }\n        if (!query_has_column_alias) {\n            // Input table has no header and query has no aliases therefore the output table will be without header.\n            return null;\n        }\n        input_header = [];\n        join_header = [];\n    }\n    if (join_header === null) {\n        // This means there is no JOIN table.\n        join_header = [];\n    }\n    let output_header = [];\n    for (let qci of query_column_infos) {\n        // TODO refactor this and python version: extract this code into a function instead to always return something\n        if (qci === null) {\n            output_header.push('col' + (output_header.length + 1));\n        } else if (qci.is_star) {\n            if (qci.table_name === null) {\n                output_header = output_header.concat(input_header).concat(join_header);\n            } else if (qci.table_name === 'a') {\n                output_header = output_header.concat(input_header);\n            } else if (qci.table_name === 'b') {\n                output_header = output_header.concat(join_header);\n            }\n        } else if (qci.column_name !== null) {\n            output_header.push(qci.column_name);\n        } else if (qci.alias_name !== null) {\n            output_header.push(qci.alias_name);\n        } else if (qci.column_index !== null) {\n            if (qci.table_name == 'a' && qci.column_index < input_header.length) {\n                output_header.push(input_header[qci.column_index]);\n            } else if (qci.table_name == 'b' && qci.column_index < join_header.length) {\n                output_header.push(join_header[qci.column_index]);\n            } else {\n                output_header.push('col' + (output_header.length + 1));\n            }\n        } else { // Should never happen\n            output_header.push('col' + (output_header.length + 1));\n        }\n    }\n    return output_header;\n}\n\n\nfunction sample_first_two_inconsistent_records(inconsistent_records_info) {\n    let entries = Array.from(inconsistent_records_info.entries());\n    entries.sort(function(a, b) { return a[1] - b[1]; });\n    assert(entries.length > 1);\n    let [num_fields_1, record_num_1] = entries[0];\n    let [num_fields_2, record_num_2] = entries[1];\n    return [record_num_1, num_fields_1, record_num_2, num_fields_2];\n}\n\n\nfunction make_inconsistent_num_fields_warning(table_name, inconsistent_records_info) {\n    let [record_num_1, num_fields_1, record_num_2, num_fields_2] = sample_first_two_inconsistent_records(inconsistent_records_info);\n    let warn_msg = `Number of fields in \"${table_name}\" table is not consistent: `;\n    warn_msg += `e.g. record ${record_num_1} -> ${num_fields_1} fields, record ${record_num_2} -> ${num_fields_2} fields`;\n    return warn_msg;\n}\n\n\nclass RBQLInputIterator {\n    constructor(){}\n    stop() {\n        throw new Error(\"Unable to call the interface method\");\n    }\n    async get_variables_map(query_text) {\n        throw new Error(\"Unable to call the interface method\");\n    }\n    async get_record() {\n        throw new Error(\"Unable to call the interface method\");\n    }\n    handle_query_modifier() {\n        return; // Reimplement if you need to handle a boolean query modifier that can be used like this: `SELECT * WITH (modifiername)`\n    }\n    get_warnings() {\n        return []; // Reimplement if your class can produce warnings\n    }\n    async get_header() {\n        return null; // Reimplement if your class can provide input header\n    }\n}\n\n\nclass RBQLOutputWriter {\n    constructor(){}\n\n    async write(fields) {\n        throw new Error(\"Unable to call the interface method\");\n    }\n\n    async finish() {\n        // Reimplement if your class needs to do something on finish e.g. cleanup\n    };\n\n    get_warnings() {\n        return []; // Reimplement if your class can produce warnings\n    };\n\n    set_header() {\n        return; // Reimplement if your class can handle output headers in a meaningful way\n    }\n}\n\n\nclass RBQLTableRegistry {\n    constructor(){}\n\n    get_iterator_by_table_id(table_id) {\n        throw new Error(\"Unable to call the interface method\");\n    }\n\n    get_warnings() {\n        return []; // Reimplement if your class can produce warnings\n    };\n}\n\n\nclass TableIterator extends RBQLInputIterator {\n    constructor(table, column_names=null, normalize_column_names=true, variable_prefix='a') {\n        super();\n        this.table = table;\n        this.column_names = column_names;\n        this.normalize_column_names = normalize_column_names;\n        this.variable_prefix = variable_prefix;\n        this.nr = 0;\n        this.fields_info = new Map();\n        this.stopped = false;\n    }\n\n\n    stop() {\n        this.stopped = true;\n    };\n\n\n    async get_variables_map(query_text) {\n        let variable_map = new Object();\n        parse_basic_variables(query_text, this.variable_prefix, variable_map);\n        parse_array_variables(query_text, this.variable_prefix, variable_map);\n        if (this.column_names !== null) {\n            if (this.table.length && this.column_names.length != this.table[0].length)\n                throw new RbqlIOHandlingError('List of column names and table records have different lengths');\n            if (this.normalize_column_names) {\n                parse_dictionary_variables(query_text, this.variable_prefix, this.column_names, variable_map);\n                parse_attribute_variables(query_text, this.variable_prefix, this.column_names, 'column names list', variable_map);\n            } else {\n                map_variables_directly(query_text, this.column_names, variable_map);\n            }\n        }\n        return variable_map;\n    };\n\n\n    async get_record() {\n        if (this.stopped)\n            return null;\n        if (this.nr >= this.table.length)\n            return null;\n        let record = this.table[this.nr];\n        this.nr += 1;\n        let num_fields = record.length;\n        if (!this.fields_info.has(num_fields))\n            this.fields_info.set(num_fields, this.nr);\n        return record;\n    };\n\n    get_warnings() {\n        if (this.fields_info.size > 1)\n            return [make_inconsistent_num_fields_warning('input', this.fields_info)];\n        return [];\n    };\n\n    async get_header() {\n        return this.column_names;\n    }\n}\n\n\nclass TableWriter extends RBQLOutputWriter {\n    constructor(external_table) {\n        super();\n        this.table = external_table;\n        this.header = null;\n    }\n\n    async write(fields) {\n        this.table.push(fields);\n        return true;\n    };\n\n    set_header(header) {\n        this.header = header;\n    }\n}\n\n\nclass SingleTableRegistry extends RBQLTableRegistry {\n    constructor(table, column_names=null, normalize_column_names=true, table_id='b') {\n        super();\n        this.table = table;\n        this.table_id = table_id;\n        this.column_names = column_names;\n        this.normalize_column_names = normalize_column_names;\n    }\n\n    get_iterator_by_table_id(table_id) {\n        if (table_id.toLowerCase() !== this.table_id)\n            throw new RbqlIOHandlingError(`Unable to find join table: \"${table_id}\"`);\n        return new TableIterator(this.table, this.column_names, this.normalize_column_names, 'b');\n    };\n}\n\n\nasync function shallow_parse_input_query(query_text, input_iterator, join_tables_registry, query_context) {\n    query_text = cleanup_query(query_text);\n    var [format_expression, string_literals] = separate_string_literals(query_text);\n    format_expression = remove_redundant_table_name(format_expression);\n\n    var rb_actions = separate_actions(format_expression);\n    if (rb_actions.hasOwnProperty(WITH)) {\n        input_iterator.handle_query_modifier(rb_actions[WITH]);\n    }\n    var input_variables_map = await input_iterator.get_variables_map(query_text);\n\n    if (rb_actions.hasOwnProperty(ORDER_BY) && rb_actions.hasOwnProperty(UPDATE))\n        throw new RbqlParsingError('\"ORDER BY\" is not allowed in \"UPDATE\" queries');\n\n    if (rb_actions.hasOwnProperty(GROUP_BY)) {\n        if (rb_actions.hasOwnProperty(ORDER_BY) || rb_actions.hasOwnProperty(UPDATE))\n            throw new RbqlParsingError('\"ORDER BY\", \"UPDATE\" and \"DISTINCT\" keywords are not allowed in aggregate queries');\n        query_context.aggregation_key_expression = '[' + combine_string_literals(rb_actions[GROUP_BY]['text'], string_literals) + ']';\n    }\n\n\n    let input_header = await input_iterator.get_header();\n    let join_variables_map = null;\n    let join_header = null;\n    if (rb_actions.hasOwnProperty(JOIN)) {\n        var [rhs_table_id, variable_pairs] = parse_join_expression(rb_actions[JOIN]['text']);\n        if (join_tables_registry === null)\n            throw new RbqlParsingError('JOIN operations are not supported by the application');\n        let join_record_iterator = join_tables_registry.get_iterator_by_table_id(rhs_table_id);\n        if (!join_record_iterator)\n            throw new RbqlParsingError(`Unable to find join table: \"${rhs_table_id}\"`);\n        if (rb_actions.hasOwnProperty(WITH)) {\n            join_record_iterator.handle_query_modifier(rb_actions[WITH]);\n        }\n        join_variables_map = await join_record_iterator.get_variables_map(query_text);\n        join_header = await join_record_iterator.get_header();\n        if (input_header === null && join_header !== null) {\n            throw new RbqlIOHandlingError('Inconsistent modes: Input table doesn\\'t have a header while the Join table has a header');\n        }\n        if (input_header !== null && join_header === null) {\n            throw new RbqlIOHandlingError('Inconsistent modes: Input table has a header while the Join table doesn\\'t have a header');\n        }\n        let [lhs_variables, rhs_indices] = resolve_join_variables(input_variables_map, join_variables_map, variable_pairs, string_literals);\n        let sql_join_type = {'JOIN': InnerJoiner, 'INNER JOIN': InnerJoiner, 'LEFT JOIN': LeftJoiner, 'LEFT OUTER JOIN': LeftJoiner, 'STRICT LEFT JOIN': StrictLeftJoiner}[rb_actions[JOIN]['join_subtype']];\n        query_context.lhs_join_var_expression = lhs_variables.length == 1 ? lhs_variables[0] : 'JSON.stringify([' + lhs_variables.join(',') + '])';\n        query_context.join_map_impl = new HashJoinMap(join_record_iterator, rhs_indices);\n        await query_context.join_map_impl.build();\n        query_context.join_map = new sql_join_type(query_context.join_map_impl);\n    }\n\n    query_context.variables_init_code = combine_string_literals(generate_init_statements(format_expression, input_variables_map, join_variables_map, ' '.repeat(4)), string_literals);\n\n    if (rb_actions.hasOwnProperty(WHERE)) {\n        var where_expression = rb_actions[WHERE]['text'];\n        if (/[^><!=]=[^=]/.exec(where_expression))\n            throw new RbqlParsingError('Assignments \"=\" are not allowed in \"WHERE\" expressions. For equality test use \"==\" or \"===\"');\n        query_context.where_expression = combine_string_literals(where_expression, string_literals);\n    }\n\n    if (rb_actions.hasOwnProperty(UPDATE)) {\n        var update_expression = translate_update_expression(rb_actions[UPDATE]['text'], input_variables_map, string_literals, ' '.repeat(8));\n        query_context.update_expressions = combine_string_literals(update_expression, string_literals);\n        query_context.writer.set_header(input_header);\n    }\n\n    if (rb_actions.hasOwnProperty(SELECT)) {\n        query_context.top_count = find_top(rb_actions);\n        if (rb_actions.hasOwnProperty(EXCEPT)) {\n            if (rb_actions.hasOwnProperty(JOIN)) {\n                throw new RbqlParsingError('EXCEPT and JOIN are not allowed in the same query');\n            }\n            let [output_header, select_expression] = translate_except_expression(rb_actions[EXCEPT]['text'], input_variables_map, string_literals, input_header);\n            query_context.select_expression = select_expression;\n            query_context.writer.set_header(output_header);\n        } else {\n            let [select_expression, select_expression_for_header] = translate_select_expression(rb_actions[SELECT]['text']);\n            query_context.select_expression = combine_string_literals(select_expression, string_literals);\n            let column_infos = adhoc_parse_select_expression_to_column_infos(select_expression_for_header, string_literals);\n            let output_header = select_output_header(input_header, join_header, column_infos);\n            query_context.writer.set_header(output_header);\n        }\n\n        query_context.writer = new TopWriter(query_context.writer, query_context.top_count);\n        if (rb_actions[SELECT].hasOwnProperty('distinct_count')) {\n            query_context.writer = new UniqCountWriter(query_context.writer);\n        } else if (rb_actions[SELECT].hasOwnProperty('distinct')) {\n            query_context.writer = new UniqWriter(query_context.writer);\n        }\n    }\n\n    if (rb_actions.hasOwnProperty(ORDER_BY)) {\n        query_context.sort_key_expression = combine_string_literals(rb_actions[ORDER_BY]['text'], string_literals);\n        let reverse_sort = rb_actions[ORDER_BY]['reverse'];\n        query_context.writer = new SortedWriter(query_context.writer, reverse_sort);\n    }\n}\n\n\nasync function query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry=null, user_init_code='') {\n    query_context = new RBQLContext(query_text, input_iterator, output_writer, user_init_code);\n    await shallow_parse_input_query(query_text, input_iterator, join_tables_registry, query_context);\n    await compile_and_run(query_context);\n    await query_context.writer.finish();\n    output_warnings.push(...input_iterator.get_warnings());\n    if (query_context.join_map_impl)\n        output_warnings.push(...query_context.join_map_impl.get_warnings());\n    output_warnings.push(...output_writer.get_warnings());\n}\n\n\nasync function query_table(query_text, input_table, output_table, output_warnings, join_table=null, input_column_names=null, join_column_names=null, output_column_names=null, normalize_column_names=true, user_init_code='') {\n    if (!normalize_column_names && input_column_names !== null && join_column_names !== null)\n        ensure_no_ambiguous_variables(query_text, input_column_names, join_column_names);\n    let input_iterator = new TableIterator(input_table, input_column_names, normalize_column_names);\n    let output_writer = new TableWriter(output_table);\n    let join_tables_registry = join_table === null ? null : new SingleTableRegistry(join_table, join_column_names, normalize_column_names);\n    await query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry, user_init_code);\n    if (output_column_names !== null) {\n        assert(output_column_names.length == 0, '`output_column_names` param must be an empty list or null');\n        if (output_writer.header !== null) {\n            for (let column_name of output_writer.header) {\n                output_column_names.push(column_name);\n            }\n        }\n    }\n}\n\n\nfunction exception_to_error_info(e) {\n    let exceptions_type_map = {\n        'RbqlRuntimeError': 'query execution',\n        'RbqlParsingError': 'query parsing',\n        'SyntaxError': 'JS syntax error',\n        'RbqlIOHandlingError': 'IO handling'\n    };\n    let error_type = 'unexpected';\n    if (e.constructor && e.constructor.name && exceptions_type_map.hasOwnProperty(e.constructor.name)) {\n        error_type = exceptions_type_map[e.constructor.name];\n    }\n    let error_msg = e.hasOwnProperty('message') ? e.message : String(e);\n    return [error_type, error_msg];\n}\n\n\nexports.query = query;\nexports.query_table = query_table;\nexports.RBQLInputIterator = RBQLInputIterator;\nexports.RBQLOutputWriter = RBQLOutputWriter;\nexports.RBQLTableRegistry = RBQLTableRegistry;\n\nexports.version = RBQL_VERSION;\nexports.TableIterator = TableIterator;\nexports.TableWriter = TableWriter;\nexports.SingleTableRegistry = SingleTableRegistry;\nexports.exception_to_error_info = exception_to_error_info;\n\n\n// The functions below are exported just for unit tests, they are not part of the rbql API\n// TODO exports through the special unit_test proxy e.g. exports.unit_test.parse_basic_variables = parse_basic_variables;\nexports.parse_basic_variables = parse_basic_variables;\nexports.parse_array_variables = parse_array_variables;\nexports.parse_dictionary_variables = parse_dictionary_variables;\nexports.parse_attribute_variables = parse_attribute_variables;\nexports.get_all_matches = get_all_matches;\nexports.strip_comments = strip_comments;\nexports.separate_actions = separate_actions;\nexports.separate_string_literals = separate_string_literals;\nexports.combine_string_literals = combine_string_literals;\nexports.parse_join_expression = parse_join_expression;\nexports.resolve_join_variables = resolve_join_variables;\nexports.translate_update_expression = translate_update_expression;\nexports.translate_select_expression = translate_select_expression;\nexports.translate_except_expression = translate_except_expression;\nexports.like_to_regex = like_to_regex;\nexports.adhoc_parse_select_expression_to_column_infos = adhoc_parse_select_expression_to_column_infos;\nexports.replace_star_count = replace_star_count;\nexports.replace_star_vars_for_header_parsing = replace_star_vars_for_header_parsing;\nexports.select_output_header = select_output_header;\nexports.sample_first_two_inconsistent_records = sample_first_two_inconsistent_records;\n\n}(typeof exports === 'undefined' ? this.rbql = {} : exports));\n","const fs = require('fs');\nconst os = require('os');\nconst path = require('path');\nconst util = require('util');\n\nconst rbql = require('./rbql.js');\nconst csv_utils = require('./csv_utils.js');\n\n\nconst utf_decoding_error = 'Unable to decode input table as UTF-8. Use binary (latin-1) encoding instead';\n\n\nclass RbqlIOHandlingError extends Error {}\nclass AssertionError extends Error {}\n\n\n// TODO performance improvement: replace smart_split() with polymorphic_split()\n\n\nfunction assert(condition, message=null) {\n    if (!condition) {\n        if (!message) {\n            message = 'Assertion error';\n        }\n        throw new AssertionError(message);\n    }\n}\n\n\nfunction interpret_named_csv_format(format_name) {\n    format_name = format_name.toLowerCase();\n    if (format_name == 'monocolumn')\n        return ['', 'monocolumn'];\n    if (format_name == 'csv')\n        return [',', 'quoted'];\n    if (format_name == 'tsv')\n        return ['\\t', 'simple'];\n    throw new RbqlIOHandlingError(`Unknown format name: \"${format_name}\"`);\n}\n\n\n\nfunction is_ascii(str) {\n    return /^[\\x00-\\x7F]*$/.test(str);\n}\n\n\nfunction read_user_init_code(rbql_init_source_path) {\n    return fs.readFileSync(rbql_init_source_path, 'utf-8');\n}\n\n\nfunction remove_utf8_bom(line, assumed_source_encoding) {\n    if (assumed_source_encoding == 'binary' && line.length >= 3 && line.charCodeAt(0) === 0xEF && line.charCodeAt(1) === 0xBB && line.charCodeAt(2) === 0xBF) {\n        return line.substring(3);\n    }\n    if (assumed_source_encoding == 'utf-8' && line.length >= 1 && line.charCodeAt(0) === 0xFEFF) {\n        return line.substring(1);\n    }\n    return line;\n}\n\n\nfunction make_inconsistent_num_fields_warning(table_name, inconsistent_records_info) {\n    let [record_num_1, num_fields_1, record_num_2, num_fields_2] = rbql.sample_first_two_inconsistent_records(inconsistent_records_info);\n    let warn_msg = `Number of fields in \"${table_name}\" table is not consistent: `;\n    warn_msg += `e.g. record ${record_num_1} -> ${num_fields_1} fields, record ${record_num_2} -> ${num_fields_2} fields`;\n    return warn_msg;\n}\n\n\nfunction expanduser(filepath) {\n    if (filepath.charAt(0) === '~') {\n        return path.join(os.homedir(), filepath.slice(1));\n    }\n    return filepath;\n}\n\n\nfunction try_read_index(index_path) {\n    var content = null;\n    try {\n        content = fs.readFileSync(index_path, 'utf-8');\n    } catch (e) {\n        return [];\n    }\n    var lines = content.split('\\n');\n    var records = [];\n    for (var i = 0; i < lines.length; i++) {\n        if (!lines[i])\n            continue;\n        var record = lines[i].split('\\t');\n        records.push(record);\n    }\n    return records;\n}\n\n\nfunction get_index_record(index_path, key) {\n    var records = try_read_index(index_path);\n    for (var i = 0; i < records.length; i++) {\n        if (records[i].length && records[i][0] == key) {\n            return records[i];\n        }\n    }\n    return null;\n}\n\n\nfunction find_table_path(main_table_dir, table_id) {\n    // If table_id is a relative path it could be relative either to the current directory or to the main table dir.\n    var candidate_path = expanduser(table_id);\n    if (fs.existsSync(candidate_path)) {\n        return candidate_path;\n    }\n    if (main_table_dir && !path.isAbsolute(candidate_path)) {\n        candidate_path = path.join(main_table_dir, candidate_path);\n        if (fs.existsSync(candidate_path)) {\n            return candidate_path;\n        }\n    }\n    let table_names_settings_path = path.join(os.homedir(), '.rbql_table_names');\n    var name_record = get_index_record(table_names_settings_path, table_id);\n    if (name_record && name_record.length > 1 && fs.existsSync(name_record[1])) {\n        return name_record[1];\n    }\n    return null;\n}\n\n\nclass RecordQueue {\n    // TODO compare performance with a linked list\n    constructor() {\n        this.push_stack = [];\n        this.pull_stack = [];\n    }\n\n    enqueue(record) {\n        this.push_stack.push(record);\n    }\n\n    dequeue() {\n        if (!this.pull_stack.length) {\n            if (!this.push_stack.length)\n                return null;\n            this.pull_stack = this.push_stack;\n            this.pull_stack.reverse();\n            this.push_stack = [];\n        }\n        return this.pull_stack.pop();\n    }\n}\n\n\nclass CSVRecordIterator extends rbql.RBQLInputIterator {\n    // CSVRecordIterator implements a typical async producer-consumer model with an internal buffer:\n    // get_record() - consumer\n    // stream.on('data') - producer\n    constructor(stream, csv_path, encoding, delim, policy, has_header=false, comment_prefix=null, table_name='input', variable_prefix='a') {\n        super();\n        this.stream = stream;\n        this.csv_path = csv_path;\n        assert((this.stream === null) != (this.csv_path === null));\n        this.encoding = encoding;\n        this.delim = delim;\n        this.policy = policy;\n\n        this.has_header = has_header;\n        this.first_record = null;\n        this.first_record_should_be_emitted = !has_header;\n        this.header_preread_complete = false;\n\n        this.table_name = table_name;\n        this.variable_prefix = variable_prefix;\n        this.comment_prefix = comment_prefix;\n\n        this.decoder = null;\n        if (encoding == 'utf-8' && this.csv_path === null) {\n            // Unfortunately util.TextDecoder has serious flaws:\n            // 1. It doesn't work in Node without ICU: https://nodejs.org/api/util.html#util_new_textdecoder_encoding_options\n            // 2. It is broken in Electron: https://github.com/electron/electron/issues/18733\n\n            // Technically we can implement our own custom streaming text decoder, using the 3 following technologies:\n            // 1. decode-encode validation method from https://stackoverflow.com/a/32279283/2898283\n            // 2. Scanning buffer chunks for non-continuation utf-8 bytes from the end of the buffer:\n            //    src_buffer -> (buffer_before, buffer_after) where buffer_after is very small(a couple of bytes) and buffer_before is large and ends with a non-continuation bytes\n            // 3. Internal buffer to store small tail part from the previous buffer\n            this.decoder = new util.TextDecoder(encoding, {fatal: true, stream: true});\n        }\n\n        this.input_exhausted = false;\n        this.started = false;\n\n        this.utf8_bom_removed = false; // BOM doesn't get automatically removed by the decoder when utf-8 file is treated as latin-1\n        this.first_defective_line = null;\n\n        this.fields_info = new Map();\n        this.NR = 0; // Record number\n        this.NL = 0; // Line number (NL != NR when the CSV file has comments or multiline fields)\n\n        this.line_aggregator = new csv_utils.MultilineRecordAggregator(comment_prefix);\n\n        this.partially_decoded_line = '';\n        this.partially_decoded_line_ends_with_cr = false;\n\n        // Holds an external \"resolve\" function which is called when everything is fine.\n        this.resolve_current_record = null;\n        // Holds an external \"reject\" function which is called when error has occured.\n        this.reject_current_record = null;\n        // Holds last exception if we don't have any reject callbacks from clients yet.\n        this.current_exception = null;\n\n        this.produced_records_queue = new RecordQueue();\n\n        this.process_line_polymorphic = policy == 'quoted_rfc' ? this.process_partial_rfc_record_line : this.process_record_line_simple;\n    }\n\n\n    handle_query_modifier(modifier) {\n        // For `... WITH (header) ...` syntax\n        if (['header', 'headers'].indexOf(modifier) != -1) {\n            this.has_header = true;\n            this.first_record_should_be_emitted = false;\n        }\n        if (['noheader', 'noheaders'].indexOf(modifier) != -1) {\n            this.has_header = false;\n            this.first_record_should_be_emitted = true;\n        }\n    }\n\n\n    reset_external_callbacks() {\n        // Drop external callbacks simultaneously since promises can only resolve once, see: https://stackoverflow.com/a/18218542/2898283\n        this.reject_current_record = null;\n        this.resolve_current_record = null;\n    }\n\n    try_propagate_exception() {\n        if (this.current_exception && this.reject_current_record) {\n            let reject = this.reject_current_record;\n            let exception = this.current_exception;\n            this.reset_external_callbacks();\n            this.current_exception = null;\n            reject(exception);\n        }\n    }\n\n\n    store_or_propagate_exception(exception) {\n        if (this.current_exception === null)\n            // Ignore subsequent exceptions if we already have an unreported error. This way we prioritize earlier errors over the more recent ones.\n            this.current_exception = exception;\n        this.try_propagate_exception();\n    }\n\n\n    async preread_first_record() {\n        if (this.header_preread_complete)\n            return;\n        this.first_record = await this.get_record();\n        this.header_preread_complete = true; // We must set header_preread_complete to true after calling get_record(), because get_record() uses it internally.\n        if (this.first_record === null) {\n            return;\n        }\n        if (this.stream)\n            this.stream.pause();\n        this.first_record = this.first_record.slice();\n    };\n\n\n    async get_variables_map(query_text) {\n        let variable_map = new Object();\n        rbql.parse_basic_variables(query_text, this.variable_prefix, variable_map);\n        rbql.parse_array_variables(query_text, this.variable_prefix, variable_map);\n\n        await this.preread_first_record();\n        if (this.has_header && this.first_record) {\n            rbql.parse_attribute_variables(query_text, this.variable_prefix, this.first_record, 'CSV header line', variable_map);\n            rbql.parse_dictionary_variables(query_text, this.variable_prefix, this.first_record, variable_map);\n        }\n        return variable_map;\n    };\n\n    async get_header() {\n        await this.preread_first_record();\n        return this.has_header ? this.first_record : null;\n    }\n\n\n    try_resolve_next_record() {\n        this.try_propagate_exception();\n        if (this.resolve_current_record === null)\n            return;\n\n        let record = null;\n        if (this.first_record_should_be_emitted && this.header_preread_complete) {\n            this.first_record_should_be_emitted = false;\n            record = this.first_record;\n        } else {\n            record = this.produced_records_queue.dequeue();\n        }\n\n        if (record === null && !this.input_exhausted)\n            return;\n        let resolve = this.resolve_current_record;\n        this.reset_external_callbacks();\n        resolve(record);\n    };\n\n\n    async get_record() {\n        if (!this.started)\n            await this.start();\n        if (this.stream && this.stream.isPaused())\n            this.stream.resume();\n\n        let parent_iterator = this;\n        let current_record_promise = new Promise(function(resolve, reject) {\n            parent_iterator.resolve_current_record = resolve;\n            parent_iterator.reject_current_record = reject;\n        });\n        this.try_resolve_next_record();\n        return current_record_promise;\n    };\n\n\n    async get_all_records(num_records=null) {\n        let records = [];\n        while (true) {\n            let record = await this.get_record();\n            if (record === null)\n                break;\n            records.push(record);\n            if (num_records && records.length >= num_records) {\n                this.stop();\n                break;\n            }\n        }\n        return records;\n    };\n\n\n    process_record_line_simple(line) {\n        if (this.comment_prefix && line.startsWith(this.comment_prefix))\n            return; // Just skip the line\n        this.process_record_line(line);\n    }\n\n\n    process_record_line(line) {\n        this.NR += 1;\n        var [record, warning] = csv_utils.smart_split(line, this.delim, this.policy, false);\n        if (warning) {\n            if (this.first_defective_line === null) {\n                this.first_defective_line = this.NL;\n                if (this.policy == 'quoted_rfc')\n                    this.store_or_propagate_exception(new RbqlIOHandlingError(`Inconsistent double quote escaping in ${this.table_name} table at record ${this.NR}, line ${this.NL}`));\n            }\n        }\n        let num_fields = record.length;\n        if (!this.fields_info.has(num_fields))\n            this.fields_info.set(num_fields, this.NR);\n        this.produced_records_queue.enqueue(record);\n        this.try_resolve_next_record();\n    };\n\n\n    process_partial_rfc_record_line(line) {\n        this.line_aggregator.add_line(line);\n        if (this.line_aggregator.has_comment_line) {\n            this.line_aggregator.reset();\n        } else if (this.line_aggregator.has_full_record) {\n            this.process_record_line(this.line_aggregator.get_full_line('\\n'));\n            this.line_aggregator.reset();\n        }\n    };\n\n\n    process_line(line) {\n        this.NL += 1;\n        if (this.NL === 1) {\n            var clean_line = remove_utf8_bom(line, this.encoding);\n            if (clean_line != line) {\n                line = clean_line;\n                this.utf8_bom_removed = true;\n            }\n        }\n        this.process_line_polymorphic(line);\n    };\n\n\n    process_data_stream_chunk(data_chunk) {\n        let decoded_string = null;\n        if (this.decoder) {\n            try {\n                decoded_string = this.decoder.decode(data_chunk);\n            } catch (e) {\n                if (e instanceof TypeError) {\n                    this.store_or_propagate_exception(new RbqlIOHandlingError(utf_decoding_error));\n                } else {\n                    this.store_or_propagate_exception(e);\n                }\n                return;\n            }\n        } else {\n            decoded_string = data_chunk.toString(this.encoding);\n        }\n        let line_starts_with_lf = decoded_string.length && decoded_string[0] == '\\n';\n        let first_line_index = line_starts_with_lf && this.partially_decoded_line_ends_with_cr ? 1 : 0;\n        this.partially_decoded_line_ends_with_cr = decoded_string.length && decoded_string[decoded_string.length - 1] == '\\r';\n        let lines = csv_utils.split_lines(decoded_string);\n        lines[0] = this.partially_decoded_line + lines[0];\n        assert(first_line_index == 0 || lines[0].length == 0);\n        this.partially_decoded_line = lines.pop();\n        for (let i = first_line_index; i < lines.length; i++) {\n            this.process_line(lines[i]);\n        }\n    };\n\n\n    process_data_bulk(data_blob) {\n        let decoded_string = data_blob.toString(this.encoding);\n        if (this.encoding == 'utf-8') {\n            // Using hacky comparison method from here: https://stackoverflow.com/a/32279283/2898283\n            // TODO get rid of this once TextDecoder is really fixed or when alternative method of reliable decoding appears\n            let control_buffer = Buffer.from(decoded_string, 'utf-8');\n            if (Buffer.compare(data_blob, control_buffer) != 0) {\n                this.store_or_propagate_exception(new RbqlIOHandlingError(utf_decoding_error));\n                return;\n            }\n        }\n        let lines = csv_utils.split_lines(decoded_string);\n        if (lines.length && lines[lines.length - 1].length == 0)\n            lines.pop();\n        for (let i = 0; i < lines.length; i++) {\n            this.process_line(lines[i]);\n        }\n        if (this.line_aggregator.is_inside_multiline_record()) {\n            this.process_record_line(this.line_aggregator.get_full_line('\\n'));\n        }\n        this.input_exhausted = true;\n        this.try_resolve_next_record(); // Should be a NOOP here?\n    }\n\n\n    process_data_stream_end() {\n        this.input_exhausted = true;\n        if (this.partially_decoded_line.length) {\n            let last_line = this.partially_decoded_line;\n            this.partially_decoded_line = '';\n            this.process_line(last_line);\n        }\n        if (this.line_aggregator.is_inside_multiline_record()) {\n            this.process_record_line(this.line_aggregator.get_full_line('\\n'));\n        }\n        this.try_resolve_next_record();\n    };\n\n\n    stop() {\n        if (this.stream)\n            this.stream.destroy(); // TODO consider using pause() instead\n    };\n\n\n    async start() {\n        if (this.started)\n            return;\n        this.started = true;\n        if (this.stream) {\n            this.stream.on('data', (data_chunk) => { this.process_data_stream_chunk(data_chunk); });\n            this.stream.on('end', () => { this.process_data_stream_end(); });\n        } else {\n            let parent_iterator = this;\n            return new Promise(function(resolve, reject) {\n                fs.readFile(parent_iterator.csv_path, (err, data_blob) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        parent_iterator.process_data_bulk(data_blob);\n                        resolve();\n                    }\n                });\n            });\n        }\n    };\n\n\n    get_warnings() {\n        let result = [];\n        if (this.first_defective_line !== null)\n            result.push(`Inconsistent double quote escaping in ${this.table_name} table. E.g. at line ${this.first_defective_line}`);\n        if (this.utf8_bom_removed)\n            result.push(`UTF-8 Byte Order Mark (BOM) was found and skipped in ${this.table_name} table`);\n        if (this.fields_info.size > 1)\n            result.push(make_inconsistent_num_fields_warning(this.table_name, this.fields_info));\n        return result;\n    };\n}\n\n\nclass CSVWriter extends rbql.RBQLOutputWriter {\n    constructor(stream, close_stream_on_finish, encoding, delim, policy, line_separator='\\n') {\n        super();\n        this.stream = stream;\n        this.encoding = encoding;\n        if (encoding)\n            this.stream.setDefaultEncoding(encoding);\n        this.stream.on('error', (error_obj) => { this.store_first_error(error_obj); })\n        this.delim = delim;\n        this.policy = policy;\n        this.line_separator = line_separator;\n        this.sub_array_delim = delim == '|' ? ';' : '|';\n\n        this.close_stream_on_finish = close_stream_on_finish;\n\n        this.null_in_output = false;\n        this.delim_in_simple_output = false;\n        this.header_len = null;\n        this.first_error = null;\n\n        if (policy == 'simple') {\n            this.polymorphic_join = this.simple_join;\n        } else if (policy == 'quoted') {\n            this.polymorphic_join = this.quoted_join;\n        } else if (policy == 'quoted_rfc') {\n            this.polymorphic_join = this.quoted_join_rfc;\n        } else if (policy == 'monocolumn') {\n            this.polymorphic_join = this.mono_join;\n        } else if (policy == 'whitespace') {\n            this.polymorphic_join = this.simple_join;\n        } else {\n            throw new RbqlIOHandlingError('Unknown output csv policy');\n        }\n    }\n\n\n    store_first_error(error_obj) {\n        // Store only first error because it is typically more important than the subsequent ones.\n        if (this.first_error === null)\n            this.first_error = error_obj;\n    }\n\n    set_header(header) {\n        if (header !== null) {\n            this.header_len = header.length;\n            this.write(header);\n        }\n    }\n\n\n    quoted_join(fields) {\n        let delim = this.delim;\n        var quoted_fields = fields.map(function(v) { return csv_utils.quote_field(String(v), delim); });\n        return quoted_fields.join(this.delim);\n    };\n\n\n    quoted_join_rfc(fields) {\n        let delim = this.delim;\n        var quoted_fields = fields.map(function(v) { return csv_utils.rfc_quote_field(String(v), delim); });\n        return quoted_fields.join(this.delim);\n    };\n\n\n    mono_join(fields) {\n        if (fields.length > 1) {\n            throw new RbqlIOHandlingError('Unable to use \"Monocolumn\" output format: some records have more than one field');\n        }\n        return fields[0];\n    };\n\n\n    simple_join(fields) {\n        var res = fields.join(this.delim);\n        if (fields.join('').indexOf(this.delim) != -1) {\n            this.delim_in_simple_output = true;\n        }\n        return res;\n    };\n\n\n    normalize_fields(out_fields) {\n        for (var i = 0; i < out_fields.length; i++) {\n            if (out_fields[i] == null) {\n                this.null_in_output = true;\n                out_fields[i] = '';\n            } else if (Array.isArray(out_fields[i])) {\n                this.normalize_fields(out_fields[i]);\n                out_fields[i] = out_fields[i].join(this.sub_array_delim);\n            }\n        }\n    };\n\n\n    async write(fields) {\n        if (this.header_len !== null && fields.length != this.header_len)\n            throw new RbqlIOHandlingError(`Inconsistent number of columns in output header and the current record: ${this.header_len} != ${fields.length}`);\n        this.normalize_fields(fields);\n        this.stream.write(this.polymorphic_join(fields));\n        this.stream.write(this.line_separator);\n        let writer_error = this.first_error;\n        return new Promise(function(resolve, reject) {\n            if (writer_error !== null) {\n                reject(writer_error);\n            } else {\n                resolve(true);\n            }\n        });\n    };\n\n\n    _write_all(table) {\n        for (let i = 0; i < table.length; i++) {\n            this.write(table[i]);\n        }\n    };\n\n\n    async finish() {\n        let close_stream_on_finish = this.close_stream_on_finish;\n        let output_stream = this.stream;\n        let output_encoding = this.encoding;\n        let writer_error = this.first_error;\n        let finish_promise = new Promise(function(resolve, reject) {\n            if (writer_error !== null) {\n                reject(writer_error);\n            }\n            if (close_stream_on_finish) {\n                output_stream.end('', output_encoding, () => { resolve(); });\n            } else {\n                setTimeout(() => { resolve(); }, 0);\n            }\n        });\n        return finish_promise;\n    };\n\n\n    get_warnings() {\n        let result = [];\n        if (this.null_in_output)\n            result.push('null values in output were replaced by empty strings');\n        if (this.delim_in_simple_output)\n            result.push('Some output fields contain separator');\n        return result;\n    };\n\n}\n\n\nclass FileSystemCSVRegistry extends rbql.RBQLTableRegistry {\n    constructor(input_file_dir, delim, policy, encoding, has_header=false, comment_prefix=null, options=null) {\n        super();\n        this.input_file_dir = input_file_dir;\n        this.delim = delim;\n        this.policy = policy;\n        this.encoding = encoding;\n        this.has_header = has_header;\n        this.comment_prefix = comment_prefix;\n        this.stream = null;\n        this.record_iterator = null;\n\n        this.options = options;\n        this.bulk_input_path = null;\n        this.table_path = null;\n    }\n\n    get_iterator_by_table_id(table_id) {\n        this.table_path = find_table_path(this.input_file_dir, table_id);\n        if (this.table_path === null) {\n            throw new RbqlIOHandlingError(`Unable to find join table \"${table_id}\"`);\n        }\n        if (this.options && this.options['bulk_read']) {\n            this.bulk_input_path = this.table_path;\n        } else {\n            this.stream = fs.createReadStream(this.table_path);\n        }\n        this.record_iterator = new CSVRecordIterator(this.stream, this.bulk_input_path, this.encoding, this.delim, this.policy, this.has_header, this.comment_prefix, table_id, 'b');\n        return this.record_iterator;\n    };\n\n    get_warnings(output_warnings) {\n        if (this.record_iterator && this.has_header) {\n            output_warnings.push(`The first record in JOIN file ${path.basename(this.table_path)} was also treated as header (and skipped)`);\n        }\n    }\n}\n\n\nasync function query_csv(query_text, input_path, input_delim, input_policy, output_path, output_delim, output_policy, csv_encoding, output_warnings, with_headers=false, comment_prefix=null, user_init_code='', options=null) {\n    let input_stream = null;\n    let bulk_input_path = null;\n    if (options && options['bulk_read'] && input_path) {\n        bulk_input_path = input_path;\n    } else {\n        input_stream = input_path === null ? process.stdin : fs.createReadStream(input_path);\n    }\n    let [output_stream, close_output_on_finish] = output_path === null ? [process.stdout, false] : [fs.createWriteStream(output_path), true];\n    if (input_delim == '\"' && input_policy == 'quoted')\n        throw new RbqlIOHandlingError('Double quote delimiter is incompatible with \"quoted\" policy');\n    if (csv_encoding == 'latin-1')\n        csv_encoding = 'binary';\n    if (!is_ascii(query_text) && csv_encoding == 'binary')\n        throw new RbqlIOHandlingError('To use non-ascii characters in query enable UTF-8 encoding instead of latin-1/binary');\n    if ((!is_ascii(input_delim) || !is_ascii(output_delim)) && csv_encoding == 'binary')\n        throw new RbqlIOHandlingError('To use non-ascii characters in query enable UTF-8 encoding instead of latin-1/binary');\n\n    let default_init_source_path = path.join(os.homedir(), '.rbql_init_source.js');\n    if (user_init_code == '' && fs.existsSync(default_init_source_path)) {\n        user_init_code = read_user_init_code(default_init_source_path);\n    }\n    let input_file_dir = input_path ? path.dirname(input_path) : null;\n    let join_tables_registry = new FileSystemCSVRegistry(input_file_dir, input_delim, input_policy, csv_encoding, with_headers, comment_prefix, options);\n    let input_iterator = new CSVRecordIterator(input_stream, bulk_input_path, csv_encoding, input_delim, input_policy, with_headers, comment_prefix);\n    let output_writer = new CSVWriter(output_stream, close_output_on_finish, csv_encoding, output_delim, output_policy);\n\n    await rbql.query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry, user_init_code);\n    join_tables_registry.get_warnings(output_warnings);\n}\n\n\nmodule.exports.is_ascii = is_ascii;\nmodule.exports.CSVRecordIterator = CSVRecordIterator;\nmodule.exports.CSVWriter = CSVWriter;\nmodule.exports.FileSystemCSVRegistry = FileSystemCSVRegistry;\nmodule.exports.interpret_named_csv_format = interpret_named_csv_format;\nmodule.exports.read_user_init_code = read_user_init_code;\nmodule.exports.query_csv = query_csv;\nmodule.exports.RecordQueue = RecordQueue;\nmodule.exports.exception_to_error_info = rbql.exception_to_error_info;\n","module.exports = require(\"vscode\");","'use strict';\n\nvar possibleNames = [\n\t'BigInt64Array',\n\t'BigUint64Array',\n\t'Float32Array',\n\t'Float64Array',\n\t'Int16Array',\n\t'Int32Array',\n\t'Int8Array',\n\t'Uint16Array',\n\t'Uint32Array',\n\t'Uint8Array',\n\t'Uint8ClampedArray'\n];\n\nvar g = typeof globalThis === 'undefined' ? global : globalThis;\n\nmodule.exports = function availableTypedArrays() {\n\tvar out = [];\n\tfor (var i = 0; i < possibleNames.length; i++) {\n\t\tif (typeof g[possibleNames[i]] === 'function') {\n\t\t\tout[out.length] = possibleNames[i];\n\t\t}\n\t}\n\treturn out;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","const vscode = require('vscode');\n\nconst path = require('path');\nconst fs = require('fs');\nconst os = require('os');\nconst child_process = require('child_process');\n\nconst fast_load_utils = require('./fast_load_utils.js');\n\n// Please see DEV_README.md file for additional info.\n// FIXME add an updated README.md RBQL screenshot.\n\nconst csv_utils = require('./rbql_core/rbql-js/csv_utils.js');\n\nvar rbql_csv = null; // Using lazy load to improve startup performance.\nfunction ll_rbql_csv() {\n    if (rbql_csv === null)\n        rbql_csv = require('./rbql_core/rbql-js/rbql_csv.js');\n    return rbql_csv;\n}\n\n\nvar rainbow_utils = null; // Using lazy load to improve startup performance.\nfunction ll_rainbow_utils() {\n    if (rainbow_utils === null) {\n        rainbow_utils = require('./rainbow_utils.js');\n    }\n    return rainbow_utils;\n}\n\n\nconst is_web_ext = (os.homedir === undefined); // Runs as web extension in browser.\nconst preview_window_size = 100;\nconst scratch_buf_marker = 'vscode_rbql_scratch';\nconst dynamic_csv_highlight_margin = 50; // TODO make configurable\n\nlet client_html_template_web = null;\n\nvar aligned_files = new Set();\nvar result_set_parent_map = new Map();\nvar cached_table_parse_result = new Map(); // TODO store doc timestamp / size to invalidate the entry when the doc changes.\nvar manual_comment_prefix_stoplist = new Set();\n\nvar rbql_status_bar_button = null;\nvar align_shrink_button = null;\nvar rainbow_off_status_bar_button = null;\nvar copy_back_button = null;\nvar column_info_button = null;\nvar dynamic_dialect_select_button = null;\n\nvar rbql_context = null;\n\nvar last_rbql_queries = new Map(); // Query history does not replace this structure, it is also used to store partially entered queries for preview window switch.\n\nvar client_html_template = null;\n\nvar global_state = null;\n\nvar preview_panel = null;\n\nvar doc_first_edit_subscription = null;\nvar keyboard_cursor_subscription = null;\n\nvar _unit_test_last_rbql_report = null; // For unit tests only.\nvar _unit_test_last_warnings = null; // For unit tests only.\n\nlet cursor_timeout_handle = null;\n\nlet rainbow_token_event = null;\nlet comment_token_event = null;\nlet sticky_header_disposable = null;\n\nconst DYNAMIC_CSV = 'dynamic csv';\n\nconst QUOTED_POLICY = 'quoted';\nconst WHITESPACE_POLICY = 'whitespace';\nconst QUOTED_RFC_POLICY = 'quoted_rfc';\nconst SIMPLE_POLICY = 'simple';\n\n\nlet extension_context = {\n    lint_results: new Map(),\n    lint_status_bar_button: null,\n    dynamic_document_dialects: new Map(),\n    custom_comment_prefixes: new Map(),\n    original_language_ids: new Map(),\n    autodetection_stoplist: new Set(),\n    autodetection_temporarily_disabled_for_rbql: false,\n    dynamic_dialect_for_next_request: null,\n};\n\nconst dialect_map = {\n    'csv': [',', QUOTED_POLICY],\n    'tsv': ['\\t', SIMPLE_POLICY],\n    'csv (semicolon)': [';', QUOTED_POLICY],\n    'csv (pipe)': ['|', SIMPLE_POLICY],\n    'csv (whitespace)': [' ', WHITESPACE_POLICY],\n    [DYNAMIC_CSV]: [null, null]\n};\n\nconst tokenTypes = ['rainbow1', 'macro', 'function', 'comment', 'string', 'parameter', 'type', 'enumMember', 'keyword', 'regexp'];\nconst tokens_legend = new vscode.SemanticTokensLegend(tokenTypes);\n\n\nfunction safe_lower(src_str) {\n    if (!src_str)\n        return src_str;\n    return src_str.toLowerCase();\n}\n\n\nfunction get_default_policy(separator) {\n    // This function is most likely a temporal workaround, get rid of it when possible.\n    for (let language_id in dialect_map) {\n        if (!dialect_map.hasOwnProperty(language_id))\n            continue;\n        if (dialect_map[language_id][0] == separator)\n            return dialect_map[language_id][1];\n    }\n    return SIMPLE_POLICY;\n}\n\n\nfunction map_dialect_to_language_id(separator, policy) {\n    for (let language_id in dialect_map) {\n        if (!dialect_map.hasOwnProperty(language_id))\n            continue;\n        if (dialect_map[language_id][0] == separator && dialect_map[language_id][1] == policy)\n            return language_id;\n    }\n    return DYNAMIC_CSV;\n}\n\n\n// This structure will get properly initialized during the startup.\nlet absolute_path_map = {\n    'rbql_client.js': null,\n    'contrib/textarea-caret-position/index.js': null,\n    'rbql_suggest.js': null,\n    'rbql_logo.svg': null,\n    'rbql_client.html': null,\n    'rbql mock/rbql_mock.py': null,\n    'rbql_core/vscode_rbql.py': null\n};\n\n\nfunction show_single_line_error(error_msg) {\n    var active_window = vscode.window;\n    if (!active_window)\n        return;\n    // Do not \"await\" error messages because the promise gets resolved only on error dismissal.\n    active_window.showErrorMessage(error_msg);\n}\n\n\nfunction sleep(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n\n\nasync function push_current_stack_to_js_callback_queue_to_allow_ui_update() {\n    await sleep(0);\n}\n\n\nfunction get_from_global_state(key, default_value) {\n    if (global_state) {\n        var value = global_state.get(key);\n        if (value !== null && value !== undefined)\n            return value;\n    }\n    return default_value;\n}\n\n\nasync function save_to_global_state(key, value) {\n    if (global_state && key) {\n        await global_state.update(key, value);\n        return true;\n    }\n    return false;\n}\n\n\nasync function replace_doc_content(active_editor, active_doc, new_content) {\n    let invalid_range = new vscode.Range(0, 0, active_doc.lineCount /* Intentionally missing the '-1' */, 0);\n    let full_range = active_doc.validateRange(invalid_range);\n    await active_editor.edit(edit => edit.replace(full_range, new_content));\n}\n\n\nfunction make_header_key(file_path) {\n    return 'rbql_header:' + file_path;\n}\n\n\nfunction make_with_headers_key(file_path) {\n    return 'rbql_with_headers:' + file_path;\n}\n\n\nfunction get_from_config(param_name, default_value, config=null) {\n    if (!config) {\n        config = vscode.workspace.getConfiguration('rainbow_csv');\n    }\n    return config ? config.get(param_name) : default_value;\n}\n\n\nfunction get_header_from_document(document, delim, policy, comment_prefix) {\n    let [_header_lnum, header_line] = ll_rainbow_utils().get_header_line(document, comment_prefix);\n    if (!header_line) {\n        return null;\n    }\n    return csv_utils.smart_split(header_line, delim, policy, /*preserve_quotes_and_whitespaces=*/false)[0];\n}\n\n\nfunction get_header(document, delim, policy, comment_prefix) {\n    var file_path = document.fileName;\n    if (file_path && document.uri.scheme == 'file') {\n        let raw_header = get_from_global_state(make_header_key(file_path), null);\n        if (raw_header) {\n            return JSON.parse(raw_header);\n        }\n    }\n    return get_header_from_document(document, delim, policy, comment_prefix);\n}\n\n\nfunction get_dialect(document) {\n    let language_id = document.languageId;\n    let delim = null;\n    let policy = null;\n\n    let comment_prefix = '';\n    if (extension_context.custom_comment_prefixes.has(document.fileName)) {\n        comment_prefix = extension_context.custom_comment_prefixes.get(document.fileName);\n    } else {\n        comment_prefix = get_from_config('comment_prefix', '');\n    }\n    if (language_id != DYNAMIC_CSV && dialect_map.hasOwnProperty(language_id)) {\n        [delim, policy] = dialect_map[language_id];\n        return [delim, policy, comment_prefix];\n    }\n    // Here we don't check if language_id is DYNAMIC_CSV because we want to return the once selected dialect anyway even if file is now 'plaintext' or some other non-csv filetype.\n    if (extension_context.dynamic_document_dialects.has(document.fileName)) {\n        let dialect_info = extension_context.dynamic_document_dialects.get(document.fileName);\n        delim = dialect_info.delim;\n        policy = dialect_info.policy;\n        return [delim, policy, comment_prefix];\n    }\n    // The language id can be `dynamic csv` here e.g. if user just now manually selected the \"Dynamic CSV\" filetype.\n    return [null, null, null];\n}\n\n\nfunction show_status_bar_items(active_doc) {\n    if (dynamic_dialect_select_button) {\n        dynamic_dialect_select_button.hide();\n    }\n    ll_rainbow_utils().show_lint_status_bar_button(vscode, extension_context, active_doc.fileName, active_doc.languageId);\n    show_rbql_status_bar_button();\n    show_align_shrink_button(active_doc.fileName);\n    show_rainbow_off_status_bar_button();\n    show_rbql_copy_to_source_button(active_doc.fileName);\n    show_column_info_button(); // This function finds active_doc internally, but the possible inconsistency is harmless.\n}\n\n\nclass StickyHeaderProvider {\n    // We don't utilize typescript `implement` interface keyword, because TS doesn't seem to be exporting interfaces to JS (unlike classes).\n    constructor() {\n    }\n    async provideDocumentSymbols(document) {\n        // This can trigger multiple times for the same doc because otherwise this won't work in case of e.g. header edit.\n        let [_delim, policy, comment_prefix] = get_dialect(document);\n        if (!policy) {\n            return null;\n        }\n        let [header_lnum, _header_text] = ll_rainbow_utils().get_header_line(document, comment_prefix);\n        if (header_lnum === null || header_lnum >= document.lineCount - 1) {\n            return null;\n        }\n        let full_range = new vscode.Range(header_lnum, 0, document.lineCount - 1, 65535);\n        full_range = document.validateRange(full_range); // Just in case, should be always NOOP.\n        let header_range = new vscode.Range(header_lnum, 0, header_lnum, 65535);\n        if (!full_range.contains(header_range)) {\n            return; // Should never happen.\n        }\n        let symbol_kind = vscode.SymbolKind.File; // It is vscode.SymbolKind.File because it shows a nice \"File\" icon in the upper navigational panel. Another nice option is \"Class\".\n        let header_symbol = new vscode.DocumentSymbol('data', '', symbol_kind, full_range, header_range);\n        return [header_symbol];\n    }\n}\n\n\nfunction register_sticky_header_provider() {\n    if (sticky_header_disposable !== null) {\n        return;\n    }\n    // TODO consider enabling the provider unconditionally, consider checking all supported languages and not just csv.\n    let sticky_scroll_enabled = vscode.workspace.getConfiguration('editor.stickyScroll').get('enabled') === true || vscode.workspace.getConfiguration('editor.stickyScroll', {languageId : 'csv'}).get('enabled') === true;\n    if (!sticky_scroll_enabled) {\n        return; // Do not register symbol provider to avoid showing annoying entry in the upper navig bar and other possible side effects.\n    }\n\n    let header_symbol_provider = new StickyHeaderProvider();\n    let document_selector = [];\n    for (let language_id in dialect_map) {\n        if (dialect_map.hasOwnProperty(language_id)) {\n            document_selector.push({language: language_id});\n        }\n    }\n    sticky_header_disposable = vscode.languages.registerDocumentSymbolProvider(document_selector, header_symbol_provider);\n}\n\n\nfunction enable_dynamic_semantic_tokenization() {\n    let token_provider = new RainbowTokenProvider();\n    if (rainbow_token_event !== null) {\n        rainbow_token_event.dispose();\n    }\n    let document_selector = { language: DYNAMIC_CSV }; // Use '*' to select all languages if needed.\n    rainbow_token_event = vscode.languages.registerDocumentRangeSemanticTokensProvider(document_selector, token_provider, tokens_legend);\n}\n\n\nfunction register_comment_tokenization_handler() {\n    let token_provider = new CommentTokenProvider();\n    if (comment_token_event !== null) {\n        comment_token_event.dispose();\n    }\n    let document_selector = [];\n    for (let language_id in dialect_map) {\n        if (dialect_map.hasOwnProperty(language_id) && language_id != DYNAMIC_CSV) {\n            // We skip DYNAMIC_CSV here because its provider already handles comment lines.\n            document_selector.push({language: language_id});\n        }\n    }\n    comment_token_event = vscode.languages.registerDocumentRangeSemanticTokensProvider(document_selector, token_provider, tokens_legend);\n}\n\n\nasync function get_dialect_from_user_dialog() {\n    let title = \"Select separator character or string e.g. `,` or `:=`. For tab use `TAB`\";\n    let input_box_props = {\"prompt\": title, \"value\": ','};\n    let delim = await vscode.window.showInputBox(input_box_props);\n    if (!delim) {\n        return [null, null];\n    }\n    let policy = (delim == ',' || delim == ';') ? QUOTED_RFC_POLICY : SIMPLE_POLICY;\n    return [delim, policy];\n}\n\n\nasync function choose_dynamic_separator() {\n    let active_doc = get_active_doc();\n    if (active_doc.languageId != DYNAMIC_CSV) {\n        show_single_line_error('Dynamic separator can only be adjusted for \"Dynamic CSV\" filetype.');\n        return;\n    }\n    let [delim, policy] = await get_dialect_from_user_dialog();\n    if (!delim) {\n        show_single_line_error('Unable to use empty string separator');\n        return;\n    }\n    extension_context.dynamic_document_dialects.set(active_doc.fileName, {delim: delim, policy: policy});\n    await enable_rainbow_features_if_csv(active_doc);\n}\n\n\nfunction show_choose_dynamic_separator_button() {\n    if (!dynamic_dialect_select_button)\n        dynamic_dialect_select_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    dynamic_dialect_select_button.text = 'Choose Separator...';\n    dynamic_dialect_select_button.tooltip = 'Click to choose Dynamic CSV separator';\n    dynamic_dialect_select_button.command = 'rainbow-csv.ChooseDynamicSeparator';\n    dynamic_dialect_select_button.show();\n}\n\n\nasync function enable_rainbow_features_if_csv(active_doc) {\n    let file_path = active_doc ? active_doc.fileName : null;\n    if (!active_doc || !file_path || file_path.endsWith('.git')) {\n        // For new untitled scratch documents `file_path` would be \"Untitled-1\", \"Untitled-2\", etc, so we won't enter this branch.\n        // Sometimes for git-controlled dirs VSCode opens mysterious .git files - skip them.\n        return;\n    }\n    var language_id = active_doc.languageId;\n    if (!dialect_map.hasOwnProperty(language_id)) {\n        return;\n    }\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (!policy && extension_context.dynamic_dialect_for_next_request != null) {\n        [delim, policy] = extension_context.dynamic_dialect_for_next_request;\n        extension_context.dynamic_document_dialects.set(file_path, {delim: delim, policy: policy});\n        extension_context.dynamic_dialect_for_next_request = null;\n        [delim, policy, comment_prefix] = get_dialect(active_doc);\n    }\n    if (!policy) {\n        if (language_id == DYNAMIC_CSV) {\n            [delim, policy] = await get_dialect_from_user_dialog();\n            if (!policy) {\n                // Last attempt: retry getting dialect, because it can be set asynchronously: after opening the (which would trigger enable_rainbow_features_if_csv in the end) the caller could update dynamic_document_dialects for example this happens in RBQL queries handling.\n                [delim, policy, comment_prefix] = get_dialect(active_doc);\n            }\n            if (!policy) {\n                hide_buttons(); // Hide buttons when switching \"csv\" -> \"dynamic csv\".\n                show_choose_dynamic_separator_button();\n                return;\n            }\n            extension_context.dynamic_document_dialects.set(file_path, {delim: delim, policy: policy});\n        } else {\n            return;\n        }\n    }\n    if (!delim) {\n        return; // Adding this condition JIC, this should never happen at this point - we would return earlier if there were no policy (hence no delim).\n    }\n    if (get_from_config('enable_cursor_position_info', false)) {\n        keyboard_cursor_subscription = vscode.window.onDidChangeTextEditorSelection(handle_cursor_movement);\n    }\n    if (comment_prefix) {\n        // It is currently impoossible to set comment_prefix on document level, so we have to set it on language level instead.\n        // This could potentially cause minor problems in very rare situations.\n        // Applying 'setLanguageConfiguration' doesn't disable static configuration in language-configuration.json.\n        vscode.languages.setLanguageConfiguration(language_id, { comments: { lineComment: comment_prefix } });\n    }\n\n    if (language_id == DYNAMIC_CSV) {\n        // Re-enable tokenization to explicitly trigger the highligthing. Sometimes this doesn't happen automatically.\n        enable_dynamic_semantic_tokenization();\n    }\n    register_sticky_header_provider();\n    show_status_bar_items(active_doc);\n    await csv_lint(active_doc, false);\n}\n\n\nfunction hide_buttons() {\n    let all_buttons = [extension_context.lint_status_bar_button, rbql_status_bar_button, rainbow_off_status_bar_button, copy_back_button, align_shrink_button, column_info_button, dynamic_dialect_select_button];\n    for (let i = 0; i < all_buttons.length; i++) {\n        if (all_buttons[i])\n            all_buttons[i].hide();\n    }\n}\n\n\nfunction disable_rainbow_features_if_non_csv(active_doc) {\n    let file_path = active_doc ? active_doc.fileName : null;\n    if (!active_doc) {\n        // This can happen when openning settings tab for example.\n        hide_buttons();\n        return;\n    }\n    if (file_path && file_path.endsWith('.git')) {\n        // Sometimes for git-controlled dirs VSCode opens mysterious .git files which are not even present - skip them, don't disable features.\n        return;\n    }\n    var language_id = active_doc.languageId;\n    if (dialect_map.hasOwnProperty(language_id))\n        return;\n    hide_buttons();\n    if (keyboard_cursor_subscription) {\n        keyboard_cursor_subscription.dispose();\n        keyboard_cursor_subscription = null;\n    }\n}\n\n\nfunction get_active_editor() {\n    var active_window = vscode.window;\n    if (!active_window)\n        return null;\n    var active_editor = active_window.activeTextEditor;\n    if (!active_editor)\n        return null;\n    return active_editor;\n}\n\n\nfunction get_active_doc(active_editor=null) {\n    if (!active_editor)\n        active_editor = get_active_editor();\n    if (!active_editor)\n        return null;\n    var active_doc = active_editor.document;\n    if (!active_doc)\n        return null;\n    return active_doc;\n}\n\n\nfunction show_align_shrink_button(file_path) {\n    if (!align_shrink_button)\n        align_shrink_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    if (aligned_files.has(file_path)) {\n        align_shrink_button.text = 'Shrink';\n        align_shrink_button.tooltip = 'Click to shrink table (Then you can click again to align)';\n        align_shrink_button.command = 'rainbow-csv.Shrink';\n    } else {\n        align_shrink_button.text = 'Align';\n        align_shrink_button.tooltip = 'Click to align table (Then you can click again to shrink)';\n        align_shrink_button.command = 'rainbow-csv.Align';\n    }\n    align_shrink_button.show();\n}\n\n\nfunction do_show_column_info_button(full_report, short_report) {\n    if (!column_info_button)\n        column_info_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Right, 1000);\n    column_info_button.text = short_report;\n    column_info_button.tooltip = full_report;\n    column_info_button.show();\n}\n\n\nfunction make_hover(document, language_id, position, cancellation_token) {\n    if (!get_from_config('enable_tooltip', false)) {\n        return;\n    }\n    let [delim, policy, comment_prefix] = get_dialect(document);\n    let cursor_position_info = ll_rainbow_utils().get_cursor_position_info(vscode, document, delim, policy, comment_prefix, position);\n    if (!cursor_position_info || cancellation_token.isCancellationRequested)\n        return null;\n    let enable_tooltip_column_names = get_from_config('enable_tooltip_column_names', false);\n    let header = get_header(document, delim, policy, comment_prefix);\n    if (!header) {\n        return null;\n    }\n    let [_full_text, short_report] = ll_rainbow_utils().format_cursor_position_info(cursor_position_info, header, enable_tooltip_column_names, /*show_comments=*/true, /*max_label_length=*/25);\n    let mds = null;\n    if (language_id == DYNAMIC_CSV) {\n        mds = short_report; // Do not colorize hover text because dynamic csv provides inconsistent colors for some of the tokens.\n    } else {\n        // TODO The syntax highlighting doesn't always work here, perhaps due to https://github.com/microsoft/vscode/issues/53723. Consider getting rid of it altogether.\n        mds = new vscode.MarkdownString();\n        mds.appendCodeblock(short_report, 'rainbow hover markup');\n    }\n    return new vscode.Hover(mds);\n}\n\n\nfunction show_column_info_button() {\n    let active_editor = get_active_editor();\n    if (!active_editor) {\n        return false;\n    }\n    let position = ll_rainbow_utils().get_cursor_position_if_unambiguous(active_editor);\n    if (!position) {\n        return false;\n    }\n    let active_doc = get_active_doc(active_editor);\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    let cursor_position_info = ll_rainbow_utils().get_cursor_position_info(vscode, active_doc, delim, policy, comment_prefix, position);\n    if (!cursor_position_info)\n        return false;\n    let enable_tooltip_column_names = get_from_config('enable_tooltip_column_names', false);\n    let header = get_header(active_doc, delim, policy, comment_prefix);\n    if (!header)\n        return false;\n    let [full_report, short_report] = ll_rainbow_utils().format_cursor_position_info(cursor_position_info, header, enable_tooltip_column_names, /*show_comments=*/false, /*max_label_length=*/25);\n    do_show_column_info_button(full_report, short_report);\n    return true;\n}\n\n\nfunction show_rainbow_off_status_bar_button() {\n    if (!rainbow_off_status_bar_button)\n        rainbow_off_status_bar_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    rainbow_off_status_bar_button.text = 'Rainbow OFF';\n    rainbow_off_status_bar_button.tooltip = 'Click to restore original file type and syntax';\n    rainbow_off_status_bar_button.command = 'rainbow-csv.RainbowSeparatorOff';\n    rainbow_off_status_bar_button.show();\n}\n\n\nfunction show_rbql_status_bar_button() {\n    if (!rbql_status_bar_button)\n        rbql_status_bar_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    rbql_status_bar_button.text = 'Query';\n    rbql_status_bar_button.tooltip = 'Click to run SQL-like RBQL query';\n    rbql_status_bar_button.command = 'rainbow-csv.RBQL';\n    rbql_status_bar_button.show();\n}\n\n\nfunction show_rbql_copy_to_source_button(file_path) {\n    let parent_table_path = result_set_parent_map.get(safe_lower(file_path));\n    if (!parent_table_path || parent_table_path.indexOf(scratch_buf_marker) != -1)\n        return;\n    let parent_basename = path.basename(parent_table_path);\n    if (!copy_back_button)\n        copy_back_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    copy_back_button.text = 'Copy Back';\n    copy_back_button.tooltip = `Copy to parent table: ${parent_basename}`;\n    copy_back_button.command = 'rainbow-csv.CopyBack';\n    copy_back_button.show();\n}\n\n\nasync function csv_lint(active_doc, is_manual_op) {\n    if (!active_doc)\n        active_doc = get_active_doc();\n    if (!active_doc)\n        return null;\n    var file_path = active_doc.fileName; // For new untitled scratch documents this would be \"Untitled-1\", \"Untitled-2\", etc...\n    if (!file_path)\n        return null;\n    var language_id = active_doc.languageId;\n    if (!dialect_map.hasOwnProperty(language_id))\n        return null;\n    let lint_cache_key = `${file_path}.${language_id}`;\n    if (!is_manual_op) {\n        if (extension_context.lint_results.has(lint_cache_key))\n            return null;\n        if (!get_from_config('enable_auto_csv_lint', false))\n            return null;\n    }\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null)\n        return null;\n    extension_context.lint_results.set(lint_cache_key, {is_processing: true});\n    ll_rainbow_utils().show_lint_status_bar_button(vscode, extension_context, file_path, language_id); // Visual feedback.\n    let detect_trailing_spaces = get_from_config('csv_lint_detect_trailing_spaces', false);\n    let [_records, _num_records_parsed, fields_info, first_defective_line, first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(active_doc, delim, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/false, /*preserve_quotes_and_whitespaces=*/true, detect_trailing_spaces);\n    let is_ok = (first_defective_line === null && fields_info.size <= 1);\n    let lint_result = {'is_ok': is_ok, 'first_defective_line': first_defective_line, 'fields_info': fields_info, 'first_trailing_space_line': first_trailing_space_line};\n    extension_context.lint_results.set(lint_cache_key, lint_result);\n    if (is_manual_op) {\n        // Need timeout here to give user enough time to notice green -> yellow -> green switch, this is a sort of visual feedback.\n        await sleep(500);\n    }\n    ll_rainbow_utils().show_lint_status_bar_button(vscode, extension_context, file_path, language_id); // Visual feedback.\n    return lint_result;\n}\n\n\nasync function csv_lint_cmd() {\n    // TODO re-run on each file save with content change.\n    let lint_report_for_unit_tests = await csv_lint(null, true);\n    return lint_report_for_unit_tests;\n}\n\n\nasync function run_internal_test_cmd(integration_test_options) {\n    if (integration_test_options && integration_test_options.check_initialization_state) {\n        // This mode is to ensure that the most basic operations do not cause rainbow csv to load extra (potentially heavy) code.\n        // Vim uses the same approach with its plugin/autoload folder layout design.\n        return {initialized: global_state !== null, lazy_loaded: rainbow_utils !== null};\n    }\n    if (integration_test_options && integration_test_options.check_last_rbql_report) {\n        return _unit_test_last_rbql_report;\n    }\n    if (integration_test_options && integration_test_options.check_last_rbql_warnings) {\n        return {'warnings': _unit_test_last_warnings};\n    }\n    return null;\n}\n\n\nasync function show_warnings(warnings) {\n    _unit_test_last_warnings = [];\n    if (!warnings || !warnings.length)\n        return;\n    var active_window = vscode.window;\n    if (!active_window)\n        return null;\n    for (var i = 0; i < warnings.length; i++) {\n        // Do not \"await\" warning messages because the promise gets resolved only on warning dismissal.\n        active_window.showWarningMessage('RBQL warning: ' + warnings[i]);\n    }\n    _unit_test_last_warnings = warnings;\n}\n\n\nasync function handle_rbql_result_file_node(text_doc, delim, policy, warnings) {\n    try {\n        await vscode.window.showTextDocument(text_doc);\n    } catch (error) {\n        show_single_line_error('Unable to open RBQL result document');\n        return;\n    }\n    let language_id = map_dialect_to_language_id(delim, policy);\n    if (language_id && text_doc.languageId != language_id) {\n        // In non-web version we open a new doc without preset filetype, so we need to manually set it.\n        await vscode.languages.setTextDocumentLanguage(text_doc, language_id);\n    }\n    await show_warnings(warnings);\n}\n\n\nasync function handle_rbql_result_file_web(text_doc, warnings) {\n    try {\n        await vscode.window.showTextDocument(text_doc);\n    } catch (error) {\n        show_single_line_error('Unable to open RBQL result document');\n        return;\n    }\n    await show_warnings(warnings);\n}\n\n\nfunction run_command(cmd, args, close_and_error_guard, callback_func) {\n    var command = child_process.spawn(cmd, args, {'windowsHide': true});\n    var stdout = '';\n    var stderr = '';\n    command.stdout.on('data', function(data) {\n        stdout += data.toString();\n    });\n    command.stderr.on('data', function(data) {\n        stderr += data.toString();\n    });\n    command.on('close', function(code) {\n        if (!close_and_error_guard['process_reported']) {\n            close_and_error_guard['process_reported'] = true;\n            callback_func(code, stdout, stderr);\n        }\n    });\n    command.on('error', function(error) {\n        var error_msg = error ? error.name + ': ' + error.message : '';\n        if (!close_and_error_guard['process_reported']) {\n            close_and_error_guard['process_reported'] = true;\n            callback_func(1, '', 'Something went wrong. Make sure you have python installed and added to PATH variable in your OS. Or you can use it with JavaScript instead - it should work out of the box\\nDetails:\\n' + error_msg);\n        }\n    });\n}\n\n\nasync function handle_command_result(src_table_path, dst_table_path, dst_delim, dst_policy, error_code, stdout, stderr, webview_report_handler) {\n    let json_report = stdout;\n    let error_type = null;\n    let error_msg = null;\n    let warnings = [];\n    if (error_code || !json_report || stderr) {\n        error_type = 'Integration';\n        error_msg = stderr ? stderr : 'empty error';\n    } else {\n        try {\n            let report = JSON.parse(json_report);\n            if (report.hasOwnProperty('error_type'))\n                error_type = report['error_type'];\n            if (report.hasOwnProperty('error_msg'))\n                error_msg = report['error_msg'];\n            if (report.hasOwnProperty('warnings'))\n                warnings = report['warnings'];\n        } catch (e) {\n            error_type = 'Integration';\n            error_msg = 'Unable to parse JSON report';\n        }\n    }\n    webview_report_handler(error_type, error_msg);\n    if (error_type || error_msg) {\n        return; // Just exit: error would be shown in the preview window.\n    }\n    // No need to close the RBQL console here, better to leave it open so it can be used to quickly adjust the query if needed.\n    extension_context.autodetection_stoplist.add(dst_table_path);\n    result_set_parent_map.set(safe_lower(dst_table_path), src_table_path);\n    extension_context.autodetection_temporarily_disabled_for_rbql = true;\n    let target_language_id = map_dialect_to_language_id(dst_delim, dst_policy);\n    let doc = await vscode.workspace.openTextDocument(dst_table_path);\n    extension_context.autodetection_temporarily_disabled_for_rbql = false;\n    if (target_language_id == DYNAMIC_CSV) {\n        // TODO it would be better to set this before openTextDocument and adjust the logic so this would affect autodetection.\n        extension_context.dynamic_dialect_for_next_request = [dst_delim, dst_policy];\n    }\n    await handle_rbql_result_file_node(doc, dst_delim, dst_policy, warnings);\n    extension_context.dynamic_dialect_for_next_request = null;\n}\n\n\nfunction get_dst_table_name(input_path, output_delim) {\n    var table_name = path.basename(input_path);\n    var orig_extension = path.extname(table_name);\n    var delim_ext_map = {'\\t': '.tsv', ',': '.csv'};\n    var dst_extension = '.txt';\n    if (delim_ext_map.hasOwnProperty(output_delim)) {\n        dst_extension = delim_ext_map[output_delim];\n    } else if (orig_extension.length > 1) {\n        dst_extension = orig_extension;\n    }\n    let result_table_name = table_name + dst_extension;\n    if (result_table_name == table_name) { // Just being paranoid to avoid overwriting input table accidentally when output dir configured to be the same as input.\n        result_table_name += '.txt';\n    }\n    return result_table_name;\n}\n\n\nfunction file_path_to_query_key(file_path) {\n    return (file_path && file_path.indexOf(scratch_buf_marker) != -1) ? scratch_buf_marker : file_path;\n}\n\nfunction get_dst_table_dir(input_table_path) {\n    let rbql_output_dir = get_from_config('rbql_output_dir', 'TMP');\n    if (rbql_output_dir == 'TMP') {\n        return os.tmpdir();\n    } else if (rbql_output_dir == 'INPUT') {\n        return path.dirname(input_table_path);\n    } else {\n        // Return custom directory. If the directory does not exist or isn't writable RBQL itself will report more or less clear error.\n        return rbql_output_dir;\n    }\n}\n\n\nasync function run_rbql_query(input_path, csv_encoding, backend_language, rbql_query, output_dialect, with_headers, webview_report_handler) {\n    last_rbql_queries.set(file_path_to_query_key(input_path), rbql_query);\n    var cmd = 'python';\n    const test_marker = 'test ';\n    let close_and_error_guard = {'process_reported': false};\n\n    let [input_delim, input_policy, comment_prefix] = [rbql_context.delim, rbql_context.policy, rbql_context.comment_prefix];\n    let [output_delim, output_policy] = [input_delim, input_policy];\n    if (output_dialect == 'csv')\n        [output_delim, output_policy] = [',', QUOTED_POLICY];\n    if (output_dialect == 'tsv')\n        [output_delim, output_policy] = ['\\t', SIMPLE_POLICY];\n    rbql_context.output_delim = output_delim;\n    rbql_context.output_policy = output_policy;\n\n    let output_path = is_web_ext ? null : path.join(get_dst_table_dir(input_path), get_dst_table_name(input_path, output_delim));\n\n    if (rbql_query.startsWith(test_marker)) {\n        if (rbql_query.indexOf('nopython') != -1) {\n            cmd = 'nopython';\n        }\n        let args = [absolute_path_map['rbql mock/rbql_mock.py'], rbql_query];\n        run_command(cmd, args, close_and_error_guard, function(error_code, stdout, stderr) { handle_command_result(input_path, output_path, output_delim, output_policy, error_code, stdout, stderr, webview_report_handler); });\n        return;\n    }\n    if (backend_language == 'js') {\n        let warnings = [];\n        let result_doc = null;\n        let target_language_id = map_dialect_to_language_id(output_delim, output_policy);\n        try {\n            if (is_web_ext) {\n                let result_lines = await ll_rainbow_utils().rbql_query_web(rbql_query, rbql_context.input_document, input_delim, input_policy, output_delim, output_policy, warnings, with_headers, comment_prefix);\n                let output_doc_cfg = {content: result_lines.join('\\n'), language: target_language_id};\n                if (target_language_id == DYNAMIC_CSV) {\n                    extension_context.dynamic_dialect_for_next_request = [output_delim, output_policy];\n                }\n                extension_context.autodetection_temporarily_disabled_for_rbql = true;\n                result_doc = await vscode.workspace.openTextDocument(output_doc_cfg);\n                extension_context.dynamic_dialect_for_next_request = null;\n                extension_context.autodetection_temporarily_disabled_for_rbql = false;\n                webview_report_handler(null, null);\n                await handle_rbql_result_file_web(result_doc, warnings);\n            } else {\n                let csv_options = {'bulk_read': true};\n                await ll_rainbow_utils().rbql_query_node(global_state, rbql_query, input_path, input_delim, input_policy, output_path, output_delim, output_policy, csv_encoding, warnings, with_headers, comment_prefix, /*user_init_code=*/'', csv_options);\n                result_set_parent_map.set(safe_lower(output_path), input_path);\n                extension_context.autodetection_temporarily_disabled_for_rbql = true;\n                result_doc = await vscode.workspace.openTextDocument(output_path);\n                extension_context.autodetection_temporarily_disabled_for_rbql = false;\n                webview_report_handler(null, null);\n                if (target_language_id == DYNAMIC_CSV) {\n                    // TODO it would be better to set this before openTextDocument and adjust the logic so this would affect autodetection.\n                    extension_context.dynamic_dialect_for_next_request = [output_delim, output_policy];\n                }\n                await handle_rbql_result_file_node(result_doc, output_delim, output_policy, warnings);\n                extension_context.dynamic_dialect_for_next_request = null;\n            }\n        } catch (e) {\n            let [error_type, error_msg] = ll_rbql_csv().exception_to_error_info(e);\n            webview_report_handler(error_type, error_msg);\n            return;\n        }\n    } else {\n        if (is_web_ext) {\n            webview_report_handler('Input error', 'Python backend for RBQL is not supported in web version, please use JavaScript backend.');\n            return;\n        }\n        let cmd_safe_query = Buffer.from(rbql_query, \"utf-8\").toString(\"base64\");\n        if (!comment_prefix) {\n            comment_prefix = '';\n        }\n        let args = [absolute_path_map['rbql_core/vscode_rbql.py'], cmd_safe_query, input_path, input_delim, input_policy, output_path, output_delim, output_policy, comment_prefix, csv_encoding];\n        if (with_headers)\n            args.push('--with_headers');\n        run_command(cmd, args, close_and_error_guard, function(error_code, stdout, stderr) { handle_command_result(input_path, output_path, output_delim, output_policy, error_code, stdout, stderr, webview_report_handler); });\n    }\n}\n\n\nasync function set_header_line() {\n    let active_editor = get_active_editor();\n    if (!active_editor)\n        return;\n    var active_doc = get_active_doc(active_editor);\n    if (!active_doc)\n        return;\n\n    let [delim, policy, _comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        show_single_line_error('Unable to set header line: no separator specified');\n        return;\n    }\n    let file_path = active_doc.fileName;\n    if (!file_path || active_doc.uri.scheme != 'file') {\n        show_single_line_error('Unable to set header line for non-file documents');\n        return;\n    }\n    let selection = active_editor.selection;\n    let raw_header = active_doc.lineAt(selection.start.line).text;\n\n    let header = csv_utils.smart_split(raw_header, delim, policy, false)[0];\n    await save_to_global_state(make_header_key(file_path), JSON.stringify(header));\n}\n\n\nfunction preserve_original_language_id_if_needed(file_path, original_language_id, original_language_ids) {\n    if (original_language_id == DYNAMIC_CSV) {\n        // This is to prevent invalid noop \"dynamic csv\" -> \"dynamic csv\" switch without carying dialect info.\n        return;\n    }\n    if (original_language_ids.has(file_path)) {\n        // Rainbow Off should act more like an actuall off i.e. return to the first filetype in the chain instead of the previous one.\n        return;\n    }\n    original_language_ids.set(file_path, original_language_id);\n}\n\n\nasync function manually_set_rainbow_separator(policy=null) {\n    // The effect of manually setting the separator will disapear in the preview mode when the file is toggled in preview tab: see https://code.visualstudio.com/docs/getstarted/userinterface#_preview-mode\n    let active_editor = get_active_editor();\n    if (!active_editor)\n        return;\n    var active_doc = get_active_doc(active_editor);\n    if (!active_doc)\n        return;\n    let selection = active_editor.selection;\n    if (!selection) {\n        show_single_line_error(\"Selection is empty\");\n        return;\n    }\n    if (selection.start.line != selection.end.line) {\n        show_single_line_error(\"Rainbow separator must not span multiple lines\");\n        return;\n    }\n    let separator = active_doc.lineAt(selection.start.line).text.substring(selection.start.character, selection.end.character);\n    if (!separator) {\n        show_single_line_error(\"Make nonempty separator selection with the cursor\");\n        return;\n    }\n    if (policy == QUOTED_RFC_POLICY && separator != ',' && separator != ';') {\n        show_single_line_error(\"Only comma and semicolon separators are currently supported to use with multiline fields.\");\n        return;\n    }\n    if (policy === null) {\n        policy = get_default_policy(separator);\n    }\n    let language_id = map_dialect_to_language_id(separator, policy);\n    // Adding to stoplist just in case: this is the manual op, so the user now fully controls the filetype.\n    extension_context.autodetection_stoplist.add(active_doc.fileName);\n    if (language_id == DYNAMIC_CSV) {\n        extension_context.dynamic_document_dialects.set(active_doc.fileName, {delim: separator, policy: policy});\n    }\n    let original_language_id = active_doc.languageId;\n    if (original_language_id == DYNAMIC_CSV && language_id == DYNAMIC_CSV) {\n        // We need to somehow explicitly re-tokenize file, because otherwise setTextDocumentLanguage would be a NO-OP, so we do this workaround with temporarily switching to plaintext and back.\n        extension_context.autodetection_stoplist.add(active_doc.fileName); // This is to avoid potential autodetection in plaintext.\n        extension_context.autodetection_temporarily_disabled_for_rbql = true;\n        active_doc = await vscode.languages.setTextDocumentLanguage(active_doc, 'plaintext');\n        extension_context.autodetection_temporarily_disabled_for_rbql = false;\n    }\n    let doc = await vscode.languages.setTextDocumentLanguage(active_doc, language_id);\n    preserve_original_language_id_if_needed(doc.fileName, original_language_id, extension_context.original_language_ids);\n}\n\n\nasync function set_comment_prefix() {\n    let active_editor = get_active_editor();\n    if (!active_editor)\n        return;\n    var active_doc = get_active_doc(active_editor);\n    if (!active_doc)\n        return;\n    let selection = active_editor.selection;\n    if (!selection) {\n        show_single_line_error(\"Selection is empty\");\n        return;\n    }\n    let comment_prefix = active_doc.lineAt(selection.start.line).text.substring(selection.start.character, selection.end.character);\n    extension_context.custom_comment_prefixes.set(active_doc.fileName, comment_prefix);\n    if (!comment_prefix) {\n        manual_comment_prefix_stoplist.add(active_doc.fileName);\n    } else {\n        manual_comment_prefix_stoplist.delete(active_doc.fileName);\n    }\n    if (comment_prefix) {\n        vscode.languages.setLanguageConfiguration(active_doc.languageId, { comments: { lineComment: comment_prefix } });\n    }\n    if (active_doc.languageId == DYNAMIC_CSV) {\n        // Re-enable tokenization to explicitly trigger the highligthing. Sometimes this doesn't happen automatically.\n        enable_dynamic_semantic_tokenization();\n    } else {\n        // Re-enable comment tokenization to explicitly adjust the comment highligthing (sometimes to disable it if comment prefix is set to an empty string).\n        register_comment_tokenization_handler();\n    }\n}\n\n\nasync function restore_original_language() {\n    var active_doc = get_active_doc();\n    if (!active_doc)\n        return;\n    let file_path = active_doc.fileName;\n    extension_context.autodetection_stoplist.add(file_path);\n    let original_language_id = 'plaintext';\n    if (extension_context.original_language_ids.has(file_path)) {\n        original_language_id = extension_context.original_language_ids.get(file_path);\n    }\n    if (!original_language_id || original_language_id == active_doc.languageId) {\n        show_single_line_error(\"Unable to restore original language\");\n        return;\n    }\n\n    let doc = await vscode.languages.setTextDocumentLanguage(active_doc, original_language_id);\n    extension_context.original_language_ids.delete(file_path);\n    disable_rainbow_features_if_non_csv(doc);\n    // If the previous language is restored via native VSCode filetype selection the custom dialect info will be kept and in case of future manual Dynamic CSV selection the highlighting will be automatically activated without separator entry dialog.\n    extension_context.dynamic_document_dialects.delete(file_path);\n}\n\n\nasync function set_join_table_name() {\n    if (is_web_ext) {\n        show_single_line_error('This command is currently unavailable in web mode.');\n        return;\n    }\n    var active_doc = get_active_doc();\n    if (!active_doc)\n        return;\n    let file_path = active_doc.fileName;\n    if (!file_path) {\n        show_single_line_error('Unable to use this document as join table');\n        return;\n    }\n    var title = \"Input table name to use in RBQL JOIN expressions instead of table path\";\n    var input_box_props = {\"prompt\": title, \"value\": 'b'};\n    let table_name = await vscode.window.showInputBox(input_box_props);\n    if (!table_name)\n        return; // User pressed Esc and closed the input box.\n    await save_to_global_state(ll_rainbow_utils().make_table_name_key(table_name), file_path);\n}\n\n\nasync function set_virtual_header() {\n    var active_doc = get_active_doc();\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        show_single_line_error('Unable to set virtual header: no separator specified');\n        return;\n    }\n    var file_path = active_doc.fileName;\n    if (!file_path || active_doc.uri.scheme != 'file') {\n        show_single_line_error('Unable to edit column names for non-file documents');\n        return;\n    }\n    var old_header = get_header(active_doc, delim, policy, comment_prefix);\n    var title = \"Adjust column names displayed in hover tooltips. Actual header line and file content won't be affected.\";\n    var old_header_str = old_header ? quoted_join(old_header, delim) : '';\n    var input_box_props = {\"prompt\": title, \"value\": old_header_str};\n    let raw_new_header = await vscode.window.showInputBox(input_box_props);\n    if (!raw_new_header)\n        return; // User pressed Esc and closed the input box.\n    let new_header = csv_utils.smart_split(raw_new_header, delim, policy, false)[0];\n    await save_to_global_state(make_header_key(file_path), JSON.stringify(new_header));\n}\n\n\nasync function column_edit(edit_mode) {\n    let active_editor = get_active_editor();\n    if (!active_editor)\n        return;\n    let active_doc = active_editor.document;\n    if (!active_doc)\n        return;\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        return;\n    }\n    let position = ll_rainbow_utils().get_cursor_position_if_unambiguous(active_editor);\n    if (!position) {\n        show_single_line_error('Unable to enter column edit mode: make sure that no text is selected and only one cursor is active');\n        return;\n    }\n    if (active_doc.lineCount >= 10000) {\n        show_single_line_error('Multicursor column edit works only for files smaller than 10000 lines.');\n        return;\n    }\n    let col_num = (ll_rainbow_utils().get_cursor_position_info(vscode, active_doc, delim, policy, comment_prefix, position)).column_number;\n    let [selections, error_msg, warning_msg] = ll_rainbow_utils().generate_column_edit_selections(vscode, active_doc, delim, policy, comment_prefix, edit_mode, col_num);\n    if (error_msg !== null) {\n        show_single_line_error(error_msg);\n        return;\n    }\n    if (warning_msg) {\n        vscode.window.showWarningMessage(warning_msg);\n    }\n    active_editor.selections = selections;\n    // Call showTextDocument so that the editor will gain focus and the cursors will become active and blinking. This is a critical step here!\n    await vscode.window.showTextDocument(active_doc);\n}\n\n\nasync function shrink_table() {\n    let active_editor = get_active_editor();\n    let active_doc = get_active_doc(active_editor);\n    if (!active_doc)\n        return;\n    let language_id = active_doc.languageId;\n    if (!dialect_map.hasOwnProperty(language_id))\n        return;\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        return;\n    }\n    let progress_options = {location: vscode.ProgressLocation.Window, title: 'Rainbow CSV'};\n    await vscode.window.withProgress(progress_options, async (progress) => {\n        progress.report({message: 'Preparing'});\n        await push_current_stack_to_js_callback_queue_to_allow_ui_update();\n        let [shrinked_doc_text, first_failed_line] = ll_rainbow_utils().shrink_columns(active_doc, delim, policy, comment_prefix);\n        if (first_failed_line) {\n            show_single_line_error(`Unable to shrink: Inconsistent double quotes at line ${first_failed_line}`);\n            return;\n        }\n        aligned_files.delete(active_doc.fileName);\n        show_align_shrink_button(active_doc.fileName);\n        if (shrinked_doc_text === null) {\n            vscode.window.showWarningMessage('No trailing whitespaces found, skipping');\n            return;\n        }\n        progress.report({message: 'Shrinking columns'});\n        await push_current_stack_to_js_callback_queue_to_allow_ui_update();\n        await replace_doc_content(active_editor, active_doc, shrinked_doc_text);\n    });\n}\n\n\nasync function align_table() {\n    let active_editor = get_active_editor();\n    let active_doc = get_active_doc(active_editor);\n    if (!active_doc)\n        return;\n    let language_id = active_doc.languageId;\n    if (!dialect_map.hasOwnProperty(language_id))\n        return;\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        return;\n    }\n    let progress_options = {location: vscode.ProgressLocation.Window, title: 'Rainbow CSV'};\n    await vscode.window.withProgress(progress_options, async (progress) => {\n        progress.report({message: 'Calculating column statistics'});\n        await push_current_stack_to_js_callback_queue_to_allow_ui_update();\n        let [column_stats, first_failed_line, records, comments] = ll_rainbow_utils().calc_column_stats(active_doc, delim, policy, comment_prefix);\n        if (first_failed_line) {\n            show_single_line_error(`Unable to align: Inconsistent double quotes at line ${first_failed_line}`);\n            return;\n        }\n        column_stats = ll_rainbow_utils().adjust_column_stats(column_stats, delim.length);\n        if (column_stats === null) {\n            show_single_line_error('Unable to allign: Internal Rainbow CSV Error');\n            return;\n        }\n        progress.report({message: 'Preparing final alignment'});\n        await push_current_stack_to_js_callback_queue_to_allow_ui_update();\n        let aligned_doc_text = ll_rainbow_utils().align_columns(records, comments, column_stats, delim);\n        aligned_files.add(active_doc.fileName);\n        show_align_shrink_button(active_doc.fileName);\n        // The last stage of actually applying the edits takes almost 80% of the whole alignment runtime.\n        progress.report({message: 'Aligning columns'});\n        await push_current_stack_to_js_callback_queue_to_allow_ui_update();\n        await replace_doc_content(active_editor, active_doc, aligned_doc_text);\n    });\n}\n\n\nasync function do_copy_back(query_result_doc, active_editor) {\n    let data = query_result_doc.getText();\n    let active_doc = get_active_doc(active_editor);\n    if (!active_doc)\n        return;\n    await replace_doc_content(active_editor, active_doc, data);\n}\n\n\nasync function copy_back() {\n    if (is_web_ext) {\n        show_single_line_error('This command is currently unavailable in web mode.');\n        return;\n    }\n    let result_doc = get_active_doc();\n    if (!result_doc)\n        return;\n    let file_path = result_doc.fileName;\n    let parent_table_path = result_set_parent_map.get(safe_lower(file_path));\n    if (!parent_table_path)\n        return;\n    let parent_doc = await vscode.workspace.openTextDocument(parent_table_path);\n    let parent_editor = await vscode.window.showTextDocument(parent_doc);\n    await do_copy_back(result_doc, parent_editor);\n}\n\n\nasync function update_query_history(query) {\n    let history_list = get_from_global_state('rbql_query_history', []);\n    let old_index = history_list.indexOf(query);\n    if (old_index != -1) {\n        history_list.splice(old_index, 1);\n    } else if (history_list.length >= 20) {\n        history_list.splice(0, 1);\n    }\n    history_list.push(query);\n    await save_to_global_state('rbql_query_history', history_list);\n}\n\n\nasync function handle_rbql_client_message(webview, message, integration_test_options=null) {\n    let message_type = message['msg_type'];\n\n    let webview_report_handler = async function(error_type, error_msg) {\n        let report_msg = {'msg_type': 'rbql_report'};\n        if (error_type)\n            report_msg[\"error_type\"] = error_type;\n        if (error_msg)\n            report_msg[\"error_msg\"] = error_msg;\n        _unit_test_last_rbql_report = report_msg;\n        await webview.postMessage(report_msg);\n    };\n\n    if (message_type == 'handshake') {\n        var backend_language = get_from_global_state('rbql_backend_language', 'js');\n        var encoding = get_from_global_state('rbql_encoding', 'utf-8');\n        var init_msg = {'msg_type': 'handshake', 'backend_language': backend_language, 'encoding': encoding};\n        ll_rainbow_utils().sample_preview_records_from_context(rbql_context, init_msg, preview_window_size, cached_table_parse_result);\n        let path_key = file_path_to_query_key(rbql_context.input_document_path);\n        if (last_rbql_queries.has(path_key))\n            init_msg['last_query'] = last_rbql_queries.get(path_key);\n        let history_list = get_from_global_state('rbql_query_history', []);\n        init_msg['query_history'] = history_list;\n        init_msg['policy'] = rbql_context.policy;\n        init_msg['with_headers'] = rbql_context.with_headers;\n        init_msg['header_for_ui'] = rbql_context.header_for_ui;\n        init_msg['is_web_ext'] = is_web_ext;\n        if (integration_test_options) {\n            init_msg['integration_test_language'] = integration_test_options.rbql_backend;\n            init_msg['integration_test_query'] = integration_test_options.rbql_query;\n            init_msg['integration_test_with_headers'] = integration_test_options.with_headers || false;\n            init_msg['integration_test_delay'] = integration_test_options.integration_test_delay || 2000;\n        }\n        await webview.postMessage(init_msg);\n    }\n\n    if (message_type == 'fetch_table_header') {\n        try {\n            let table_id = message['table_id'];\n            let encoding = message['encoding'];\n\n            let input_table_dir = rbql_context.input_document_path ? path.dirname(rbql_context.input_document_path) : null;\n            let table_path = ll_rainbow_utils().find_table_path(global_state, input_table_dir, table_id);\n            if (!table_path)\n                return;\n            let header_line = await ll_rainbow_utils().read_header(table_path, encoding);\n            if (!header_line) {\n                return;\n            }\n            let [fields, warning] = csv_utils.smart_split(header_line, rbql_context.delim, rbql_context.policy, false);\n            if (!warning) {\n                webview.postMessage({'msg_type': 'fetch_table_header_response', 'header_for_ui': fields});\n            }\n        } catch (e) {\n            console.error('Unable to get join table header: ' + String(e));\n        }\n    }\n\n    if (message_type == 'update_query') {\n        let rbql_query = message['query'];\n        if (!rbql_query)\n            return;\n        if (rbql_context.input_document_path)\n            last_rbql_queries.set(file_path_to_query_key(rbql_context.input_document_path), rbql_query);\n    }\n\n    if (message_type == 'with_headers_change') {\n        rbql_context.with_headers = message['with_headers'];\n        if (rbql_context.input_document_path)\n            await save_to_global_state(make_with_headers_key(rbql_context.input_document_path), rbql_context.with_headers);\n    }\n\n    if (message_type == 'navigate') {\n        var navig_direction = message['direction'];\n        if (navig_direction == 'backward') {\n            rbql_context.requested_start_record -= preview_window_size;\n        } else if (navig_direction == 'forward') {\n            rbql_context.requested_start_record += preview_window_size;\n        } else if (navig_direction == 'begin') {\n            rbql_context.requested_start_record = 0;\n        } else if (navig_direction == 'end') {\n            rbql_context.requested_start_record = rbql_context.input_document.lineCount; // This is just max possible value which is incorrect and will be adjusted later.\n        }\n        let protocol_message = {'msg_type': 'navigate'};\n        ll_rainbow_utils().sample_preview_records_from_context(rbql_context, protocol_message, preview_window_size, cached_table_parse_result);\n        await webview.postMessage(protocol_message);\n    }\n\n    if (message_type == 'run') {\n        let rbql_query = message['query'];\n        let backend_language = message['backend_language'];\n        let encoding = message['encoding'];\n        let output_dialect = message['output_dialect'];\n        let with_headers = message['with_headers'];\n        await update_query_history(rbql_query);\n        await run_rbql_query(rbql_context.input_document_path, encoding, backend_language, rbql_query, output_dialect, with_headers, webview_report_handler);\n    }\n\n    if (message_type == 'edit_udf') {\n        if (is_web_ext) {\n            webview_report_handler('Input error', 'UDFs are currently not supported in web version');\n            return;\n        }\n        let backend_language = message['backend_language'];\n        let udf_file_path = null;\n        let default_content = '';\n        if (backend_language == 'js') {\n            udf_file_path = path.join(os.homedir(), '.rbql_init_source.js');\n            default_content = ll_rainbow_utils().get_default_js_udf_content();\n        } else {\n            udf_file_path = path.join(os.homedir(), '.rbql_init_source.py');\n            default_content = ll_rainbow_utils().get_default_python_udf_content();\n        }\n        if (!fs.existsSync(udf_file_path)) {\n            fs.writeFileSync(udf_file_path, default_content);\n        }\n        let udf_doc = await vscode.workspace.openTextDocument(udf_file_path);\n        await vscode.window.showTextDocument(udf_doc);\n    }\n\n    if (message_type == 'global_param_change') {\n        await save_to_global_state(message['key'], message['value']);\n    }\n}\n\n\nfunction adjust_webview_paths(paths_list, client_html) {\n    for (const local_path of paths_list) {\n        let adjusted_webview_url = null;\n        if (is_web_ext) {\n            adjusted_webview_url = absolute_path_map[local_path];\n        } else {\n            adjusted_webview_url = preview_panel.webview.asWebviewUri(vscode.Uri.file(absolute_path_map[local_path]));\n        }\n        client_html = client_html.replace(`src=\"${local_path}\"`, `src=\"${adjusted_webview_url}\"`);\n    }\n    return client_html;\n}\n\n\nasync function edit_rbql(integration_test_options=null) {\n    let active_window = vscode.window;\n    if (!active_window)\n        return;\n    let active_editor = active_window.activeTextEditor;\n    if (!active_editor)\n        return;\n    let active_doc = active_editor.document;\n    if (!active_doc)\n        return;\n    let orig_uri = active_doc.uri;\n    if (!orig_uri)\n        return;\n    // For web orig_uri.scheme can have other valid values e.g. `vscode-test-web` when testing the browser integration.\n    if (orig_uri.scheme != 'file' && orig_uri.scheme != 'untitled' && !is_web_ext)\n        return;\n    if (orig_uri.scheme == 'file' && active_doc.isDirty && !is_web_ext) {\n        show_single_line_error(\"Unable to run RBQL: file has unsaved changes\");\n        return;\n    }\n    let input_path = null;\n    if (orig_uri.scheme == 'untitled' && !is_web_ext) {\n        // Scheme 'untitled' means that the document is a scratch buffer that hasn't been saved yet, see https://code.visualstudio.com/api/references/document-selector\n        let data = active_doc.getText();\n        let rnd_suffix = String(Math.floor(Math.random() * 1000000));\n        input_path = path.join(os.tmpdir(), `${scratch_buf_marker}_${rnd_suffix}.txt`);\n        // TODO consider adding username to the input_path and using chmod 600 on it.\n        fs.writeFileSync(input_path, data);\n    } else {\n        input_path = active_doc.fileName;\n    }\n\n    if (!input_path) {\n        show_single_line_error(\"Unable to run RBQL for this file\");\n        return;\n    }\n\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        policy = 'monocolumn';\n        delim = 'monocolumn';\n    }\n    let with_headers_by_default = get_from_config('rbql_with_headers_by_default', false);\n    let with_headers = get_from_global_state(make_with_headers_key(input_path), with_headers_by_default);\n    let header_for_ui = get_header_from_document(active_doc, delim, policy, comment_prefix);\n    rbql_context = {\n        \"input_document\": active_doc,\n        \"input_document_path\": input_path,\n        \"requested_start_record\": 0,\n        \"delim\": delim,\n        \"policy\": policy,\n        \"comment_prefix\": comment_prefix,\n        \"with_headers\": with_headers,\n        \"header_for_ui\": header_for_ui\n    };\n\n    preview_panel = vscode.window.createWebviewPanel('rbql-console', 'RBQL Console', vscode.ViewColumn.Active, {enableScripts: true});\n    if (!client_html_template) {\n        if (is_web_ext) {\n            client_html_template = client_html_template_web;\n        } else {\n            client_html_template = fs.readFileSync(absolute_path_map['rbql_client.html'], \"utf8\");\n        }\n    }\n    let client_html = client_html_template;\n    client_html = adjust_webview_paths(['contrib/textarea-caret-position/index.js', 'rbql_suggest.js', 'rbql_client.js', 'rbql_logo.svg'], client_html);\n    preview_panel.webview.html = client_html;\n    preview_panel.webview.onDidReceiveMessage(function(message) { handle_rbql_client_message(preview_panel.webview, message, integration_test_options); });\n}\n\n\nfunction autodetect_dialect(config, active_doc, candidate_separators, comment_prefix) {\n    let candidate_dialects = [];\n    for (let separator of candidate_separators) {\n        let policy = get_default_policy(separator);\n        let dialect_id = map_dialect_to_language_id(separator, policy);\n        if (!dialect_id || !policy)\n            continue;\n        candidate_dialects.push([dialect_id, separator, policy]);\n        if (separator == ',' || separator == ';') {\n            candidate_dialects.push([DYNAMIC_CSV, separator, QUOTED_RFC_POLICY]);\n        }\n    }\n    let detect_trailing_spaces = get_from_config('csv_lint_detect_trailing_spaces', false, config);\n    let min_num_lines = get_from_config('autodetection_min_line_count', 10, config);\n    if (active_doc.lineCount < min_num_lines)\n        return [null, null, null];\n    let [best_dialect, best_separator, best_policy, best_dialect_first_trailing_space_line] = [null, null, null, null];\n    let best_dialect_num_columns = 1;\n    for (let candidate_dialect of candidate_dialects) {\n        let [dialect_id, separator, policy] = candidate_dialect;\n        let [_records, num_records_parsed, fields_info, first_defective_line, first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(active_doc, separator, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/false, /*preserve_quotes_and_whitespaces=*/true, detect_trailing_spaces, /*min_num_fields_for_autodetection=*/best_dialect_num_columns + 1);\n        if (first_defective_line !== null || fields_info.size != 1)\n            continue;\n        if (num_records_parsed < min_num_lines) {\n            // Ensure that min_num_lines also applies to number of parsed records. There could be a discrepancy between number of lines and records due to comment lines and/or multiline rfc records.\n            continue;\n        }\n        let num_columns = Array.from(fields_info.keys())[0];\n        if (num_columns >= best_dialect_num_columns + 1) {\n            best_dialect_num_columns = num_columns;\n            [best_dialect, best_separator, best_policy] = [dialect_id, separator, policy];\n            best_dialect_first_trailing_space_line = first_trailing_space_line;\n        }\n    }\n    return [best_dialect, best_separator, best_policy, best_dialect_first_trailing_space_line];\n}\n\n\nfunction autodetect_dialect_frequency_based(active_doc, candidate_separators, max_num_chars_to_test) {\n    let [best_dialect, best_separator, best_policy] = ['csv', ',', QUOTED_POLICY];\n    let best_dialect_frequency = 0;\n    let data = active_doc.getText();\n    if (!data)\n        return [best_dialect, best_separator, best_policy];\n    for (let separator of candidate_separators) {\n        if (separator == ' ' || separator == '.')\n            continue; // Whitespace and dot have advantage over other separators in this algorithm, so we just skip them.\n        let frequency = 0;\n        for (let j = 0; j < max_num_chars_to_test && j < data.length; j++) {\n            if (data[j] == separator)\n                frequency += 1;\n        }\n        if (frequency > best_dialect_frequency) {\n            let policy = get_default_policy(separator);\n            let dialect_id = map_dialect_to_language_id(separator, policy);\n            [best_dialect, best_separator, best_policy] = [dialect_id, separator, policy];\n            best_dialect_frequency = frequency;\n        }\n    }\n    return [best_dialect, best_separator, best_policy];\n}\n\n\nasync function try_autoenable_rainbow_csv(vscode, config, extension_context, active_doc) {\n    // VSCode to some extent is capable of \"remembering\" doc id in the previous invocation, at least when used in debug mode.\n\n    // VSCode may (and will?) forget documentId of a document \"A\" if document \"B\" is opened in the tab where \"A\" was (double VS single click in file browser panel).\n    // see https://code.visualstudio.com/docs/getstarted/userinterface#_preview-mode\n    if (extension_context.autodetection_temporarily_disabled_for_rbql)\n        return active_doc;\n    if (!active_doc)\n        return active_doc;\n    if (!get_from_config('enable_separator_autodetection', false, config))\n        return active_doc;\n    let candidate_separators = get_from_config('autodetect_separators', [], config).map((s) => s === 'TAB' ? '\\t' : s);\n    var original_language_id = active_doc.languageId;\n    var file_path = active_doc.fileName;\n    if (!file_path || extension_context.autodetection_stoplist.has(file_path) || file_path.endsWith('.git')) { // For some reason there are some ghost '.git' files. TODO figure this out!\n        return active_doc;\n    }\n    let is_default_csv = file_path.endsWith('.csv') && original_language_id == 'csv';\n    if (original_language_id != 'plaintext' && !is_default_csv)\n        return active_doc;\n    let comment_prefix_for_autodetection = get_from_config('comment_prefix', '', config) || '#'; // Assume '#' as a comment prefix for autodetection purposes only.\n    let [rainbow_csv_language_id, delim, policy, first_trailing_space_line] = autodetect_dialect(config, active_doc, candidate_separators, comment_prefix_for_autodetection);\n    if (rainbow_csv_language_id) {\n        // Add the file to lint results to avoid re-parsing it with CSV Lint later.\n        extension_context.lint_results.set(`${active_doc.fileName}.${rainbow_csv_language_id}`, {'is_ok': true, 'first_trailing_space_line': first_trailing_space_line});\n    } else if (!rainbow_csv_language_id && is_default_csv) {\n        // Smart autodetection method has failed, but we need to choose a separator because this is a csv file. Let's just find the most popular one within the first N characters.\n        [rainbow_csv_language_id, delim, policy] = autodetect_dialect_frequency_based(active_doc, candidate_separators, /*max_num_chars_to_test=*/10000);\n    }\n    if (!rainbow_csv_language_id)\n        return active_doc;\n    // Intentionally do not store comment prefix used for autodetection in the dialect info since it is not file-specific anyway and is stored in the settings.\n    // And in case if user changes it in the settings it would immediately affect the autodetected files.\n    if (rainbow_csv_language_id == DYNAMIC_CSV)  {\n        extension_context.dynamic_document_dialects.set(active_doc.fileName, {delim: delim, policy: policy});\n    }\n    if (rainbow_csv_language_id == original_language_id)\n        return active_doc;\n    let doc = await vscode.languages.setTextDocumentLanguage(active_doc, rainbow_csv_language_id);\n    preserve_original_language_id_if_needed(file_path, original_language_id, extension_context.original_language_ids);\n    return doc;\n}\n\n\nasync function handle_first_edit_for_an_empty_doc(change_event) {\n    if (!change_event)\n        return;\n    if (doc_first_edit_subscription) {\n        doc_first_edit_subscription.dispose();\n        doc_first_edit_subscription = null;\n    }\n    await try_autoenable_rainbow_csv(vscode, vscode.workspace.getConfiguration('rainbow_csv'), extension_context, change_event.document);\n}\n\n\nfunction register_csv_copy_paste_for_empty_doc(active_doc) {\n    if (!get_from_config('enable_separator_autodetection', false))\n        return;\n    if (!active_doc || doc_first_edit_subscription)\n        return;\n    if (!active_doc.isUntitled && active_doc.lineCount != 0)\n        return;\n    doc_first_edit_subscription = vscode.workspace.onDidChangeTextDocument(handle_first_edit_for_an_empty_doc);\n}\n\n\nasync function handle_editor_switch(editor) {\n    let active_doc = get_active_doc(editor);\n    disable_rainbow_features_if_non_csv(active_doc);\n    await enable_rainbow_features_if_csv(active_doc); // No-op if non-csv.\n}\n\n\nfunction do_handle_cursor_movement() {\n    if (!show_column_info_button() && column_info_button) {\n        column_info_button.hide();\n    }\n}\n\n\nfunction handle_cursor_movement(_unused_cursor_event) {\n    if (cursor_timeout_handle !== null) {\n        clearTimeout(cursor_timeout_handle);\n    }\n    // We need timeout delay here to deduplicate/debounce events from multiple consecutive movements, see https://stackoverflow.com/a/49050990/2898283.\n    cursor_timeout_handle = setTimeout(() => do_handle_cursor_movement(), 10);\n}\n\n\nasync function handle_doc_open(active_doc) {\n    // The onDidOpenTextDocument handler will trigger for already \"opened\" docs too if they are re-opened in the same tab. Example\n    // Document \"A\" opens in tab1 -> triggers onDidOpenTextDocument\n    // Document \"B\" opens in tab1 -> triggers onDidOpenTextDocument  (this could happen if user clicks on document \"B\" in the left file browser panel)\n    // Document \"A\" opens in tab1 -> triggers onDidOpenTextDocument again! The previous languageId is reset.\n    // In other words if user opens a different document in the same tab (single click VS double click in the file browser panel) it may trigger the curent document closing and opening of a new doc.\n    // This behavior is called Preview Mode, see https://vscode.one/new-tab-vscode/ and https://code.visualstudio.com/docs/getstarted/userinterface#_preview-mode\n\n    if (active_doc.uri.scheme != 'file' && active_doc.uri.scheme != 'untitled' && active_doc.uri.scheme != 'vscode-test-web') {\n        // Current document has unknown file scheme. One reason for this could be that it was created by another extension, see https://code.visualstudio.com/api/extension-guides/virtual-documents#events-and-visibility and https://github.com/mechatroner/vscode_rainbow_csv/issues/123\n        // \"vscode-test-web\" scheme is used for browser unit tests.\n        return;\n    }\n    register_csv_copy_paste_for_empty_doc(active_doc);\n    active_doc = await try_autoenable_rainbow_csv(vscode, vscode.workspace.getConfiguration('rainbow_csv'), extension_context, active_doc);\n    disable_rainbow_features_if_non_csv(active_doc);\n    await enable_rainbow_features_if_csv(active_doc); // No-op if non-csv.\n}\n\n\nfunction quote_field(field, delim) {\n    if (field.indexOf('\"') != -1 || field.indexOf(delim) != -1) {\n        return '\"' + field.replace(/\"/g, '\"\"') + '\"';\n    }\n    return field;\n}\n\n\nfunction quoted_join(fields, delim) {\n    var quoted_fields = fields.map(function(val) { return quote_field(val, delim); });\n    return quoted_fields.join(delim);\n}\n\n\nasync function make_preview(uri, preview_mode) {\n    if (is_web_ext) {\n        show_single_line_error('This command is currently unavailable in web mode.');\n        return;\n    }\n    var file_path = uri.fsPath;\n    if (!file_path || !fs.existsSync(file_path)) {\n        vscode.window.showErrorMessage('Invalid file');\n        return;\n    }\n\n    var size_limit = 1024000; // ~1MB\n    var file_size_in_bytes = fs.statSync(file_path)['size'];\n    if (file_size_in_bytes <= size_limit) {\n        vscode.window.showWarningMessage('Rainbow CSV: The file is not big enough, showing the full file instead. Use this preview for files larger than 1MB');\n        let full_orig_doc = await vscode.workspace.openTextDocument(file_path);\n        await vscode.window.showTextDocument(full_orig_doc);\n        return;\n    }\n\n    let file_basename = path.basename(file_path);\n    const out_path = path.join(os.tmpdir(), `.rb_csv_preview.${preview_mode}.${file_basename}`);\n\n    fs.open(file_path, 'r', (err, fd) => {\n        if (err) {\n            console.log(err.message);\n            vscode.window.showErrorMessage('Unable to preview file');\n            return;\n        }\n\n        var buffer = Buffer.alloc(size_limit);\n        let read_begin_pos = preview_mode == 'head' ? 0 : Math.max(file_size_in_bytes - size_limit, 0);\n        fs.read(fd, buffer, 0, size_limit, read_begin_pos, function(err, _num) {\n            if (err) {\n                console.log(err.message);\n                vscode.window.showErrorMessage('Unable to preview file');\n                return;\n            }\n\n            const buffer_str = buffer.toString();\n            // TODO handle old mac '\\r' line endings - still used by Mac version of Excel.\n            let content = null;\n            if (preview_mode == 'head') {\n                content = buffer_str.substr(0, buffer_str.lastIndexOf(buffer_str.includes('\\r\\n') ? '\\r\\n' : '\\n'));\n            } else {\n                content = buffer_str.substr(buffer_str.indexOf('\\n') + 1);\n            }\n            fs.writeFileSync(out_path, content);\n            vscode.workspace.openTextDocument(out_path).then(doc => vscode.window.showTextDocument(doc));\n        });\n    });\n}\n\n\nfunction register_csv_hover_info_provider(language_id, context) {\n    let hover_provider = vscode.languages.registerHoverProvider(language_id, {\n        provideHover(document, position, token) {\n            return make_hover(document, language_id, position, token);\n        }\n    });\n    context.subscriptions.push(hover_provider);\n}\n\n\nclass RainbowTokenProvider {\n    // We don't utilize typescript `implement` interface keyword, because TS doesn't seem to be exporting interfaces to JS (unlike classes).\n    constructor() {\n    }\n    async provideDocumentRangeSemanticTokens(document, range, _token) {\n        let [delim, policy, comment_prefix] = get_dialect(document);\n        if (!policy || document.languageId != DYNAMIC_CSV) {\n            return null;\n        }\n        let table_ranges = ll_rainbow_utils().parse_document_range(vscode, document, delim, policy, comment_prefix, range);\n        // Create a new builder to clear the previous tokens.\n        const builder = new vscode.SemanticTokensBuilder(tokens_legend);\n        for (let row_info of table_ranges) {\n            if (row_info.hasOwnProperty('comment_range')) {\n                builder.push(row_info.comment_range, 'comment');\n            } else {\n                for (let col_num = 0; col_num < row_info.record_ranges.length; col_num++) {\n                    for (let record_range of row_info.record_ranges[col_num]) {\n                        // One logical field can map to multiple tokens if it spans multiple lines because VSCode doesn't support multiline tokens.\n                        builder.push(record_range, tokenTypes[col_num % tokenTypes.length]);\n                    }\n                }\n            }\n        }\n        return builder.build();\n    }\n}\n\n\nclass CommentTokenProvider {\n    constructor() {\n    }\n    async provideDocumentRangeSemanticTokens(doc, range, _token) {\n        let [_delim, policy, comment_prefix] = get_dialect(doc);\n        if (manual_comment_prefix_stoplist.has(doc.fileName) && !comment_prefix) {\n            // We can't use empty comment prefix (and early return) - in that case the previous highlighting would not go away due to a VSCode quirk, need to make an empty build instead to make sure that all previously highlighted lines were cleared.\n            comment_prefix = '#####COMMENT_PREFIX_THAT_CAN_NOT_OCCURE_IN_A_NORMAL_FILE_AND_EVEN_IF_IT_OCCURES_NOT_A_BIG_DEAL####';\n        }\n        if (!comment_prefix || policy === null || policy == QUOTED_RFC_POLICY) {\n            return null; // Sanity check: with QUOTED_RFC_POLICY we should be using a different tokenizer which also handles comments.\n        }\n        // Create a new builder to clear the previous tokens.\n        const builder = new vscode.SemanticTokensBuilder(tokens_legend);\n        let begin_line = Math.max(0, range.start.line - dynamic_csv_highlight_margin);\n        let end_line = Math.min(doc.lineCount, range.end.line + dynamic_csv_highlight_margin);\n        for (let lnum = begin_line; lnum < end_line; lnum++) {\n            let line_text = doc.lineAt(lnum).text;\n            if (line_text.startsWith(comment_prefix)) {\n                builder.push(new vscode.Range(lnum, 0, lnum, line_text.length), 'comment');\n            }\n        }\n        return builder.build();\n    }\n}\n\n\nasync function activate(context) {\n    // TODO consider storing `context` itself in a global variable.\n    global_state = context.globalState;\n\n    if (is_web_ext) {\n        let rbql_client_uri = vscode.Uri.joinPath(context.extensionUri, 'rbql_client.html');\n        let bytes = await vscode.workspace.fs.readFile(rbql_client_uri);\n        // Using TextDecoder because it should work fine in web extension.\n        client_html_template_web = new TextDecoder().decode(bytes);\n    }\n\n    for (let local_path in absolute_path_map) {\n        if (absolute_path_map.hasOwnProperty(local_path)) {\n            if (is_web_ext) {\n                absolute_path_map[local_path] = vscode.Uri.joinPath(context.extensionUri, local_path);\n            } else {\n                absolute_path_map[local_path] = context.asAbsolutePath(local_path);\n            }\n        }\n    }\n\n    if (get_from_config('enable_tooltip', false)) {\n        for (let language_id in dialect_map) {\n            if (dialect_map.hasOwnProperty(language_id)) {\n                register_csv_hover_info_provider(language_id, context);\n            }\n        }\n    }\n\n    var lint_cmd = vscode.commands.registerCommand('rainbow-csv.CSVLint', csv_lint_cmd);\n    var rbql_cmd = vscode.commands.registerCommand('rainbow-csv.RBQL', edit_rbql);\n    var set_header_line_cmd = vscode.commands.registerCommand('rainbow-csv.SetHeaderLine', set_header_line);\n    var set_comment_prefix_cmd = vscode.commands.registerCommand('rainbow-csv.SetCommentPrefix', set_comment_prefix);\n    var edit_column_names_cmd = vscode.commands.registerCommand('rainbow-csv.SetVirtualHeader', set_virtual_header);\n    var set_join_table_name_cmd = vscode.commands.registerCommand('rainbow-csv.SetJoinTableName', set_join_table_name); // WEB_DISABLED\n    var column_edit_before_cmd = vscode.commands.registerCommand('rainbow-csv.ColumnEditBefore', async function() { await column_edit('ce_before'); });\n    var choose_dynamic_separator_cmd = vscode.commands.registerCommand('rainbow-csv.ChooseDynamicSeparator', async function() { await choose_dynamic_separator(); });\n    var column_edit_after_cmd = vscode.commands.registerCommand('rainbow-csv.ColumnEditAfter', async function() { await column_edit('ce_after'); });\n    var column_edit_select_cmd = vscode.commands.registerCommand('rainbow-csv.ColumnEditSelect', async function() { await column_edit('ce_select'); });\n    var set_separator_cmd = vscode.commands.registerCommand('rainbow-csv.RainbowSeparator', () => { manually_set_rainbow_separator(/*policy=*/null); });\n    var set_separator_multiline_cmd = vscode.commands.registerCommand('rainbow-csv.RainbowSeparatorMultiline', () => { manually_set_rainbow_separator(QUOTED_RFC_POLICY); });\n    var rainbow_off_cmd = vscode.commands.registerCommand('rainbow-csv.RainbowSeparatorOff', restore_original_language);\n    var sample_head_cmd = vscode.commands.registerCommand('rainbow-csv.SampleHead', async function(uri) { await make_preview(uri, 'head'); }); // WEB_DISABLED\n    var sample_tail_cmd = vscode.commands.registerCommand('rainbow-csv.SampleTail', async function(uri) { await make_preview(uri, 'tail'); }); // WEB_DISABLED\n    var align_cmd = vscode.commands.registerCommand('rainbow-csv.Align', align_table);\n    var shrink_cmd = vscode.commands.registerCommand('rainbow-csv.Shrink', shrink_table);\n    var copy_back_cmd = vscode.commands.registerCommand('rainbow-csv.CopyBack', copy_back); // WEB_DISABLED\n    var internal_test_cmd = vscode.commands.registerCommand('rainbow-csv.InternalTest', run_internal_test_cmd);\n\n    var doc_open_event = vscode.workspace.onDidOpenTextDocument(handle_doc_open);\n    var switch_event = vscode.window.onDidChangeActiveTextEditor(handle_editor_switch);\n\n    enable_dynamic_semantic_tokenization();\n\n    if (get_from_config('comment_prefix', null)) {\n        register_comment_tokenization_handler();\n    }\n\n    // The only purpose to add the entries to context.subscriptions is to guarantee their disposal during extension deactivation\n    context.subscriptions.push(lint_cmd);\n    context.subscriptions.push(rbql_cmd);\n    context.subscriptions.push(edit_column_names_cmd);\n    context.subscriptions.push(column_edit_before_cmd);\n    context.subscriptions.push(column_edit_after_cmd);\n    context.subscriptions.push(column_edit_select_cmd);\n    context.subscriptions.push(set_separator_cmd);\n    context.subscriptions.push(set_separator_multiline_cmd);\n    context.subscriptions.push(rainbow_off_cmd);\n    context.subscriptions.push(sample_head_cmd);\n    context.subscriptions.push(sample_tail_cmd);\n    context.subscriptions.push(set_join_table_name_cmd);\n    context.subscriptions.push(align_cmd);\n    context.subscriptions.push(shrink_cmd);\n    context.subscriptions.push(copy_back_cmd);\n    context.subscriptions.push(set_header_line_cmd);\n    context.subscriptions.push(set_comment_prefix_cmd);\n    context.subscriptions.push(internal_test_cmd);\n    context.subscriptions.push(choose_dynamic_separator_cmd);\n\n    context.subscriptions.push(doc_open_event);\n    context.subscriptions.push(switch_event);\n\n\n    // Need this because \"onDidOpenTextDocument()\" doesn't get called for the first open document.\n    // Another issue is when dev debug logging mode is enabled, the first document would be \"Log\" because it is printing something and gets VSCode focus.\n    await sleep(1000);\n    let active_doc = get_active_doc();\n    handle_doc_open(active_doc);\n}\n\n\nfunction deactivate() {\n    // This method is called when extension is deactivated.\n}\n\n\nexports.activate = activate;\nexports.deactivate = deactivate;\n\n// Exports just for unit tests:\nexports.autodetect_dialect_frequency_based = autodetect_dialect_frequency_based;\nexports.try_autoenable_rainbow_csv = try_autoenable_rainbow_csv;\n"],"names":["csv_utils","AssertionError","Error","assert","condition","message","RecordTextConsumer","constructor","delim","policy","stop_on_warning","collect_records","preserve_quotes_and_whitespaces","detect_trailing_spaces","min_num_fields_for_autodetection","this","first_defective_line","records","num_records_parsed","fields_info","Map","first_trailing_space_line","consume","record_text","record_start_line","record","warning","smart_split","field","length","charAt","has","set","size","push","module","exports","parse_document_records","document","comment_prefix","max_records_to_parse","num_lines","lineCount","line_aggregator","MultilineRecordAggregator","consumer","comments","lnum","line_text","lineAt","text","record_num","comment_text","add_line","has_comment_line","reset","has_full_record","get_full_line","startsWith","is_inside_multiline_record","GetIntrinsic","callBind","$indexOf","name","allowMissing","intrinsic","bind","$apply","$call","$reflectApply","call","$gOPD","$defineProperty","$max","value","e","originalFunction","func","arguments","desc","configurable","applyBind","apply","isCallable","toStr","Object","prototype","toString","hasOwnProperty","forEachArray","array","iterator","receiver","i","len","forEachString","string","forEachObject","object","k","list","thisArg","TypeError","ERROR_MESSAGE","slice","Array","funcType","that","target","bound","args","binder","result","concat","boundLength","Math","max","boundArgs","Function","join","Empty","implementation","undefined","$SyntaxError","SyntaxError","$Function","$TypeError","getEvalledConstructor","expressionSyntax","getOwnPropertyDescriptor","throwTypeError","ThrowTypeError","calleeThrows","get","gOPDthrows","hasSymbols","getProto","getPrototypeOf","x","__proto__","needsEval","TypedArray","Uint8Array","INTRINSICS","AggregateError","ArrayBuffer","Symbol","Atomics","BigInt","Boolean","DataView","Date","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","eval","EvalError","Float32Array","Float64Array","FinalizationRegistry","Int8Array","Int16Array","Int32Array","isFinite","isNaN","JSON","Number","parseFloat","parseInt","Promise","Proxy","RangeError","ReferenceError","Reflect","RegExp","Set","SharedArrayBuffer","String","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakRef","WeakSet","doEval","fn","gen","LEGACY_ALIASES","hasOwn","$concat","$spliceApply","splice","$replace","replace","$strSlice","$exec","exec","rePropName","reEscapeChar","stringToPath","first","last","match","number","quote","subString","getBaseIntrinsic","alias","intrinsicName","parts","intrinsicBaseName","intrinsicRealName","skipFurtherCaching","isOwn","part","origSymbol","hasSymbolSham","getOwnPropertySymbols","obj","sym","symObj","keys","getOwnPropertyNames","syms","propertyIsEnumerable","descriptor","enumerable","toStringTag","create","ctor","superCtor","super_","writable","TempCtor","hasToStringTag","$toString","callBound","isStandardArguments","isLegacyArguments","callee","supportsStandardArguments","badArrayLike","isCallableMarker","fnToStr","reflectApply","defineProperty","_","constructorRegex","isES6ClassFn","fnStr","test","tryFunctionObject","isIE68","isDDA","all","str","strClass","GeneratorFunction","isFnRegex","generatorFunc","getGeneratorFunc","forEach","availableTypedArrays","gOPD","g","globalThis","typedArrays","$slice","toStrTags","typedArray","arr","proto","superProto","tag","anyTrue","getter","tryTypedArrays","cachedSetTimeout","cachedClearTimeout","process","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","run","marker","runClearTimeout","Item","noop","nextTick","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","arg","copy","fill","readUInt8","isArgumentsObject","isGeneratorFunction","whichTypedArray","isTypedArray","uncurryThis","f","BigIntSupported","SymbolSupported","ObjectToString","numberValue","valueOf","stringValue","booleanValue","bigIntValue","symbolValue","checkBoxedPrimitive","prototypeValueOf","isMapToString","isSetToString","isWeakMapToString","isWeakSetToString","isArrayBufferToString","isArrayBuffer","working","isDataViewToString","isDataView","isPromise","input","then","catch","isArrayBufferView","isView","isUint8Array","isUint8ClampedArray","isUint16Array","isUint32Array","isInt8Array","isInt16Array","isInt32Array","isFloat32Array","isFloat64Array","isBigInt64Array","isBigUint64Array","isMap","isSet","isWeakMap","isWeakSet","SharedArrayBufferCopy","isSharedArrayBufferToString","isSharedArrayBuffer","isNumberObject","isStringObject","isBooleanObject","isBigIntObject","isSymbolObject","isAsyncFunction","isMapIterator","isSetIterator","isGeneratorObject","isWebAssemblyCompiledModule","isBoxedPrimitive","isAnyArrayBuffer","method","getOwnPropertyDescriptors","descriptors","formatRegExp","format","isString","objects","inspect","stringify","isNull","isObject","deprecate","msg","noDeprecation","warned","throwDeprecation","traceDeprecation","console","trace","error","debugs","debugEnvRegex","NODE_DEBUG","debugEnv","toUpperCase","opts","ctx","seen","stylize","stylizeNoColor","depth","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","styleType","style","styles","recurseTimes","isFunction","ret","primitive","simple","isNumber","formatPrimitive","visibleKeys","hash","val","idx","arrayToHash","isError","indexOf","formatError","isRegExp","isDate","output","base","braces","isArray","toUTCString","l","formatProperty","key","formatArray","map","pop","reduce","prev","cur","reduceToSingleString","split","line","ar","re","objectToString","d","o","pad","n","debuglog","pid","types","isNullOrUndefined","isSymbol","isNativeError","isPrimitive","isBuffer","months","timestamp","time","getHours","getMinutes","getSeconds","getDate","getMonth","prop","log","inherits","origin","add","kCustomPromisifiedSymbol","callbackifyOnRejected","reason","cb","newReason","promisify","original","promiseResolve","promiseReject","promise","resolve","reject","err","setPrototypeOf","defineProperties","custom","callbackify","callbackified","maybeCb","self","rej","foundName","os","fs","path","rbql","rbql_csv","fast_load_utils","non_numeric_sentinel","number_regex","QUOTED_RFC_POLICY","QUOTED_POLICY","update_subcomponent_stats","is_first_record","max_field_components_lens","max_total_length","max_int_length","match_result","max_fractional_length","cur_integer_part_length","cur_fractional_part_length","align_field","trim","delta_length","repeat","dot_pos","integer_delta_length","fractional_delta_length","trailing_spaces","rfc_align_field","is_field_segment","aligned","start_offset","strip_trailing_spaces","src","RecordCommentMerger","nr","next_comment","get_next","has_comments_left","has_records_left","has_entries_left","make_table_name_key","file_path","find_table_path","vscode_global_state","main_table_dir","table_id","filepath","candidate_path","homedir","existsSync","isAbsolute","table_path","RbqlIOHandlingError","VSCodeRecordIterator","RBQLInputIterator","has_header","table_name","variable_prefix","super","NR","NL","fail_on_warning","_num_records_parsed","_comments","_first_trailing_space_line","first_record","next_record_index","stop","async","query_text","variable_map","parse_basic_variables","parse_array_variables","parse_attribute_variables","parse_dictionary_variables","do_get_record","get_warnings","inconsistent_records_info","record_num_1","num_fields_1","record_num_2","num_fields_2","sample_first_two_inconsistent_records","warn_msg","make_inconsistent_num_fields_warning","VSCodeWriter","RBQLOutputWriter","header_len","null_in_output","delim_in_simple_output","output_lines","polymorphic_join","simple_join","quoted_join","quoted_join_rfc","mono_join","set_header","header","write","fields","v","quote_field","rfc_quote_field","res","normalize_fields","out_fields","sub_array_delim","VSCodeTableRegistry","get_iterator_by_table_id","_table_id","VSCodeFileSystemCSVRegistry","RBQLTableRegistry","input_file_dir","encoding","options","stream","record_iterator","bulk_input_path","createReadStream","CSVRecordIterator","output_warnings","basename","make_multiline_record_ranges","vscode","delim_length","newline_marker","start_line","expected_end_line_for_control","record_ranges","lnum_current","pos_in_editor_line","next_pos_in_editor_line","pos_in_logical_field","logical_field_tokens","newline_marker_pos","Range","is_opening_rfc_line","_record","split_quoted_str","parse_document_range_rfc","doc","range","custom_parsing_margin","begin_line","start","end_line","min","end","table_ranges","inside_multiline_record_before","get_num_lines_in_record","inside_multiline_record_after","comment_range","combined_line","get_field_by_line_position","query_pos","col_num","cpos","read_header","input_reader","createInterface","closed","promise_resolve","promise_reject","output_promise","close","rbql_query_web","input_document","input_delim","input_policy","output_delim","output_policy","with_headers","join_tables_registry","input_iterator","output_writer","query","rbql_query_node","input_path","output_path","csv_encoding","user_init_code","input_stream","stdin","output_stream","close_output_on_finish","stdout","createWriteStream","is_ascii","default_init_source_path","read_user_init_code","dirname","CSVWriter","get_header_line","get_default_js_udf_content","get_default_python_udf_content","align_columns","column_stats","result_lines","merger","comment","aligned_fields","fnum","field_lines","aligned_field","shrink_columns","active_doc","_fields_info","has_edit","calc_column_stats","field_line","adjust_column_stats","adjusted_stats","column_stat","previous_stat","get_cursor_position_info","position","last_found_position_info","row_info","contains","is_comment","record_range","column_number","total_columns","split_warning","get_cursor_position_info_rfc","cnum","character","entries","get_cursor_position_info_standard","format_cursor_position_info","cursor_position_info","show_column_names","show_comments","max_label_length","short_report","full_report","column_label","short_column_label","substr","parse_document_range","next_cpos","parse_document_range_single_line","sample_preview_records_from_context","rbql_context","dst_message","preview_window_size","cached_table_parse_result","requested_start_record","first_failed_line","end_record","vscode_doc_version","need_full_doc_parse","fileName","sample_records","preview_sampling_error","preview_records","r","cur_record","c","actual_start_record","show_lint_status_bar_button","extension_context","language_id","lint_cache_key","lint_results","lint_report","lint_status_bar_button","window","createStatusBarItem","StatusBarAlignment","Left","lint_report_msg","is_processing","color","isInteger","is_ok","tooltip","command","show","get_cursor_position_if_unambiguous","active_editor","selections","selection","active","isEqual","anchor","generate_column_edit_selections","edit_mode","warning_msg","char_pos_before","char_pos_after","substring","position_before","Position","position_after","Selection","field_regular_expression","field_rgx","field_rgx_external_whitespaces","extract_next_field","dlm","allow_external_whitespaces","cidx","src_cur","match_obj","match_end","uidx","extraction_report","unquote_field","split_whitespace_separated_str","preserve_whitespaces","rgxp","unquote_fields","split_lines","rfc_line_buffer","match_list","has_unbalanced_double_quote","line_separator","RbqlParsingError","RbqlRuntimeError","InternalBadFieldError","bad_idx","params","replace_all","search","replacement","RBQLContext","writer","unnest_list","top_count","like_regex_cache","sort_key_expression","aggregation_stage","aggregation_key_expression","functional_aggregators","join_map_impl","join_map","lhs_join_var_expression","where_expression","select_expression","update_expressions","variables_init_code","query_context","wrong_aggregation_usage_error","RBQL_VERSION","check_if_brackets_match","opening_bracket","closing_bracket","parse_root_bracket_level_text_spans","text_spans","last_pos","bracket_stack","cur_char","span","unquote_string","quoted_str","column_info_from_text_span","text_span","string_literals","rbql_star_marker","simple_var_match","attribute_match","subscript_int_match","subscript_str_match","as_alias_match","column_index","column_name","is_star","alias_name","replaced_string_literal_id","unquoted_column_name","adhoc_parse_select_expression_to_column_infos","ts","stable_compare","a","b","safe_get","safe_join_get","safe_set","regexp_escape","like_to_regex","pattern","p","converted","like","matcher","LIKE","RBQLAggregationToken","marker_id","UnnestMarker","UNNEST","vals","unnest","Unnest","UNFOLD","parse_number","MinAggregator","stats","increment","cur_aggr","get_final","MaxAggregator","SumAggregator","AvgAggregator","cur_sum","cur_cnt","VarianceAggregator","cur_sum_sq","avg_val","MedianAggregator","sort","m","floor","CountAggregator","ArrayAggAggregator","post_proc","ConstGroupVerifier","output_index","const_values","old_value","init_aggregator","generator_name","MIN","Min","MAX","Max","COUNT","count","Count","SUM","sum","Sum","AVG","avg","Avg","VARIANCE","variance","Variance","MEDIAN","median","Median","ARRAY_AGG","array_agg","FOLD","add_to_set","dst_set","len_before","TopWriter","subwriter","NW","finish","UniqWriter","UniqCountWriter","old_val","unshift","SortedWriter","reverse_sort","unsorted_entries","stable_entry","reverse","entry","AggregateWriter","aggregators","aggregation_keys","all_keys","from","ag","InnerJoiner","get_rhs","lhs_key","get_join_records","LeftJoiner","null_record","max_record_len","StrictLeftJoiner","select_except","except_fields","select_simple","sort_key","sort_entry","select_aggregated","transparent_values","num_aggregators_found","trans_value","select_unnested","folded_fields","unnest_pos","findIndex","PROCESS_SELECT_COMMON","PROCESS_SELECT_SIMPLE","PROCESS_SELECT_JOIN","PROCESS_UPDATE_JOIN","PROCESS_UPDATE_SIMPLE","MAIN_LOOP_BODY","embed_expression","parent_code","child_placeholder","child_expression","embed_code","child_code","parent_lines","child_lines","pos","placeholder_indentation","generate_main_loop_code","is_select_query","is_join_query","js_code","compile_and_run","main_loop_body","main_loop_promise","lower_case_query","toLowerCase","GROUP_BY","UPDATE","SELECT","JOIN","INNER_JOIN","LEFT_JOIN","LEFT_OUTER_JOIN","STRICT_LEFT_JOIN","ORDER_BY","WHERE","LIMIT","EXCEPT","WITH","get_ambiguous_error_msg","variable_name","get_all_matches","regexp","str_strip","strip_comments","cline","combine_string_literals","backend_expression","prefix","dst_variables_map","matches","field_num","initialize","index","js_string_escape_column_name","quote_char","query_probably_has_dictionary_variable","continuous_name_segments","continuous_segment","column_names","dict_test_rgx","escaped_column_name","column_names_source","column_names_from_query","zero_based_idx","map_variables_directly","ensure_no_ambiguous_variables","input_column_names","join_column_names","join_column_names_set","parse_join_expression","invalid_join_syntax_error","variable_pairs","pair_rgx","and_rgx","resolve_join_variables","input_variables_map","join_variables_map","lhs_variables","rhs_indices","valid_join_syntax_msg","variable_pair","join_var_1","join_var_2","lhs_key_index","rhs_key_index","generate_common_init_code","base_var","attr_var","generate_init_statements","variables_map","indent","code_lines","simple_var_name_rgx","var_info","variable_declaration_keyword","replace_star_count","aggregate_expression","replace_star_vars","rbql_expression","replacement_expression","replace_star_vars_for_header_parsing","translate_update_expression","update_expression","first_assignment_error","assignment_looking_rgx","dst_var_name","var_index","current_indent","translate_select_expression","expression_without_counting_stars","translated","translated_for_header","separate_string_literals","rgx","format_parts","idx_before","literal_id","string_literal","start_index","lastIndex","format_expression","locate_statements","statement_groups","ig","is","statement","match_str","separate_actions","with_match","ordered_statements","statement_start","span_start","span_end","statement_params","new_span","find_top","rb_actions","select_action","translate_except_expression","except_expression","input_header","skip_vars","skip_indices","var_name","HashJoinMap","key_indices","hash_map","key_index","polymorphic_get_key","get_single_key","get_multi_key","ki","get_record","nf","key_records","cleanup_query","filter","remove_redundant_table_name","select_output_header","join_header","query_column_infos","query_has_star","query_has_column_alias","qci","output_header","handle_query_modifier","TableIterator","table","normalize_column_names","stopped","num_fields","TableWriter","external_table","SingleTableRegistry","shallow_parse_input_query","get_variables_map","get_header","rhs_table_id","join_record_iterator","sql_join_type","build","select_expression_for_header","query_table","input_table","output_table","join_table","output_column_names","exception_to_error_info","exceptions_type_map","error_type","util","utf_decoding_error","rbql_init_source_path","readFileSync","name_record","index_path","content","lines","try_read_index","get_index_record","RecordQueue","push_stack","pull_stack","enqueue","dequeue","csv_path","first_record_should_be_emitted","header_preread_complete","decoder","TextDecoder","fatal","input_exhausted","started","utf8_bom_removed","partially_decoded_line","partially_decoded_line_ends_with_cr","resolve_current_record","reject_current_record","current_exception","produced_records_queue","process_line_polymorphic","process_partial_rfc_record_line","process_record_line_simple","modifier","reset_external_callbacks","try_propagate_exception","exception","store_or_propagate_exception","pause","preread_first_record","try_resolve_next_record","isPaused","resume","parent_iterator","current_record_promise","num_records","process_record_line","process_line","clean_line","assumed_source_encoding","charCodeAt","remove_utf8_bom","process_data_stream_chunk","data_chunk","decoded_string","decode","first_line_index","process_data_bulk","data_blob","control_buffer","Buffer","compare","process_data_stream_end","last_line","destroy","readFile","close_stream_on_finish","setDefaultEncoding","error_obj","store_first_error","first_error","writer_error","_write_all","output_encoding","FileSystemCSVRegistry","interpret_named_csv_format","format_name","query_csv","require","possibleNames","out","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","child_process","rainbow_utils","ll_rainbow_utils","is_web_ext","scratch_buf_marker","client_html_template_web","aligned_files","result_set_parent_map","manual_comment_prefix_stoplist","rbql_status_bar_button","align_shrink_button","rainbow_off_status_bar_button","copy_back_button","column_info_button","dynamic_dialect_select_button","last_rbql_queries","client_html_template","global_state","preview_panel","doc_first_edit_subscription","keyboard_cursor_subscription","_unit_test_last_rbql_report","_unit_test_last_warnings","cursor_timeout_handle","rainbow_token_event","comment_token_event","sticky_header_disposable","DYNAMIC_CSV","SIMPLE_POLICY","dynamic_document_dialects","custom_comment_prefixes","original_language_ids","autodetection_stoplist","autodetection_temporarily_disabled_for_rbql","dynamic_dialect_for_next_request","dialect_map","tokenTypes","tokens_legend","SemanticTokensLegend","safe_lower","src_str","get_default_policy","separator","map_dialect_to_language_id","absolute_path_map","show_single_line_error","error_msg","active_window","showErrorMessage","sleep","ms","push_current_stack_to_js_callback_queue_to_allow_ui_update","get_from_global_state","default_value","save_to_global_state","update","replace_doc_content","new_content","invalid_range","full_range","validateRange","edit","make_header_key","make_with_headers_key","get_from_config","param_name","config","workspace","getConfiguration","get_header_from_document","_header_lnum","header_line","uri","scheme","raw_header","parse","get_dialect","languageId","dialect_info","StickyHeaderProvider","_delim","header_lnum","_header_text","header_range","symbol_kind","SymbolKind","File","DocumentSymbol","enable_dynamic_semantic_tokenization","token_provider","RainbowTokenProvider","dispose","document_selector","language","languages","registerDocumentRangeSemanticTokensProvider","register_comment_tokenization_handler","CommentTokenProvider","get_dialect_from_user_dialog","showInputBox","enable_rainbow_features_if_csv","endsWith","hide_buttons","onDidChangeTextEditorSelection","handle_cursor_movement","setLanguageConfiguration","lineComment","header_symbol_provider","registerDocumentSymbolProvider","register_sticky_header_provider","hide","show_align_shrink_button","parent_table_path","parent_basename","show_rbql_copy_to_source_button","show_column_info_button","show_status_bar_items","csv_lint","all_buttons","disable_rainbow_features_if_non_csv","get_active_editor","activeTextEditor","get_active_doc","enable_tooltip_column_names","Right","do_show_column_info_button","is_manual_op","_records","lint_result","csv_lint_cmd","run_internal_test_cmd","integration_test_options","check_initialization_state","initialized","lazy_loaded","check_last_rbql_report","check_last_rbql_warnings","show_warnings","warnings","showWarningMessage","handle_rbql_result_file_node","text_doc","showTextDocument","setTextDocumentLanguage","run_command","cmd","close_and_error_guard","callback_func","spawn","stderr","data","code","handle_command_result","src_table_path","dst_table_path","dst_delim","dst_policy","error_code","webview_report_handler","json_report","report","target_language_id","openTextDocument","file_path_to_query_key","set_header_line","_comment_prefix","preserve_original_language_id_if_needed","original_language_id","manually_set_rainbow_separator","set_comment_prefix","delete","restore_original_language","set_join_table_name","set_virtual_header","old_header","old_header_str","quoted_fields","input_box_props","raw_new_header","new_header","column_edit","shrink_table","progress_options","location","ProgressLocation","Window","withProgress","progress","shrinked_doc_text","align_table","aligned_doc_text","copy_back","result_doc","parent_doc","parent_editor","query_result_doc","getText","do_copy_back","handle_rbql_client_message","webview","message_type","report_msg","postMessage","init_msg","path_key","input_document_path","history_list","header_for_ui","rbql_backend","rbql_query","integration_test_delay","input_table_dir","navig_direction","protocol_message","backend_language","output_dialect","old_index","update_query_history","input_table_path","rbql_output_dir","tmpdir","get_dst_table_dir","orig_extension","extname","delim_ext_map","dst_extension","result_table_name","get_dst_table_name","output_doc_cfg","handle_rbql_result_file_web","csv_options","cmd_safe_query","run_rbql_query","udf_file_path","default_content","writeFileSync","udf_doc","edit_rbql","orig_uri","isDirty","rnd_suffix","random","with_headers_by_default","createWebviewPanel","ViewColumn","Active","enableScripts","client_html","paths_list","local_path","adjusted_webview_url","asWebviewUri","Uri","file","adjust_webview_paths","html","onDidReceiveMessage","autodetect_dialect_frequency_based","candidate_separators","max_num_chars_to_test","best_dialect","best_separator","best_policy","best_dialect_frequency","frequency","j","dialect_id","try_autoenable_rainbow_csv","s","is_default_csv","comment_prefix_for_autodetection","rainbow_csv_language_id","candidate_dialects","min_num_lines","best_dialect_first_trailing_space_line","best_dialect_num_columns","candidate_dialect","num_columns","autodetect_dialect","handle_first_edit_for_an_empty_doc","change_event","handle_editor_switch","editor","_unused_cursor_event","handle_doc_open","isUntitled","onDidChangeTextDocument","register_csv_copy_paste_for_empty_doc","make_preview","preview_mode","fsPath","size_limit","file_size_in_bytes","statSync","full_orig_doc","file_basename","out_path","open","fd","buffer","alloc","read_begin_pos","read","_num","buffer_str","lastIndexOf","includes","register_csv_hover_info_provider","context","hover_provider","registerHoverProvider","provideHover","token","cancellation_token","isCancellationRequested","_full_text","mds","MarkdownString","appendCodeblock","Hover","make_hover","subscriptions","_token","builder","SemanticTokensBuilder","activate","globalState","rbql_client_uri","joinPath","extensionUri","bytes","asAbsolutePath","lint_cmd","commands","registerCommand","rbql_cmd","set_header_line_cmd","set_comment_prefix_cmd","edit_column_names_cmd","set_join_table_name_cmd","column_edit_before_cmd","choose_dynamic_separator_cmd","choose_dynamic_separator","column_edit_after_cmd","column_edit_select_cmd","set_separator_cmd","set_separator_multiline_cmd","rainbow_off_cmd","sample_head_cmd","sample_tail_cmd","align_cmd","shrink_cmd","copy_back_cmd","internal_test_cmd","doc_open_event","onDidOpenTextDocument","switch_event","onDidChangeActiveTextEditor","deactivate"],"sourceRoot":""}